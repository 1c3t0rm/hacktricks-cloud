# iOS Testing Environment

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Apple Developer Program

**Provisioning identitet** je kolekcija javnih i privatnih ključeva koji su povezani sa Apple developer nalogom. Da biste **potpisali aplikacije**, morate platiti **99$/godinu** da se registrujete u **Apple Developer Programu** i dobijete svoj provisioning identitet. Bez toga nećete moći da pokrenete aplikacije iz izvornog koda na fizičkom uređaju. Druga opcija je korišćenje **jailbroken uređaja**.

Počevši od Xcode 7.2, Apple je omogućio opciju za kreiranje **besplatnog iOS razvojnog provisioning profila** koji omogućava pisanje i testiranje vaše aplikacije na stvarnom iPhone-u. Idite na _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Dodajte novi Appli ID sa vašim podacima) --> _Kliknite na kreirani Apple ID_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Done_\
\_\_Zatim, da biste pokrenuli aplikaciju na vašem iPhone-u, prvo morate **ukazati poverenje uređaju prema računaru**. Zatim, možete pokušati da **pokrenete aplikaciju na mobilnom uređaju iz Xcode-a**, ali će se pojaviti greška. Zato idite na _Settings_ --> _General_ --> _Profiles and Device Management_ --> Izaberite nepovereni profil i kliknite na "**Trust**".

Imajte na umu da **aplikacije potpisane istim potpisnim sertifikatom mogu deliti resurse na siguran način, kao što su stavke u kešu**.

Provisioning profili se čuvaju unutar telefona u **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulator**

{% hint style="info" %}
Imajte na umu da **simulator nije isto što i emulator**. Simulator samo simulira ponašanje uređaja i funkcije, ali ih zapravo ne koristi.
{% endhint %}

### **Simulator**

Prva stvar koju trebate znati je da će **izvođenje pentesta unutar simulatora biti mnogo ograničenije nego na jailbroken uređaju**.

Svi alati potrebni za izgradnju i podršku iOS aplikacije **zvanično su podržani samo na Mac OS-u**.\
Apple-ov de facto alat za kreiranje/debagovanje/instrumentiranje iOS aplikacija je **Xcode**. Može se koristiti za preuzimanje drugih komponenti kao što su **simulatori** i različite **verzije SDK-a** potrebne za izgradnju i **testiranje** vaše aplikacije.\
Visoko se preporučuje da **preuzmete** Xcode sa **zvaničnog App Store-a**. Druge verzije mogu sadržati zlonamerni softver.

Datoteke simulatora mogu se pronaći u `/Users/<korisničko_ime>/Library/Developer/CoreSimulator/Devices`

Da biste otvorili simulator, pokrenite Xcode, zatim pritisnite na _Xcode tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_Na sledećoj slici klikom na "iPod touch \[...]" možete izabrati drugi uređaj za testiranje:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Aplikacije u Simulatoru

Unutar `/Users/<korisničko_ime>/Library/Developer/CoreSimulator/Devices` možete pronaći sve **instalirane simulatore**. Ako želite da pristupite datotekama aplikacije kreirane unutar jednog od emulatora, može biti teško znati **u kojem je instalirana aplikacija**. Brz način da **pronađete tačan UID** je da pokrenete aplikaciju u simulatoru i izvršite:

```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```

Kada saznate UID, instalirane aplikacije unutar njega mogu se pronaći u `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

Međutim, iznenađujuće, aplikacija se neće nalaziti ovde. Morate pristupiti `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

I u ovom folderu možete **pronaći paket aplikacije**.

## Emulator

Corellium je jedini javno dostupan iOS emulator. To je poslovno rešenje SaaS modela sa licencom po korisniku i ne nudi probnu licencu.

## Jailbreak

Apple strogo zahteva da kod koji se izvršava na iPhone-u mora biti **potpisan sertifikatom izdatim od strane Apple-a**. **Jailbreak** je proces aktivnog **zaobilaženja takvih ograničenja** i drugih sigurnosnih kontrola koje je operativni sistem postavio. Stoga, kada je uređaj jailbroken, **provera integriteta** koja je odgovorna za proveru instaliranih aplikacija je zakrpljena tako da se **zaobilazi**.

{% hint style="info" %}
Za razliku od Androida, **ne možete preći na "Developer Mode"** u iOS-u da biste pokrenuli nepotpisani/nepoverljivi kod na uređaju.
{% endhint %}

### Rooting Androida vs. Jailbreaking iOS-a

Iako se često porede, **rooting** na Androidu i **jailbreaking** na iOS-u su fundamentalno različiti procesi. Rooting Android uređaja može uključivati **instaliranje `su` binarnog fajla** ili **zamenu sistema sa rootovanim prilagođenim ROM-om**, što ne zahteva nužno eksploate ako je bootloader otključan. **Flashing prilagođenih ROM-ova** zamenjuje operativni sistem uređaja nakon otključavanja bootloader-a, ponekad zahtevajući eksploate.

S druge strane, iOS uređaji ne mogu da flashuju prilagođene ROM-ove zbog ograničenja bootloader-a da samo butuje Apple-ovim potpisanim slikama. **Jailbreaking iOS-a** ima za cilj zaobilaženje Apple-ovih zaštita potpisivanja koda kako bi se pokrenuo nepotpisani kod, proces koji je otežan kontinuiranim unapređenjima sigurnosti od strane Apple-a.

### Izazovi Jailbreaking-a

Jailbreaking iOS-a postaje sve teže kako Apple brzo zakrpljuje ranjivosti. **Downgrade iOS-a** je moguć samo u ograničenom vremenskom periodu nakon izdanja, što čini jailbreaking pitanje vremenske osetljivosti. Uređaji koji se koriste za testiranje sigurnosti ne bi trebali biti ažurirani osim ako ponovno jailbreaking nije zagarantovan.

Ažuriranja iOS-a kontroliše **mehanizam izazova-odgovora** (SHSH blobs), koji omogućava instalaciju samo za Apple-ovim potpisanim odgovorima. Ovaj mehanizam, poznat kao "prozor za potpisivanje", ograničava mogućnost skladištenja i kasnijeg korišćenja OTA firmware paketa. Veb sajt [IPSW Downloads](https://ipsw.me) je resurs za proveru trenutnih prozora za potpisivanje.

### Vrste Jailbreak-a

* **Tethered jailbreaks** zahtevaju vezu sa računarom pri svakom ponovnom pokretanju.
* **Semi-tethered jailbreaks** omogućavaju pokretanje u režimu bez jailbreak-a bez računara.
* **Semi-untethered jailbreaks** zahtevaju ručno ponovno jailbreak-ovanje bez potrebe za računarom.
* **Untethered jailbreaks** nude trajno rešenje za jailbreak bez potrebe za ponovnom primenom.

### Alati i resursi za Jailbreaking

Alati za jailbreaking variraju prema verziji iOS-a i uređaju. Resursi poput [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) i [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) pružaju ažurirane informacije. Primeri uključuju:

* [Checkra1n](https://checkra.in/) za uređaje sa čipom A7-A11.
* [Palera1n](https://palera.in/) za Checkm8 uređaje (A8-A11) na iOS verzijama 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) za iOS verzije do 14.8.

Modifikacija uređaja nosi rizike, a jailbreaking treba pristupiti sa oprezom.

### Prednosti i rizici Jailbreaking-a

Jailbreaking **uklanja sandbox ograničenja nametnuta od strane operativnog sistema**, omogućavajući aplikacijama pristup celokupnom fajl sistemu. Ova sloboda omogućava instalaciju neodobrenih aplikacija i pristup više API-ja. Međutim, za obične korisnike, jailbreaking **nije preporučljiv** zbog potencijalnih sigurnosnih rizika i nestabilnosti uređaja.

### **Nakon Jailbreaking-a**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Detekcija Jailbreak-a**

**Nekoliko aplikacija će pokušati da otkrije da li je mobilni uređaj jailbroken i u tom slučaju aplikacija neće biti pokrenuta**

* Nakon jailbreaking-a iOS-a, obično se instaliraju **fajlovi i folderi**, koji se mogu pretraživati da bi se utvrdilo da li je uređaj jailbroken.
* Na jailbroken uređaju aplikacije dobijaju **čitanje/pisanje pristup novim fajlovima** van sandbox-a.
* Neke **API** **pozive** će se **ponašati drugačije**
* Prisustvo **OpenSSH** servisa
* Pozivanje `/bin/sh` će vratiti 1 umesto 0

**Više informacija o tome kako otkriti jailbreaking** [**ovde**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Možete pokušati da izbegnete ova otkrivanja koristeći `ios jailbreak disable` iz **objection-a**.

## **Bypass detekcije Jailbreak-a**

* Možete pokušati da izbegnete ova otkrivanja koristeći `ios jailbreak disable` iz **objection-a**.
* Takođe možete instalirati alatku **Liberty Lite** (https://ryleyangus.com/repo/). Nakon dodavanja repozitorijuma, aplikacija bi trebala da se pojavi u tabu "Pretraga".

## Reference

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
