# ADB Commands

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

**Adb se obično nalazi u:**

```bash
#Windows
C:\Users\<username>\AppData\Local\Android\sdk\platform-tools\adb.exe

#MacOS
/Users/<username>/Library/Android/sdk/platform-tools/adb
```

**Informacije dobijene sa:** [**http://adbshell.com/**](http://adbshell.com)

## Povezivanje

```
adb devices
```

Ovo će izlistati povezane uređaje; ako se pojavi "_**neovlašćeno**_", to znači da morate **odblokirati** svoj **mobilni** uređaj i **prihvatiti** vezu.

Ovo upućuje uređaj da pokrene adb server na portu 5555:

```
adb tcpip 5555
```

Povežite se na tu IP adresu i taj port:

```
adb connect <IP>:<PORT>
```

Ako dobijete grešku kao što je sledeća u virtuelnom Android softveru (kao što je Genymotion):

```
adb server version (41) doesn't match this client (36); killing...
```

To je zato što pokušavate da se povežete sa ADB serverom koji ima drugu verziju. Samo pokušajte da pronađete adb binarni fajl koji softver koristi (idite na `C:\Program Files\Genymobile\Genymotion` i potražite adb.exe)

### Više uređaja

Kada pronađete **više uređaja povezanih sa vašim računarom**, moraćete da **naznačite na kojem** želite da pokrenete adb komandu.

```bash
adb devices
List of devices attached
10.10.10.247:42135	offline
127.0.0.1:5555	device
```

```bash
adb -s 127.0.0.1:5555 shell
x86_64:/ # whoami
root
```

### Port Tunneling

U slučaju da je **adb** **port** dostupan samo sa **localhost** na android uređaju, ali **imate pristup putem SSH**, možete **preusmeriti port 5555** i povezati se putem adb-a:

```bash
ssh -i ssh_key username@10.10.10.10 -L 5555:127.0.0.1:5555 -p 2222
adb connect 127.0.0.1:5555
```

## Paket menadžer

### Instalacija/Deinstalacija

#### adb install \[opcija] \<putanja>

```bash
adb install test.apk

adb install -l test.apk # forward lock application

adb install -r test.apk # replace existing application

adb install -t test.apk # allow test packages

adb install -s test.apk # install application on sdcard

adb install -d test.apk # allow version code downgrade

adb install -p test.apk # partial application install
```

#### adb deinstaliraj \[opcije] \<PAKET>

```bash
adb uninstall com.test.app

adb uninstall -k com.test.app Keep the data and cache directories around after package removal.
```

### Paketi

Ispisuje sve pakete, opciono samo one čiji naziv paketa sadrži tekst u \<FILTER>.

#### adb shell pm list packages \[opcije] \<FILTER-STR>

```bash
adb shell pm list packages <FILTER-STR>

adb shell pm list packages -f <FILTER-STR> #See their associated file.

adb shell pm list packages -d <FILTER-STR> #Filter to only show disabled packages.

adb shell pm list packages -e <FILTER-STR> #Filter to only show enabled packages.

adb shell pm list packages -s <FILTER-STR> #Filter to only show system packages.

adb shell pm list packages -3 <FILTER-STR> #Filter to only show third party packages.

adb shell pm list packages -i <FILTER-STR> #See the installer for the packages.

adb shell pm list packages -u <FILTER-STR> #Also include uninstalled packages.

adb shell pm list packages --user <USER_ID> <FILTER-STR> #The user space to query.
```

#### adb shell pm path \<PACKAGE>

Ispisuje putanju do APK datoteke određene .

```bash
adb shell pm path com.android.phone
```

#### adb shell pm clear \<PACKAGE>

Obrišite sve podatke povezane sa paketom.

```bash
adb shell pm clear com.test.abc
```

## Upravljač datotekama

#### adb pull \<remote> \[local]

Preuzmite određenu datoteku sa emulatora/uređaja na vaš računar.

```bash
adb pull /sdcard/demo.mp4 ./
```

#### adb push \<lokalno> \<udaljeno>

Otpremi određeni fajl sa tvog računara na emulator/uređaj.

```bash
adb push test.apk /sdcard
```

## Snimanje ekrana/Snimak ekrana

#### adb shell screencap \<ime\_fajla>

Snimanje ekrana uređaja.

```bash
adb shell screencap /sdcard/screen.png
```

#### adb shell screenrecord \[opcije] \<ime\_fajla>

Snimanje ekrana uređaja koji pokreću Android 4.4 (API nivo 19) i novije verzije.

```bash
adb shell screenrecord /sdcard/demo.mp4
adb shell screenrecord --size <WIDTHxHEIGHT>
adb shell screenrecord --bit-rate <RATE>
adb shell screenrecord --time-limit <TIME> #Sets the maximum recording time, in seconds. The default and maximum value is 180 (3 minutes).
adb shell screenrecord --rotate # Rotates 90 degrees
adb shell screenrecord --verbose
```

(pritisnite Ctrl-C da biste zaustavili snimanje)

**Možete preuzeti datoteke (slike i videozapise) koristeći \_adb pull**\_

## Shell

#### adb shell

Dobijte shell unutar uređaja

```bash
adb shell
```

#### adb shell \<CMD>

Izvršava komandu unutar uređaja

```bash
adb shell ls
```

### pm

Sledeće komande se izvršavaju unutar ljuske.

```bash
pm list packages #List installed packages
pm path <package name> #Get the path to the apk file of tha package
am start [<options>] #Start an activity. Whiout options you can see the help menu
am startservice [<options>] #Start a service. Whiout options you can see the help menu
am broadcast [<options>] #Send a broadcast. Whiout options you can see the help menu
input [text|keyevent] #Send keystrokes to device
```

## Procesi

Ako želite da dobijete PID procesa vaše aplikacije, možete izvršiti:

```bash
adb shell ps
```

I pronađite vašu aplikaciju

Ili možete uraditi

```bash
adb shell pidof com.your.application
```

I ispisuje PID aplikacije

## Sistem

```bash
adb root
```

Pokreće adbd daemon sa root privilegijama. Zatim, morate ponovo se povezati na ADB server i bićete root (ako je dostupno).

```bash
adb sideload <update.zip>
```

## Flashovanje/obnavljanje Android update.zip paketa.

## Dnevnici

### Logcat

Da biste **filtrirali poruke samo jedne aplikacije**, dobijte PID aplikacije i koristite grep (linux/macos) ili findstr (windows) da biste filtrirali izlaz logcat-a:

```bash
adb logcat | grep 4526
adb logcat | findstr 4526
```

#### adb logcat \[opcija] \[specifikacije-filtera]

Ova adb komanda se koristi za prikazivanje logova sa Android uređaja. Može se koristiti sa različitim opcijama i specifikacijama filtera kako bi se prilagodio prikaz logova prema potrebama korisnika.

**Opcije:**

* **-v** \[format] : Podešava format prikaza logova. Mogući formati su brief, process, tag, thread, raw, time, threadtime i long.
* **-d** : Prikazuje samo poslednje logove.
* **-f** \[file] : Snima logove u određeni fajl.
* **-r** \[k] : Rotira log fajl svakih k kilobajta.
* **-n** \[count] : Održava samo poslednjih count broj rotiranih log fajlova.
* **-c** : Briše sve logove pre prikazivanja.
* **-b** \[buffer] : Prikazuje samo logove iz određenog bafera. Mogući baferi su main, system, radio, events i crash.

**Specifikacije filtera:**

* \***:S** : Prikazuje samo logove sa određenim tagom.
* \***:V** : Prikazuje sve logove.
* \***:D** : Prikazuje samo debug logove.
* \***:I** : Prikazuje samo informacione logove.
* \***:W** : Prikazuje samo upozorenja.
* \***:E** : Prikazuje samo greške.
* \***:F** : Prikazuje samo fatalne greške.
* \***:S** : Prikazuje samo silent logove.

Napomena: Opcija i specifikacija filtera mogu se kombinovati kako bi se prilagodio prikaz logova prema potrebama korisnika.

```bash
adb logcat
```

Napomena: pritisnite Ctrl-C da biste zaustavili monitor.

```bash
adb logcat *:V # lowest priority, filter to only show Verbose level

adb logcat *:D # filter to only show Debug level

adb logcat *:I # filter to only show Info level

adb logcat *:W # filter to only show Warning level

adb logcat *:E # filter to only show Error level

adb logcat *:F # filter to only show Fatal level

adb logcat *:S # Silent, highest priority, on which nothing is ever printed
```

#### adb logcat -b \<Buffer>

Komanda `adb logcat -b \<Buffer>` se koristi za prikazivanje logova iz određenog bafera na Android uređaju pomoću ADB-a.

Ova komanda omogućava pristup različitim vrstama bafera logova na uređaju, kao što su `main`, `system`, `radio`, `events` i `crash`. Korišćenje opcije `-b` zajedno sa odgovarajućim baferom omogućava filtriranje i prikazivanje samo određenih logova.

Na primer, ako želite da prikažete samo logove iz `main` bafera, koristite sledeću komandu:

```
adb logcat -b main
```

Ova komanda će prikazati sve logove koji su zabeleženi u `main` baferu na Android uređaju. Možete koristiti istu sintaksu za prikazivanje logova iz drugih bafera.

Važno je napomenuti da je ADB (Android Debug Bridge) alat koji omogućava komunikaciju između računara i Android uređaja. Korišćenje ADB-a za prikazivanje logova može biti korisno prilikom debagovanja i analize problema na Android aplikacijama.

```bash
adb logcat -b # radio View the buffer that contains radio/telephony related messages.

adb logcat -b # event View the buffer containing events-related messages.

adb logcat -b # main default

adb logcat -c # Clears the entire log and exits.

adb logcat -d # Dumps the log to the screen and exits.

adb logcat -f test.logs # Writes log message output to test.logs .

adb logcat -g # Prints the size of the specified log buffer and exits.

adb logcat -n <count> # Sets the maximum number of rotated logs to <count>.
```

### dumpsys

dumps sistemskih podataka

#### adb shell dumpsys \[opcije]

```bash
adb shell dumpsys

adb shell dumpsys meminfo

adb shell dumpsys battery
```

***

### title: ADB команде

## ADB команде

ADB (Android Debug Bridge) је инструмент који омогућава комуникацију између рачунара и Android уређаја. Овај чланак приказује неке од најчешће коришћених ADB команди за пентестинг Android апликација.

### Постављање ADB окружења

Пре него што почнемо са коришћењем ADB команди, потребно је поставити ADB окружење. Ево како то можете урадити:

1. Преузмите и инсталирајте Android SDK на свој рачунар.
2. Омогућите "Developer Options" на свом Android уређају. Ово можете урадити тако што ћете иди на "Settings" > "About phone" > "Build number" и десет пута кликнете на "Build number".
3. Омогућите "USB Debugging" на свом Android уређају. Ово можете урадити тако што ћете ићи на "Settings" > "Developer options" > "USB Debugging" и омогућите га.
4. Повежите свој Android уређај са рачунаром помоћу USB кабла.
5. Проверите да ли је ADB препознао ваш уређај тако што ћете у командној линији унети команду `adb devices`. Ако се прикаже ваш уређај, значи да је ADB успешно постављен.

### Основне ADB команде

#### `adb devices`

Ова команда приказује све повезане Android уређаје.

#### `adb shell`

Ова команда отвара командну линију на повезаном Android уређају.

#### `adb install <path_to_apk>`

Ова команда инсталира Android апликацију на повезани уређај. Замените `<path_to_apk>` путањом до APK фајла.

#### `adb uninstall <package_name>`

Ова команда деинсталира Android апликацију са повезаног уређаја. Замените `<package_name>` именом пакета апликације.

#### `adb push <local_path> <remote_path>`

Ова команда копира фајл са локалног рачунара на повезани Android уређај. Замените `<local_path>` путањом до локалног фајла и `<remote_path>` путањом на уређају где желите да копирате фајл.

#### `adb pull <remote_path> <local_path>`

Ова команда копира фајл са повезаног Android уређаја на локални рачунар. Замените `<remote_path>` путањом до фајла на уређају и `<local_path>` путањом на рачунару где желите да копирате фајл.

#### `adb logcat`

Ова команда приказује системске логове са повезаног Android уређаја.

#### `adb shell pm list packages`

Ова команда приказује све инсталиране пакете на повезаном Android уређају.

#### `adb shell pm path <package_name>`

Ова команда приказује путању до инсталиране апликације на повезаном Android уређају. Замените `<package_name>` именом пакета апликације.

#### `adb shell dumpsys package <package_name>`

Ова команда приказује информације о инсталираној апликацији на повезаном Android уређају. Замените `<package_name>` именом пакета апликације.

#### `adb shell am start -n <package_name>/<activity_name>`

Ова команда покреће одређену активност у инсталираној апликацији на повезаном Android уређају. Замените `<package_name>` именом пакета апликације и `<activity_name>` именом активности.

#### `adb shell input keyevent <key_code>`

Ова команда симулира притисак на одређени тастер на повезаном Android уређају. Замените `<key_code>` кодом тастера.

#### `adb shell input text "<text>"`

Ова команда симулира унос текста на повезаном Android уређају. Замените `<text>` текстом који желите да унесете.

#### `adb shell screencap <file_path>`

Ова команда снима слику екрана повезаног Android уређаја. Замените `<file_path>` путањом где желите да снимите слику.

#### `adb shell screenrecord <file_path>`

Ова команда снима видео екрана повезаног Android уређаја. Замените `<file_path>` путањом где желите да снимите видео.

### Закључак

Ово су само неке од најчешће коришћених ADB команди за пентестинг Android апликација. ADB пружа многе могућности за истраживање и тестирање безбедности Android уређаја и апликација.

```bash
adb shell dumpsys batterystats collects battery data from your device
```

Beleške: [Battery Historian](https://github.com/google/battery-historian) konvertuje te podatke u HTML vizualizaciju. **KORAK 1** _adb shell dumpsys batterystats > batterystats.txt_ **KORAK 2** _python historian.py batterystats.txt > batterystats.html_

```bash
adb shell dumpsys batterystats --reset erases old collection data
```

adb shell dumpsys activity

## Backup

Napravite rezervnu kopiju Android uređaja putem adb-a.

```bash
adb backup [-apk] [-shared] [-system] [-all] -f file.backup
# -apk -- Include APK from Third partie's applications
# -shared -- Include removable storage
# -system -- Include system Applciations
# -all -- Include all the applications

adb shell pm list packages -f -3      #List packages
adb backup -f myapp_backup.ab -apk com.myapp # backup on one device
adb restore myapp_backup.ab                  # restore to the same or any other device
```

Ako želite da pregledate sadržaj rezervne kopije:

```bash
( printf "\x1f\x8b\x08\x00\x00\x00\x00\x00" ; tail -c +25 myapp_backup.ab ) |  tar xfvz -
```

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
