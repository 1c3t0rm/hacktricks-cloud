# Tapjacking

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## **Osnovne informacije**

**Tapjacking** je napad u kojem se pokreće **zlonamerna aplikacija** i **pozicionira iznad aplikacije žrtve**. Kada vidljivo prekrije aplikaciju žrtve, njen korisnički interfejs je dizajniran na način da prevari korisnika da s njom interaguje, dok istovremeno prenosi interakciju na aplikaciju žrtve.\
Na taj način, **korisnik nije svestan da zapravo izvršava radnje na aplikaciji žrtve**.

### Detekcija

Da biste otkrili aplikacije koje su ranjive na ovaj napad, trebali biste pretražiti **izložene aktivnosti** u Android manifestu (imajte na umu da se aktivnost sa intent-filterom automatski izlaže prema podrazumevanim podešavanjima). Kada pronađete izložene aktivnosti, **proverite da li zahtevaju neka ovlašćenja**. To je zato što će **zlonamerna aplikacija takođe morati da ima to ovlašćenje**.

### Zaštita

#### Android 12 (API 31,32) i noviji

[**Prema ovom izvoru**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** tapjacking napadi automatski su sprečeni od strane Androida od verzije Android 12 (API 31 i 30) i novijih. Dakle, čak i ako je aplikacija ranjiva, **nećete moći da je iskoristite**.

#### `filterTouchesWhenObscured`

Ako je **`android:filterTouchesWhenObscured`** postavljen na **`true`**, `View` neće primati dodire kada je prozor prikaza prekriven drugim vidljivim prozorom.

#### **`setFilterTouchesWhenObscured`**

Atribut **`setFilterTouchesWhenObscured`** postavljen na true takođe može sprečiti iskorišćavanje ove ranjivosti ako je verzija Androida niža.\
Na primer, ako je postavljeno na **`true`**, dugme se može automatski **onemogućiti ako je prekriveno**:

```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```

## Eksploatacija

### Tapjacking-ExportedActivity

Najnoviju Android aplikaciju koja izvodi napad Tapjacking (+ pozivanje pre izvođenja izvođene aktivnosti napadnute aplikacije) možete pronaći na: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Pratite **uputstva u README datoteci** kako biste je koristili.

### FloatingWindowApp

Primer projekta koji implementira **FloatingWindowApp**, koji se može koristiti za postavljanje preko drugih aktivnosti radi izvođenja napada clickjacking, možete pronaći na [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (malo je zastareo, srećno sa izgradnjom apk datoteke).

### Qark

{% hint style="danger" %}
Izgleda da ovaj projekat više nije održavan i ova funkcionalnost više ne radi kako treba.
{% endhint %}

Možete koristiti [**qark**](https://github.com/linkedin/qark) sa parametrima `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` da biste napravili zlonamernu aplikaciju za testiranje mogućih ranjivosti na **Tapjacking**.

Otklanjanje ovog problema je relativno jednostavno jer programer može odlučiti da ne prima dodirne događaje kada je pogled prekriven drugim. Koristeći [Android Developer’s Reference](https://developer.android.com/reference/android/view/View#security):

> Ponekad je neophodno da aplikacija može da potvrdi da se radnja izvršava uz punu saglasnost i znanje korisnika, kao što je odobravanje zahteva za dozvolu, obavljanje kupovine ili klik na oglas. Nažalost, zlonamerna aplikacija može pokušati da prevari korisnika da izvrši ove radnje, nesvestan toga, sakrivajući namenu prikaza. Kao lek, okvir nudi mehanizam filtriranja dodira koji se može koristiti za poboljšanje sigurnosti prikaza koji omogućavaju pristup osetljivoj funkcionalnosti.
>
> Da biste omogućili filtriranje dodira, pozovite [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ili postavite android:filterTouchesWhenObscured atribut rasporeda na true. Kada je omogućeno, okvir će odbaciti dodire koji se primaju kada je prozor prikaza prekriven drugim vidljivim prozorom. Kao rezultat, prikaz neće primati dodire kada se pojavi tost, dijalog ili drugi prozor iznad prozora prikaza.

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **oglašavanje vaše kompanije u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
