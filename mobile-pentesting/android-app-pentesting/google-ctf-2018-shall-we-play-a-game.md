# Google CTF 2018 - Shall We Play a Game?

## Google CTF 2018 - Da li želimo da igramo igru?

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini da podržite HackTricks:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

Preuzmite APK ovde:

Idem da postavim APK na [https://appetize.io/](https://appetize.io) (besplatan nalog) da vidim kako se apk ponaša:

![](<../../.gitbook/assets/image (46).png>)

Izgleda da morate pobediti 1000000 puta da biste dobili zastavicu.

Prateći korake sa [pentesting Android](./) možete dekompajlirati aplikaciju da biste dobili smali kod i pročitali Java kod koristeći jadx.

Čitanje Java koda:

![](<../../.gitbook/assets/image (47).png>)

Izgleda da je funkcija koja će ispisati zastavicu **m().**

### **Smali promene**

#### **Pozovite m() prvi put**

Neka aplikacija pozove m() ako promenljiva _this.o != 1000000_, da biste to uradili, samo promenite uslov:

```
if-ne v0, v9, :cond_2
```

/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

## Da li želimo da igramo igru?

### Opis

Ova CTF (Capture The Flag) igra je bazirana na Android aplikaciji koja ima nekoliko ranjivosti. Cilj igre je da pronađete i iskoristite ove ranjivosti kako biste pristupili tajnim informacijama.

### Koraci

1. Preuzmite APK datoteku aplikacije sa [ovog linka](https://github.com/google/google-ctf/releases/tag/2018-quals).
2. Instalirajte APK datoteku na Android uređaj.
3. Pokrenite aplikaciju i pritisnite dugme "Play".
4. Analizirajte mrežni saobraćaj koji generiše aplikacija. Možete koristiti alate poput Wireshark-a ili Burp Suite-a.
5. Pronađite HTTP zahtev koji sadrži tajne informacije. Ovaj zahtev će biti enkriptovan.
6. Koristite alate za dekripciju kako biste dešifrovali enkriptovane podatke.
7. Pronađite ključ za dekripciju enkriptovanih podataka. Možete koristiti alate poput Frida ili Xposed Framework-a.
8. Iskoristite ranjivost u aplikaciji kako biste pristupili tajnim informacijama.
9. Zabeležite flag koji se nalazi u tajnim informacijama.
10. Ponovite korake 4-9 za sve nivoe igre.

### Napomena

Ova igra je samo simulacija i treba je koristiti u edukativne svrhe. Nepravilno korišćenje ovih tehnika može biti nezakonito.

```
if-eq v0, v9, :cond_2
```

![Pre](<../../.gitbook/assets/image (48).png>)

![Posle](<../../.gitbook/assets/image (49).png>)

Pratite korake [pentestiranja Androida](./) da biste rekompovali i potpisali APK. Zatim, otpremite ga na [https://appetize.io/](https://appetize.io) i vidimo šta se dešava:

![](<../../.gitbook/assets/image (50).png>)

Izgleda da je zastava napisana bez potpune dešifrovanosti. Verovatno bi trebalo pozvati funkciju m() 1000000 puta.

**Drugi način** da se to uradi je da se ne menja instrukcija, već da se promene upoređene instrukcije:

![](<../../.gitbook/assets/image (55).png>)

**Još jedan način** je umesto upoređivanja sa 1000000, postaviti vrednost na 1 tako da se this.o upoređuje sa 1:

![](<../../.gitbook/assets/image (57).png>)

Četvrti način je dodavanje instrukcije za premeštanje vrednosti v9(1000000) u v0 _(this.o)_:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

### Rešenje

Naterajte aplikaciju da izvrši petlju 100000 puta kada prvi put pobedite. Da biste to uradili, samo treba da napravite petlju **:goto\_6** i naterate aplikaciju da **skoči tamo ako `this.o`** nema vrednost 100000:

![](<../../.gitbook/assets/image (59).png>)

Ovo morate uraditi na fizičkom uređaju jer (ne znam zašto) ovo ne funkcioniše na emuliranom uređaju.

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini da podržite HackTricks:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
