# AWS - рдирд╛рдЗрдЯреНрд░реЛ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

AWS рдирд╛рдЗрдЯреНрд░реЛ рдПрдХ рд╕реБрдИ рд╣реИ рдЬреЛ AWS EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рд▓реЗрдЯрд░рд▓ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдмрдирд╛рддреА рд╣реИред рдЕрдореЗрдЬрд╝рди рджреНрд╡рд╛рд░рд╛ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдирд╛рдЗрдЯреНрд░реЛ рд╕реБрд░рдХреНрд╖рд╛, рдкреНрд░рджрд░реНрд╢рди, рдФрд░ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреМрдкрдЪрд╛рд░рд┐рдХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХрд┐рдпреЛрдВ рдХрд╛ рд╕рд╣рд╛рд░рд╛ рд▓реЗрддрд╛ рд╣реИ, рдирд╛рдЗрдЯреНрд░реЛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╕рдВрдШрдЯрди рдФрд░ рдПрдХ рд╣рд▓реНрдХреЗ hypervisor рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИред рдпрд╣ рдзрд╛рд░рдгрд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдзрд╛рд░рд┐рдд рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдорд░реНрдкрд┐рдд рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдореЗрдВ рдиреНрдпреВрдирддрдо рдХрд░ рджреЗрддрд╛ рд╣реИ, рд╣рдорд▓реЗ рдХреЗ рд╕рддрд╣ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рдВрд╕рд╛рдзрди рдХреБрд╢рд▓рддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИред рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрдиреНрдпрд╛рдпрд┐рдХ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкрд░ рд▓реЛрдб рдХрд░рдХреЗ, рдирд╛рдЗрдЯреНрд░реЛ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ **рд▓рдЧрднрдЧ рдмреЗрдпрд░-рдореЗрдЯрд▓ рдкреНрд░рджрд░реНрд╢рди** рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕рдВрд╕рд╛рдзрди-рдЙрддреНрд╕рд╛рд╣реА рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд▓рд╛рднрдХрд╛рд░реА рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдирд╛рдЗрдЯреНрд░реЛ рд╕реБрд░рдХреНрд╖рд╛ рдЪрд┐рдк рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рдлрд░реНрдорд╡реЗрдпрд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛, рдЗрд╕рдХреА рдордЬрдмреВрдд рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЛ рдФрд░ рднреА рдордЬрдмреВрдд рдмрдирд╛рддреЗ рд╣реИрдВред

### рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡реНрд╕

**AWS рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡реНрд╕** рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд, **рдЕрд▓рдЧ рдХрдВрдкреНрдпреВрдЯ рдкрд░рд┐рд╡реЗрд╢ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЕрдореЗрдЬрд╝рди EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рднреАрддрд░**, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдЪреНрдЪрддрдо рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред AWS рдирд╛рдЗрдЯреНрд░реЛ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреЗ рд╣реБрдП, рдпреЗ рдПрдиреНрдХреНрд▓реЗрд╡реНрд╕ рдордЬрдмреВрдд **рдЕрд▓рдЧрд╛рд╡ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛** рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ **рдЧреЛрдкрдиреАрдп рдЬрд╛рдирдХрд╛рд░реА** рдЬреИрд╕реЗ PII рдпрд╛ рд╡рд┐рддреНрддреАрдп рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИред рдЗрдирдореЗрдВ рдПрдХ рдиреНрдпреВрдирддрдо рдкрд░реНрдпрд╛рд╡рд░рдг рд╣реИ, рдбреЗрдЯрд╛ рдХрд╛ рдЕрд╡рд╕рд╛рдж рдХрд░рдиреЗ рдХрд╛ рдЬреЛрдЦрд┐рдо рдХрд╛рдлреА рдХрдо рдХрд░ рджреЗрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡реНрд╕ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рдЧрд╡рд╛рд╣реА рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рдЕрдзрд┐рдХреГрдд рдХреЛрдб рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рдЬреЛ рд╕рдЦреНрдд рдЕрдиреБрдкрд╛рд▓рди рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдХреНрд╖рдг рдорд╛рдирдХреЛрдВ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

{% hint style="danger" %}
рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ рдЫрд╡рд┐рдпрд╛рдБ **EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рдЕрдВрджрд░ рд╕реЗ рдЪрд▓рд╛рдИ рдЬрд╛рддреА рд╣реИрдВ** рдФрд░ рдЖрдк AWS рд╡реЗрдм рдХрдВрд╕реЛрд▓ рд╕реЗ рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддреЗ рдХрд┐ рдХреНрдпрд╛ рдПрдХ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ рдореЗрдВ рдЫрд╡рд┐рдпрд╛рдБ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред
{% endhint %}

### рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ CLI рд╕реНрдерд╛рдкрдирд╛

рд╕рднреА рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ [**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave)ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпреЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ:
```bash
# Install tools
sudo amazon-linux-extras install aws-nitro-enclaves-cli -y
sudo yum install aws-nitro-enclaves-cli-devel -y

# Config perms
sudo usermod -aG ne $USER
sudo usermod -aG docker $USER

# Check installation
nitro-cli --version

# Start and enable the Nitro Enclaves allocator service.
sudo systemctl start nitro-enclaves-allocator.service && sudo systemctl enable nitro-enclaves-allocator.service
```
### рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ рдЗрдореЗрдЬреЗрд╕

рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓реА рдЗрдореЗрдЬреЗрд╕ рдбреЙрдХрд░ рдЗрдореЗрдЬреЗрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЕрдкрдиреА рдирд╛рдЗрдЯреНрд░реЛ рдПрдиреНрдХреНрд▓реЗрд╡ рдЗрдореЗрдЬреЗрд╕ рдбреЙрдХрд░ рдЗрдореЗрдЬреЗрд╕ рд╕реЗ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:
```bash
# You need to have the docker image accesible in your running local registry
# Or indicate the full docker image URL to access the image
nitro-cli build-enclave --docker-uri <docker-img>:<tag> --output-file nitro-img.eif
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, Nitro Enclave рдЫрд╡рд┐рдпрд╛рдБ рд╡рд┐рд╕реНрддрд╛рд░ **`eif`** (Enclave Image File) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред

рдЖрдЙрдЯрдкреБрдЯ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:
```
Using the locally available Docker image...
Enclave Image successfully created.
{
"Measurements": {
"HashAlgorithm": "Sha384 { ... }",
"PCR0": "e199261541a944a93129a52a8909d29435dd89e31299b59c371158fc9ab3017d9c450b0a580a487e330b4ac691943284",
"PCR1": "bcdf05fefccaa8e55bf2c8d6dee9e79bbff31e34bf28a99aa19e6b29c37ee80b214a414b7607236edf26fcb78654e63f",
"PCR2": "2e1fca1dbb84622ec141557dfa971b4f8ea2127031b264136a20278c43d1bba6c75fea286cd4de9f00450b6a8db0e6d3"
}
}
```
рдЬреИрд╕рд╛ рдХрд┐ [**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдПрдиреНрдХреНрд▓реЗрд╡ рдЫрд╡рд┐ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХрдо рд╕реЗ рдХрдо 4 рдЧреБрдгрд╛ **`eif`** рдлрд╝рд╛рдЗрд▓ рдХреЗ рдбрд┐рд╕реНрдХ рдореЗрдВ рд▓реЗ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
