# AWS - S3 Privesc

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## S3

### `s3:PutBucketNotification`, `s3:PutObject`, `s3:GetObject`

An attacker with those permissions over interesting buckets might be able to hijack resources and escalate privileges.

For example, an attacker with those **permissions over a cloudformation bucket** called "cf-templates-nohnwfax6a6i-us-east-1" will be able to hijack the deployment. The access can be given with the following policy:
```json
{
"Version":"2012-10-17",
"Statement":[
{
"Effect":"Allow",
"Action":[
"s3:PutBucketNotification",
"s3:GetBucketNotification",
"s3:PutObject",
"s3:GetObject"],
"Resource":[
"arn:aws:s3:::cf-templates-*\/*",
"arn:aws:s3:::cf-templates-*"]
},
{
"Effect":"Allow",
"Action":"s3:ListAllMyBuckets",
"Resource":"*"
}]
}
```
DaH HIqDaq **template** upload **time window** vItlhutlh **hijack**. **template** **deploy** vItlhutlh. **lambda function** **bucket notification** **trigger** **attacker** **bucket** **content** **hijack**.

![](<../../../.gitbook/assets/image (18) (1) (1).png>)

Pacu module [`cfn__resouce_injection`](https://github.com/RhinoSecurityLabs/pacu/wiki/Module-Details#cfn\_\_resource\_injection) vItlhutlh **automate** **attack**.\
mor informatino **original research**: [https://rhinosecuritylabs.com/aws/cloud-malware-cloudformation-injection/](https://rhinosecuritylabs.com/aws/cloud-malware-cloudformation-injection/)

### `s3:PutObject`, `s3:GetObject` <a href="#s3putobject-s3getobject" id="s3putobject-s3getobject"></a>

**S3** **objects** **get and upload** **permissions**. AWS **services** (and outside) S3 storage **config files** **store**.\
**read access** **attacker** **sensitive information** **find**.\
**write access** **attacker** **data modify** **service abuse** **try to escalate privileges**.\
**examples**:

* EC2 instance **user data** **S3 bucket** **store**, **attacker** **modify** **execute arbitrary code** **EC2 instance**.

### `s3:PutBucketPolicy`

**attacker**, **same account** **need**, **error** `The specified method is not allowed will trigger`,  **permission** **bucket(s)** **more permissions** **grant** **able** **read, write, modify, delete and expose buckets**.
```bash
# Update Bucket policy
aws s3api put-bucket-policy --policy file:///root/policy.json --bucket <bucket-name>

## JSON giving permissions to a user and mantaining some previous root access
{
"Id": "Policy1568185116930",
"Version":"2012-10-17",
"Statement":[
{
"Effect":"Allow",
"Principal":{
"AWS":"arn:aws:iam::123123123123:root"
},
"Action":"s3:ListBucket",
"Resource":"arn:aws:s3:::somebucketname"
},
{
"Effect":"Allow",
"Principal":{
"AWS":"arn:aws:iam::123123123123:user/username"
},
"Action":"s3:*",
"Resource":"arn:aws:s3:::somebucketname/*"
}
]
}

## JSON Public policy example
### IF THE S3 BUCKET IS PROTECTED FROM BEING PUBLICLY EXPOSED, THIS WILL THROW AN ACCESS DENIED EVEN IF YOU HAVE ENOUGH PERMISSIONS
{
"Id": "Policy1568185116930",
"Version": "2012-10-17",
"Statement": [
{
"Sid": "Stmt1568184932403",
"Action": [
"s3:ListBucket"
],
"Effect": "Allow",
"Resource": "arn:aws:s3:::welcome",
"Principal": "*"
},
{
"Sid": "Stmt1568185007451",
"Action": [
"s3:GetObject"
],
"Effect": "Allow",
"Resource": "arn:aws:s3:::welcome/*",
"Principal": "*"
}
]
}
```
### `s3:GetBucketAcl`, `s3:PutBucketAcl`

**Qa'Hom** vItlhutlhlaHbe'chugh **ghaH** vItlhutlhlaHbe'chugh **ghaH** 'e' vItlhutlhlaHbe'chugh **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **
```bash
# Update bucket ACL
aws s3api get-bucket-acl --bucket <bucket-name>
aws s3api put-bucket-acl --bucket <bucket-name> --access-control-policy file://acl.json

##JSON ACL example
## Make sure to modify the Owner‚Äôs displayName and ID according to the Object ACL you retrieved.
{
"Owner": {
"DisplayName": "<DisplayName>",
"ID": "<ID>"
},
"Grants": [
{
"Grantee": {
"Type": "Group",
"URI": "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
},
"Permission": "FULL_CONTROL"
}
]
}
## An ACL should give you the permission WRITE_ACP to be able to put a new ACL
```
### `s3:GetObjectAcl`, `s3:PutObjectAcl`

ghItlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e
```bash
# Update bucket object ACL
aws s3api get-object-acl --bucket <bucekt-name> --key flag
aws s3api put-object-acl --bucket <bucket-name> --key flag --access-control-policy file://objacl.json

##JSON ACL example
## Make sure to modify the Owner‚Äôs displayName and ID according to the Object ACL you retrieved.
{
"Owner": {
"DisplayName": "<DisplayName>",
"ID": "<ID>"
},
"Grants": [
{
"Grantee": {
"Type": "Group",
"URI": "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
},
"Permission": "FULL_CONTROL"
}
]
}
## An ACL should give you the permission WRITE_ACP to be able to put a new ACL
```
### `s3:GetObjectAcl`, `s3:PutObjectVersionAcl`

**tlhIngan Hol translation:**

### `s3:GetObjectAcl`, `s3:PutObjectVersionAcl`

ghobDaq 'e' vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh ghobDaq vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhla
```bash
aws s3api get-object-acl --bucket <bucekt-name> --key flag
aws s3api put-object-acl --bucket <bucket-name> --key flag --version-id <value> --access-control-policy file://objacl.json
```
<details>

<summary><strong>qaStaHvIS AWS hacking vItlh zero to hero</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
