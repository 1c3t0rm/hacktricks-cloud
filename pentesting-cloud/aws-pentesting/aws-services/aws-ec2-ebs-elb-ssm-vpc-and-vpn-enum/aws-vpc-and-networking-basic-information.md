# AWS - VPC рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## AWS рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ

**VPC** рдореЗрдВ рдПрдХ **рдиреЗрдЯрд╡рд░реНрдХ CIDR** рд╣реЛрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ 10.0.0.0/16 (рдЗрд╕рдХреЗ **рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓** рдФрд░ **рдиреЗрдЯрд╡рд░реНрдХ ACL** рдХреЗ рд╕рд╛рде)ред

рдпрд╣ VPC рдиреЗрдЯрд╡рд░реНрдХ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХреНрд╕** рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ** рд╕реАрдзреЗ **VPC**, **рд░реВрдЯрд┐рдВрдЧ** **рдЯреЗрдмрд▓** рдФрд░ **рдиреЗрдЯрд╡рд░реНрдХ ACL** рд╕реЗ **рд╕рдВрдмрдВрдзрд┐рдд** рд╣реЛрддрд╛ рд╣реИред

рдлрд┐рд░, рд╕реЗрд╡рд╛рдУрдВ (рдЬреИрд╕реЗ EC2 рдЗрдВрд╕реНрдЯреЗрдВрд╕) рд╕реЗ рдЬреБрдбрд╝реЗ **рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕** **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХреНрд╕** рд╕реЗ **рдЬреБрдбрд╝реЗ** рд╣реЛрддреЗ рд╣реИрдВ **рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдк(s)** рдХреЗ рд╕рд╛рдеред

рдЗрд╕рд▓рд┐рдП, рдПрдХ **рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдк** рдиреЗрдЯрд╡рд░реНрдХ **рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдЙрдЬрд╛рдЧрд░ рдкреЛрд░реНрдЯреНрд╕ рдХреЛ рд╕реАрдорд┐рдд** рдХрд░реЗрдЧрд╛, **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛**ред рдФрд░ рдПрдХ **рдиреЗрдЯрд╡рд░реНрдХ ACL** **рдкреВрд░реЗ рдиреЗрдЯрд╡рд░реНрдХ** рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рдкреЛрд░реНрдЯреНрд╕ рдХреЛ **рд╕реАрдорд┐рдд** рдХрд░реЗрдЧрд╛ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП:

* рдПрдХ **рд╕рдмрдиреЗрдЯрд╡рд░реНрдХ** **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ IPv4 рдкрддреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрд╕рд╛рдЗрди** рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдПрдХ **рдЗрдВрд╕реНрдЯреЗрдВрд╕** рдЬреЛ **IPv4 рдкрддреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ рдПрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**
* рдПрдХ **рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗ** рдХреЛ **VPC** рд╕реЗ **рдЬреЛрдбрд╝рд╛** рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП
* рдЖрдк **Egress-only рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗ** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **NAT рдЧреЗрдЯрд╡реЗ** рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ **рдирд┐рдЬреА рд╕рдмрдиреЗрдЯ** рдореЗрдВ рд╣реЛ рддрд╛рдХрд┐ рдЙрд╕ рдирд┐рдЬреА рд╕рдмрдиреЗрдЯ рд╕реЗ **рдмрд╛рд╣рд░реА рд╕реЗрд╡рд╛рдУрдВ рд╕реЗ рдЬреБрдбрд╝рдирд╛ рд╕рдВрднрд╡** рд╣реЛ, рд▓реЗрдХрд┐рди **рдмрд╛рд╣рд░ рд╕реЗ рдЙрди рддрдХ рдкрд╣реБрдБрдЪрдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ** рд╣реИред
* NAT рдЧреЗрдЯрд╡реЗ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** (рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдБрдЪ) рдпрд╛ **рдирд┐рдЬреА** (рдЕрдиреНрдп VPCs рддрдХ рдкрд╣реБрдБрдЪ) рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../../.gitbook/assets/image (73).png>)

## VPC

Amazon **Virtual Private Cloud** (Amazon VPC) рдЖрдкрдХреЛ рдПрдХ рдЖрднрд╛рд╕реА рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ AWS рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ **рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИред рдЗрд╕ рдЖрднрд╛рд╕реА рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдХрдИ рд╕рдмрдиреЗрдЯреНрд╕, рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗрдЬ рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, ACLs, рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдкреНрд╕, IPs... рд╣реЛрдВрдЧреЗред

### рд╕рдмрдиреЗрдЯреНрд╕

рд╕рдмрдиреЗрдЯреНрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред **рд╕рдорд╛рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рддрд╛рд░реНрдХрд┐рдХ рд╕рдореВрд╣реАрдХрд░рдг** рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдореЗрдВ **рдкреНрд░рдмрдВрдзрди рдХреА рдЖрд╕рд╛рдиреА** рдмрдирд╛рдП рд░рдЦрдиреЗ рдореЗрдВ рднреА рдорджрдж рдХрд░рддрд╛ рд╣реИред

* рдорд╛рдиреНрдп CIDR /16 рдиреЗрдЯрдорд╛рд╕реНрдХ рд╕реЗ /28 рдиреЗрдЯрдорд╛рд╕реНрдХ рддрдХ рд╣реЛрддреЗ рд╣реИрдВред
* рдПрдХ рд╕рдмрдиреЗрдЯ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ред
* **AWS рдкреНрд░рддреНрдпреЗрдХ рд╕рдмрдиреЗрдЯ рдХреЗ рдкрд╣рд▓реЗ рддреАрди рд╣реЛрд╕реНрдЯ IP рдкрддреЗ рдХреЛ** **рдЖрдВрддрд░рд┐рдХ AWS рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ**: рдкрд╣рд▓рд╛ рд╣реЛрд╕реНрдЯ рдкрддрд╛ VPC рд░рд╛рдЙрдЯрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рдкрддрд╛ AWS DNS рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рд╣реИ рдФрд░ рддреАрд╕рд░рд╛ рдкрддрд╛ рднрд╡рд┐рд╖реНрдп рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рд╣реИред
* рдЙрдиреНрд╣реЗрдВ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕рдмрдиреЗрдЯреНрд╕** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ **рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рд╕реАрдзреА рдкрд╣реБрдБрдЪ рд╣реЛрддреА рд╣реИ, рдЬрдмрдХрд┐ рдирд┐рдЬреА рд╕рдмрдиреЗрдЯреНрд╕ рдХреЗ рдкрд╛рд╕ рдирд╣реАрдВ рд╣реЛрддреАред**

<figure><img src="https://lh5.googleusercontent.com/N_WTrTrDAHwN61FMKJvLSHVua2EM0IazHH1fSTg8JQfTChm-dLN9mn7wkjz2MlpD-uOUqtWdMZpqKOp4VxaHy5-5X66GD1K8y1UGc27r-GbHdFty9ImpXdcjEsC7u4vjxKme_B_HwDOUnG6camxENYECTw=s2048" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh3.googleusercontent.com/MmjfVzGmV4jM7tO8lVoTKONoeqbq6E40DGeKUoo4kN-lmMDKnEiGNB-gGVx3EvjK9UV844im225CA8aAjomHf1Modt3MramHrHZdEGbeSZncWhVuT9R8f7tQZ2pXjdSJxeNfErmJ-0mmcUaV6dcU0TAd2A=s2048" alt=""><figcaption></figcaption></figure>

### рд░реВрдЯ рдЯреЗрдмрд▓реНрд╕

рд░реВрдЯ рдЯреЗрдмрд▓реНрд╕ рдПрдХ VPC рдХреЗ рднреАрддрд░ рдПрдХ рд╕рдмрдиреЗрдЯ рдХреЗ рд▓рд┐рдП рдЯреНрд░реИрдлрд┐рдХ рд░реВрдЯрд┐рдВрдЧ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рддреЗ рд╣реИрдВред рд╡реЗ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рдпрд╛ рдПрдХ VPN рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдк рдЖрдорддреМрд░ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХ рдкрд╣реБрдБрдЪ рдкрд╛рдПрдВрдЧреЗ:

* рд╕реНрдерд╛рдиреАрдп VPC
* NAT
* рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗрдЬ / Egress-only рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗрдЬ (рдПрдХ VPC рдХреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рддрдХ рдкрд╣реБрдБрдЪ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ)ред
* рдПрдХ рд╕рдмрдиреЗрдЯ рдХреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЕрдкрдиреЗ VPC рд╕реЗ рдПрдХ **рдЗрдВрдЯрд░рдиреЗрдЯ рдЧреЗрдЯрд╡реЗ** **рдмрдирд╛рдиреЗ** рдФрд░ **рдЬреЛрдбрд╝рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
* VPC рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ (рдирд┐рдЬреА рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рд╕реЗ S3 рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░реЛрдВ рдореЗрдВ рдЖрдк рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдПрдХ рдирд┐рдЬреА рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЕрдВрддрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="https://lh3.googleusercontent.com/q4ASpcLAYqijdNMLhMLl8EoowDtTMU5I_7YCVfk7-5hxDyeQOik9ImHnD2SYy32XUA2qXjEbXTAxA1lP--znJASdhYOdBveDcrD42f9XBKZ3EmjJCazN3YPLC6oS0xtRMmfORuwCszmMt-KrAkH07_izwg=s2048" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh5.googleusercontent.com/30psylXAI0gRN6_LK-reP00aGIlMma64E1qafCVPunn6nS-y5jAO6Y2JiempKcf6-LFi7ScicYcOh7BbHEya2VWtksnFX_8SPXQf97tKkg2tNZzrArWbiDCCn2m2LP1QUq6MZ_KayH3yir7t8zpO7CEQOw=s2048" alt=""><figcaption></figcaption></figure>

### ACLs

**рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓ рд▓рд┐рд╕реНрдЯреНрд╕ (ACLs)**: рдиреЗрдЯрд╡рд░реНрдХ ACLs рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо рд╣реИрдВ рдЬреЛ рдПрдХ рд╕рдмрдиреЗрдЯ рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдФрд░ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд╡реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ IP рдкрддреЛрдВ рдпрд╛ рд░реЗрдВрдЬреЛрдВ рдХреЗ рд▓рд┐рдП рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

* рдпрд╣ рдЕрдзрд┐рдХрддрд░ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЧреНрд░реБрдкреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдБрдЪ рдХреА рдЕрдиреБрдорддрд┐/рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣реА рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реИ рдЬ
