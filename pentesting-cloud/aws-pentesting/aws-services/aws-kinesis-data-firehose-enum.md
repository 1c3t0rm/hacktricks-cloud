# AWS - Kinesis Data Firehose Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

## Kinesis Data Firehose

Amazon Kinesis Data Firehose는 **완전히 관리되는 서비스**로, **실시간 스트리밍 데이터**의 전달을 용이하게 합니다. Amazon Simple Storage Service (Amazon S3), Amazon Redshift, Amazon OpenSearch Service, Splunk 및 사용자 정의 HTTP 엔드포인트를 포함한 다양한 대상을 지원합니다.

이 서비스는 데이터 생산자가 데이터를 직접 Kinesis Data Firehose로 전달하도록 구성할 수 있어 애플리케이션 작성이나 리소스 관리의 필요성을 줄여줍니다. 이 서비스는 데이터를 지정된 대상으로 **자동으로 전달**하는 역할을 담당합니다. 또한, Kinesis Data Firehose는 데이터를 전달하기 전에 **데이터를 변환**하는 옵션을 제공하여 유연성과 다양한 사용 사례에 적용 가능합니다.

### 열거
```bash
# Get delivery streams
aws firehose list-delivery-streams

# Get stream info
aws firehose describe-delivery-stream --delivery-stream-name <name>
## Get roles
aws firehose describe-delivery-stream --delivery-stream-name <name> | grep -i RoleARN
```
## 사후 침투 / 방어 우회

Firehose가 로그 또는 방어 정보를 전송하는 데 사용되는 경우, 공격자는 이러한 기능을 사용하여 제대로 작동하지 않도록 방해할 수 있습니다.

### firehose:DeleteDeliveryStream
```
aws firehose delete-delivery-stream --delivery-stream-name <value> --allow-force-delete
```
### firehose:UpdateDestination

`firehose:UpdateDestination`는 AWS Kinesis Data Firehose 서비스에서 사용되는 권한입니다. 이 권한은 Firehose 배달 대상의 구성을 업데이트하는 데 사용됩니다. 

이 권한을 가진 사용자는 Firehose 배달 대상의 업데이트를 수행할 수 있으며, 이를 통해 데이터 전송을 제어하고 구성을 변경할 수 있습니다. 

이 권한을 부여할 때는 주의해야 합니다. 권한이 부여된 사용자는 Firehose 배달 대상을 임의로 변경할 수 있으므로, 신중하게 관리해야 합니다.
```
aws firehose update-destination --delivery-stream-name <value> --current-delivery-stream-version-id <value> --destination-id <value>
```
### firehose:PutRecord | firehose:PutRecordBatch

`firehose:PutRecord` 및 `firehose:PutRecordBatch`는 Amazon Kinesis Data Firehose 서비스에서 사용되는 두 가지 API 작업입니다.

`firehose:PutRecord`는 단일 레코드를 Kinesis Data Firehose 스트림에 전송하는 데 사용됩니다. 이 작업은 단일 레코드를 전송하고 응답으로 성공 또는 실패를 반환합니다.

`firehose:PutRecordBatch`는 여러 레코드를 한 번에 Kinesis Data Firehose 스트림에 전송하는 데 사용됩니다. 이 작업은 여러 레코드를 전송하고 응답으로 각 레코드의 성공 또는 실패를 반환합니다.

이러한 API 작업은 Kinesis Data Firehose 스트림에 데이터를 전송하는 데 사용되므로, 악의적인 사용자가 이를 이용하여 데이터 유출을 시도할 수 있습니다. 따라서 적절한 보안 조치를 적용하여 이러한 API 작업의 권한을 관리해야 합니다.
```
aws firehose put-record --delivery-stream-name my-stream --record '{"Data":"SGVsbG8gd29ybGQ="}'

aws firehose put-record-batch --delivery-stream-name my-stream --records file://records.json
```
## 참고 자료

* [https://docs.amazonaws.cn/en\_us/firehose/latest/dev/what-is-this-service.html](https://docs.amazonaws.cn/en\_us/firehose/latest/dev/what-is-this-service.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family)인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
