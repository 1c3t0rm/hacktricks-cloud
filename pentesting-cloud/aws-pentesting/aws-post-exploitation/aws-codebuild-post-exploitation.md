# AWS - CodeBuild Nach der Kompromittierung

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## CodeBuild

F√ºr weitere Informationen, √ºberpr√ºfen Sie:

{% content-ref url="../../aws-security/aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-security/aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### Missbrauch des Zugriffs auf CodeBuild-Repository

Um **CodeBuild** zu konfigurieren, ben√∂tigt es **Zugriff auf das Code-Repository**, das es verwenden wird. Mehrere Plattformen k√∂nnten diesen Code hosten:

<figure><img src="../../../.gitbook/assets/image (3) (5).png" alt=""><figcaption></figcaption></figure>

Das **CodeBuild-Projekt muss Zugriff** auf den konfigurierten Quellcode-Anbieter haben, entweder √ºber eine **IAM-Rolle** oder mit einem github/bitbucket **Token oder OAuth-Zugriff**.

Ein Angreifer mit **erh√∂hten Berechtigungen √ºber ein CodeBuild** k√∂nnte diesen konfigurierten Zugriff missbrauchen, um den Code des konfigurierten Repositorys und anderer Repositorys, auf die die festgelegten Anmeldeinformationen Zugriff haben, preiszugeben.\
Um dies zu tun, m√ºsste ein Angreifer nur die **Repository-URL zu jedem Repository √§ndern, auf das die Konfigurationsanmeldeinformationen Zugriff haben** (beachten Sie, dass die AWS-Webseite alle f√ºr Sie auflistet):

<figure><img src="../../../.gitbook/assets/image (11) (1) (2).png" alt=""><figcaption></figcaption></figure>

Und **√§ndern Sie die Buildspec-Befehle, um jedes Repository zu exfiltrieren**.

{% hint style="warning" %}
Diese **Aufgabe ist jedoch wiederholend und m√ºhsam**, und wenn ein Github-Token mit **Schreibberechtigungen** konfiguriert wurde, kann ein Angreifer **diese Berechtigungen nicht (miss)brauchen**, da er keinen Zugriff auf den Token hat.\
Oder etwa doch? √úberpr√ºfen Sie den n√§chsten Abschnitt.
{% endhint %}

### Offenlegung von Zugriffstoken von AWS CodeBuild

Sie k√∂nnen den in CodeBuild gegebenen Zugriff auf Plattformen wie Github preisgeben. √úberpr√ºfen Sie, ob Zugriff auf externe Plattformen gew√§hrt wurde mit:
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-post-exploitation/aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-post-exploitation/aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

Ein Angreifer k√∂nnte ein gesamtes CodeBuild-Projekt l√∂schen, was zum Verlust der Projektkonfiguration f√ºhren und Anwendungen beeintr√§chtigen k√∂nnte, die auf dem Projekt basieren.
```bash
aws codebuild delete-project --name <value>
```
**Potenzielle Auswirkungen**: Verlust der Projektkonfiguration und Serviceunterbrechung f√ºr Anwendungen, die das gel√∂schte Projekt verwenden.

### `codebuild:TagResource`, `codebuild:UntagResource`

Ein Angreifer k√∂nnte Tags zu CodeBuild-Ressourcen hinzuf√ºgen, √§ndern oder entfernen und damit die Kostenzuweisung, Ressourcenverfolgung und Zugriffskontrollrichtlinien Ihrer Organisation basierend auf Tags st√∂ren.
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**Potenzielle Auswirkungen**: St√∂rung der Kostenzuweisung, Ressourcenverfolgung und tagbasierten Zugriffskontrollrichtlinien.

### `codebuild:DeleteSourceCredentials`

Ein Angreifer k√∂nnte Quellzugangsdaten f√ºr ein Git-Repository l√∂schen, was sich auf die normale Funktion von Anwendungen auswirken w√ºrde, die auf das Repository angewiesen sind.
```sql
aws codebuild delete-source-credentials --arn <value>
```
**Potenzielle Auswirkungen**: St√∂rung der normalen Funktion f√ºr Anwendungen, die sich auf das betroffene Repository verlassen, aufgrund der Entfernung von Quellzugriffsberechtigungen.

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
