# Surveillance avec Falco

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**d√©p√¥ts Github de HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Ce tutoriel a √©t√© pris √† partir de [https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-information](https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-information)

### Informations sur le sc√©nario

Ce sc√©nario d√©ploie une surveillance et une d√©tection de s√©curit√© en temps d'ex√©cution pour les conteneurs et les ressources Kubernetes.

* Pour commencer ce sc√©nario, vous pouvez d√©ployer le chart Helm ci-dessous avec la version 3

> NOTE : Assurez-vous d'ex√©cuter le d√©ploiement suivant √† l'aide de Helm avec la version 3.

```bash
helm repo add falcosecurity https://falcosecurity.github.io/charts
helm repo update
helm install falco falcosecurity/falco
```

![Configuration de Falco avec Helm dans le sc√©nario 18](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-1.png)

### [Solution du sc√©nario](https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-solution)

> `Falco`, le projet de s√©curit√© en temps d'ex√©cution natif du cloud, est le moteur de d√©tection de menaces Kubernetes de facto. Falco a √©t√© cr√©√© par Sysdig en 2016 et est le premier projet de s√©curit√© en temps d'ex√©cution √† rejoindre CNCF en tant que projet de niveau incubation. Falco d√©tecte les comportements d'application inattendus et alerte sur les menaces en temps d'ex√©cution.

Falco utilise des appels syst√®me pour s√©curiser et surveiller un syst√®me, en :

* Analyse des appels syst√®me Linux du noyau en temps d'ex√©cution
* V√©rifiant le flux par rapport √† un moteur de r√®gles puissant
* Alertant lorsqu'une r√®gle est viol√©e

Falco est livr√© avec un ensemble de r√®gles par d√©faut qui v√©rifient le noyau pour des comportements inhabituels tels que :

* Escalade de privil√®ges en utilisant des conteneurs privil√©gi√©s
* Changements de namespace en utilisant des outils tels que `setns`
* Lecture/√©criture dans des r√©pertoires bien connus tels que /etc, /usr/bin, /usr/sbin, etc.
* Cr√©ation de liens symboliques
* Changements de propri√©t√© et de mode
* Connexions r√©seau inattendues ou mutations de socket
* Processus engendr√©s en utilisant execve
* Ex√©cution de binaires shell tels que sh, bash, csh, zsh, etc.
* Ex√©cution de binaires SSH tels que ssh, scp, sftp, etc.
* Mutation des ex√©cutables coreutils Linux
* Mutation des binaires de connexion
* Mutation des ex√©cutables shadowutil ou passwd tels que shadowconfig, pwck, chpasswd, getpasswd, change, useradd, etc., et autres.
* Obtenez plus de d√©tails sur le d√©ploiement de Falco

```bash
kubectl get pods --selector app=falco
```

![Obtention des pods de Falco dans le sc√©nario 18](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-2.png)

* Obtenir manuellement les journaux des syst√®mes Falco

```bash
kubectl logs -f -l app=falco
```

* Maintenant, lan√ßons un conteneur pirate et lisons un fichier sensible pour voir s'il est d√©tect√© par Falco

```bash
kubectl run --rm --restart=Never -it --image=madhuakula/hacker-container -- bash
```

* Lire le fichier sensible

```bash
cat /etc/shadow
```

![D√©tection de /etc/shadow par Falco dans le sc√©nario 18](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-3.png)

<details>

<summary><strong>Soutenez HackTricks et b√©n√©ficiez d'avantages !</strong></summary>

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou si vous souhaitez acc√©der √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de piratage en soumettant des PR aux** [**d√©p√¥ts Github de HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>