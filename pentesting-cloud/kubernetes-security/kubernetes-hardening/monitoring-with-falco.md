# Falco рдХреЗ рд╕рд╛рде рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ

<details>

<summary><strong>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

рдпрд╣ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ [https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-information](https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-information) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

### рд╕реНрдерд┐рддрд┐ рд╕реВрдЪрдирд╛

рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдХрдВрдЯреЗрдирд░ рдФрд░ рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд░рдирдЯрд╛рдЗрдо рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХреА рдЬрд╛рддреА рд╣реИред

* рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╣реЗрд▓реНрдо рдЪрд╛рд░реНрдЯ рдХреЛ рд╕рдВрд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг 3 рд╣реИ

> рдзреНрдпрд╛рди рджреЗрдВ: рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЛ рд╣реЗрд▓реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ v3 рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рддреЗ рд╣реИрдВред
```bash
helm repo add falcosecurity https://falcosecurity.github.io/charts
helm repo update
helm install falco falcosecurity/falco
```
![рд╕реНрдерд┐рддрд┐ 18 рд╣реЗрд▓реНрдо рдлрд╛рд▓реНрдХреЛ рд╕реЗрдЯрдЕрдк](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-1.png)

### [рд╕реНрдерд┐рддрд┐ рдХрд╛ рд╕рдорд╛рдзрд╛рди](https://madhuakula.com/kubernetes-goat/scenarios/scenario-18.html#scenario-solution)

> `Falco`, рдХреНрд▓рд╛рдЙрдб-рдкреНрд░рд╛рдХреГрддрд┐рдХ рд░рдирдЯрд╛рдЗрдо рд╕реБрд░рдХреНрд╖рд╛ рдкрд░рд┐рдпреЛрдЬрдирд╛, рдХреБрдмрд░рдиреЗрдЯреАрдЬрд╝ рдХреЗ рдзрдордХреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЗрдВрдЬрди рд╣реИред рдлрд╛рд▓реНрдХреЛ рдХреЛ рд╕рд┐рд╕рдбрд┐рдЧ рдиреЗ 2016 рдореЗрдВ рдмрдирд╛рдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдкрд╣рд▓рд╛ рд░рдирдЯрд╛рдЗрдо рд╕реБрд░рдХреНрд╖рд╛ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИ рдЬреЛ CNCF рдХреЗ рдПрдХ рдЗрдВрдХреНрдпреВрдмреЗрд╢рди рд╕реНрддрд░ рдХреЗ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реБрдИ рд╣реИред рдлрд╛рд▓реНрдХреЛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ рдФрд░ рд░рдирдЯрд╛рдЗрдо рдкрд░ рдзрдордХрд┐рдпреЛрдВ рдкрд░ рдЪреЗрддрд╛рд╡рдиреА рджреЗрддрд╛ рд╣реИред

рдлрд╛рд▓реНрдХреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдФрд░ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛:

* рд░рдирдЯрд╛рдЗрдо рдкрд░ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓реНрд╕ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛
* рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдирд┐рдпрдо рдЗрдВрдЬрди рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реНрдЯреНрд░реАрдо рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдирд╛
* рдирд┐рдпрдо рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рд╣реЛрдиреЗ рдкрд░ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдирд╛

рдлрд╛рд▓реНрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдирд┐рдпрдо рд╕реЗрдЯ рдХреЗ рд╕рд╛рде рд╢рд┐рдк рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:

* рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡рд╛рд▓реЗ рдХрдВрдЯреЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдирд╛
* `setns` рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдорд╕реНрдкреЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди
* /etc, /usr/bin, /usr/sbin рдЖрджрд┐ рдЬреИрд╕реЗ рдЬреНрдЮрд╛рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдкрдврд╝рдирд╛/рд▓рд┐рдЦрдирд╛
* рд╕рд┐рдорд▓рд┐рдВрдХ рдмрдирд╛рдирд╛
* рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдФрд░ рдореЛрдб рдкрд░рд┐рд╡рд░реНрддрди
* рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдпрд╛ рд╕реЙрдХреЗрдЯ рдореНрдпреВрдЯреЗрд╢рди
* execve рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрдиреНрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ
* sh, bash, csh, zsh рдЖрджрд┐ рдЬреИрд╕реЗ рд╢реЗрд▓ рдмрд╛рдЗрдирд░реА рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди
* ssh, scp, sftp рдЖрджрд┐ рдЬреИрд╕реЗ SSH рдмрд╛рдЗрдирд░реА рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди
* рд▓рд┐рдирдХреНрд╕ рдХреЛрд░рдпреВрдЯрд┐рд▓реНрд╕ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓реНрд╕ рдХрд╛ рдореНрдпреВрдЯреЗрд╢рди
* рд▓реЙрдЧрд┐рди рдмрд╛рдЗрдирд░реА рдХрд╛ рдореНрдпреВрдЯреЗрд╢рди
* рд╢реИрдбреЛрдЙрдЯрд┐рд▓ рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓реНрд╕ рдЬреИрд╕реЗ shadowconfig, pwck, chpasswd, getpasswd, change, useradd рдЖрджрд┐ рдХрд╛ рдореНрдпреВрдЯреЗрд╢рди, рдФрд░ рдЕрдиреНрдпред
* рдлрд╛рд▓реНрдХреЛ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
kubectl get pods --selector app=falco
```
![рд╕реНрдерд┐рддрд┐ 18 рдлрд╛рд▓реНрдХреЛ рдкреЙрдбреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-2.png)

* рдлрд╛рд▓реНрдХреЛ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд▓реЙрдЧреНрд╕ рд╣рд╕реНрддрд┐рдпрд╛рд░ рдХрд░рдирд╛
```bash
kubectl logs -f -l app=falco
```
* рдЕрдм, рдПрдХ рд╣реИрдХрд░ рдХрдВрдЯреЗрдирд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░реЗрдВ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ Falco рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ
```bash
kubectl run --rm --restart=Never -it --image=madhuakula/hacker-container -- bash
```
* рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
cat /etc/shadow
```
![рд╕реНрдерд┐рддрд┐ 18 рдлрд╛рд▓реНрдХреЛ /etc/shadow рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ](https://madhuakula.com/kubernetes-goat/scenarios/images/sc-18-3.png)

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ рдЯреНрд╡рд┐рдЯрд░ рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos**.

</details>
