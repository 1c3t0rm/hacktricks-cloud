# GCP - Firebase Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)でゼロからヒーローまでのAWSハッキングを学ぶ</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**してください。
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングのコツを共有してください。

</details>

## [Firebase](https://cloud.google.com/sdk/gcloud/reference/firebase/)

Firebaseリアルタイムデータベースは、リアルタイムでユーザー間でデータを保存および同期させることができるクラウドホスト型のNoSQLデータベースです。[詳細を学ぶ](https://firebase.google.com/products/realtime-database/)。

### 認証されていないEnum

**Firebaseエンドポイント**は**モバイルアプリケーション**で見つかることがあります。Firebaseエンドポイントが誤って設定されていて、誰でも読み取り（および書き込み）権限を持っている可能性があります。

不適切に設定されたFirebaseデータベースを検索して悪用する一般的な方法論は以下の通りです:

1. **APKを取得する** このPOCには、デバイスからAPKを取得するためのツールを使用できます。\
「APK Extractor」を使用できます [https://play.google.com/store/apps/details?id=com.ext.ui\&hl=e](https://hackerone.com/redirect?signature=3774f35d1b5ea8a4fd209d80084daa9f5887b105\&url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.ext.ui%26hl%3Den)
2. **APKを逆コンパイルする** **apktool**を使用してAPKからソースコードを抽出するには、以下のコマンドに従ってください。
3. _**res/values/strings.xml**_ に移動し、「**firebase**」キーワードを**検索**します
4. このようなURLを見つけるかもしれません "_**https://xyz.firebaseio.com/**_"
5. 次に、ブラウザで見つかったURLに**移動します**: _https://xyz.firebaseio.com/.json_
6. 2種類の応答が表示される可能性があります:
   1. "**Permission Denied**": これはアクセスできないことを意味し、適切に設定されています
   2. "**null**" 応答または多くの**JSONデータ**: これはデータベースが公開されており、少なくとも読み取りアクセス権を持っていることを意味します。
      1. この場合、**書き込み権限をチェック**することができます。書き込み権限をテストするためのエクスプロイトはこちらで見つけることができます: [https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit](https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit)

**興味深い注記**: **MobSF**を使用してモバイルアプリケーションを分析する際、Firebaseデータベースを見つけると、これが**公開されているかどうか**をチェックし、通知します。

代わりに、以下に示すように、上記のタスクを自動化するPythonスクリプトである[Firebase Scanner](https://github.com/shivsahni/FireBaseScanner)を使用することもできます：
```bash
python FirebaseScanner.py -f <commaSeperatedFirebaseProjectNames>
```
### 認証済みEnum

Firebaseデータベースにアクセスするための資格情報を持っている場合、[**Baserunner**](https://github.com/iosiro/baserunner)のようなツールを使用して、保存されている情報により簡単にアクセスできます。または、次のようなスクリプトを使用します：
```python
#Taken from https://blog.assetnote.io/bug-bounty/2020/02/01/expanding-attack-surface-react-native/
import pyrebase

config = {
"apiKey": "FIREBASE_API_KEY",
"authDomain": "FIREBASE_AUTH_DOMAIN_ID.firebaseapp.com",
"databaseURL": "https://FIREBASE_AUTH_DOMAIN_ID.firebaseio.com",
"storageBucket": "FIREBASE_AUTH_DOMAIN_ID.appspot.com",
}

firebase = pyrebase.initialize_app(config)

db = firebase.database()

print(db.get())
```
データベースへの書き込みなど、他のアクションをテストするには、[こちら](https://github.com/thisbejim/Pyrebase)で見つけることができるPyrebaseのドキュメントを参照してください。

### APPIDとAPIキーを使ったアクセス情報 <a href="#access-info-with-appid-and-api-key" id="access-info-with-appid-and-api-key"></a>

iOSアプリケーションを逆コンパイルして`GoogleService-Info.plist`ファイルを開くと、APIキーとAPP IDが見つかるかもしれません：

* APIキー **AIzaSyAs1\[...]**
* APP ID **1:612345678909:ios:c212345678909876**

興味深い情報にアクセスできる可能性があります。

**リクエスト**

`curl -v -X POST "https://firebaseremoteconfig.googleapis.com/v1/projects/612345678909/namespaces/firebase:fetch?key=AIzaSyAs1[...]" -H "Content-Type: application/json" --data '{"appId": "1:612345678909:ios:c212345678909876", "appInstanceId": "PROD"}'`

## 参考文献 <a href="#references" id="references"></a>

* ​[https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/](https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/)​
* ​[https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1](https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1)​

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式のPEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有**してください。

</details>
