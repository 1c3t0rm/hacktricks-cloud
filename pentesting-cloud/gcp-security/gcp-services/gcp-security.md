# GCP - S√©curit√©

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## Informations de base

La s√©curit√© de la Google Cloud Platform (GCP) englobe une **suite compl√®te d'outils** et de pratiques con√ßus pour assurer la **s√©curit√©** des ressources et des donn√©es au sein de l'environnement Google Cloud, divis√©e en quatre sections principales : **Centre de commandement de s√©curit√©, D√©tections et contr√¥les, Protection des donn√©es et Zero Trust.**

## **Centre de commandement de s√©curit√©**

Le Centre de commandement de s√©curit√© (SCC) de la Google Cloud Platform (GCP) est un **outil de gestion des risques et de la s√©curit√© pour les ressources GCP** qui permet aux organisations d'obtenir une visibilit√© et un contr√¥le sur leurs actifs cloud. Il aide √† **d√©tecter et r√©pondre aux menaces** en offrant des analyses de s√©curit√© compl√®tes, en **identifiant les mauvaises configurations**, en assurant la **conformit√©** aux normes de s√©curit√©, et en **s'int√©grant** √† d'autres outils de s√©curit√© pour la d√©tection et la r√©ponse automatis√©es aux menaces.

* **Aper√ßu** : Panneau pour **visualiser un aper√ßu** de tous les r√©sultats du Centre de commandement de s√©curit√©.
* Menaces : \[Premium requis] Panneau pour visualiser toutes les **menaces d√©tect√©es. Consultez plus d'informations sur les Menaces ci-dessous**
* **Vuln√©rabilit√©s** : Panneau pour **visualiser les mauvaises configurations trouv√©es dans le compte GCP**.
* **Conformit√©** : \[Premium requis] Cette section permet de **tester votre environnement GCP par rapport √† plusieurs v√©rifications de conformit√©** (telles que PCI-DSS, NIST 800-53, les benchmarks CIS...) au sein de l'organisation.
* **Actifs** : Cette section **affiche tous les actifs utilis√©s**, tr√®s utile pour les administrateurs syst√®me (et peut-√™tre les attaquants) pour voir ce qui est en cours d'ex√©cution sur une seule page.
* **R√©sultats** : Ceci **agr√®ge** dans un **tableau les r√©sultats** des diff√©rentes sections de la s√©curit√© GCP (pas seulement du Centre de commandement) pour pouvoir visualiser facilement les r√©sultats importants.
* **Sources** : Affiche un **r√©sum√© des r√©sultats** de toutes les diff√©rentes sections de la s√©curit√© GCP **par section**.
* **Posture** : \[Premium requis] La Posture de s√©curit√© permet de **d√©finir, √©valuer et surveiller la s√©curit√© de l'environnement GCP**. Elle fonctionne en cr√©ant une politique qui d√©finit des contraintes ou des restrictions qui contr√¥lent/surveillent les ressources dans GCP. Il existe plusieurs mod√®les de posture pr√©d√©finis qui peuvent √™tre trouv√©s sur [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)

### **Menaces**

Du point de vue d'un attaquant, il s'agit probablement de la **fonctionnalit√© la plus int√©ressante car elle pourrait d√©tecter l'attaquant**. Cependant, notez que cette fonctionnalit√© n√©cessite un **Premium** (ce qui signifie que l'entreprise devra payer plus), donc elle **pourrait ne pas m√™me √™tre activ√©e**.&#x20;

Il existe 3 types de m√©canismes de d√©tection des menaces :

* **Menaces d'√©v√©nements** : R√©sultats produits en faisant correspondre des √©v√©nements de **Cloud Logging** bas√©s sur des **r√®gles cr√©√©es** en interne par Google. Il peut √©galement analyser les **logs de Google Workspace**.
* Il est possible de trouver la description de toutes les [**r√®gles de d√©tection dans la documentation**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **Menaces de conteneurs** : R√©sultats produits apr√®s l'analyse du comportement de bas niveau du noyau des conteneurs.
* **Menaces personnalis√©es** : R√®gles cr√©√©es par l'entreprise.

Il est possible de trouver des r√©ponses recommand√©es aux menaces d√©tect√©es des deux types sur [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response)

### √ânum√©ration

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## D√©tections et Contr√¥les

* **Chronicle SecOps**: Une suite avanc√©e d'op√©rations de s√©curit√© con√ßue pour aider les √©quipes √† augmenter leur vitesse et leur impact dans les op√©rations de s√©curit√©, y compris la d√©tection des menaces, l'investigation et la r√©ponse.
* **reCAPTCHA Enterprise**: Un service qui prot√®ge les sites Web contre les activit√©s frauduleuses telles que le scraping, le bourrage d'identifiants et les attaques automatis√©es en distinguant les utilisateurs humains des robots.
* **Web Security Scanner**: Outil d'analyse de s√©curit√© automatis√© qui d√©tecte les vuln√©rabilit√©s et les probl√®mes de s√©curit√© courants dans les applications Web h√©berg√©es sur Google Cloud ou un autre service Web.
* **Risk Manager**: Un outil de gouvernance, de risque et de conformit√© (GRC) qui aide les organisations √† √©valuer, documenter et comprendre leur posture de risque sur Google Cloud.
* **Binary Authorization**: Un contr√¥le de s√©curit√© pour les conteneurs qui garantit que seules des images de conteneurs de confiance sont d√©ploy√©es sur des clusters Kubernetes Engine selon les politiques d√©finies par l'entreprise.
* **Notifications d'Avis**: Un service qui fournit des alertes et des avis sur les probl√®mes de s√©curit√© potentiels, les vuln√©rabilit√©s et les actions recommand√©es pour maintenir la s√©curit√© des ressources.
* **Approbation d'Acc√®s**: Une fonctionnalit√© qui permet aux organisations d'exiger une approbation explicite avant que les employ√©s de Google puissent acc√©der √† leurs donn√©es ou configurations, offrant ainsi une couche de contr√¥le et d'audit suppl√©mentaire.
* **Managed Microsoft AD**: Un service offrant une gestion active de Microsoft Active Directory (AD) qui permet aux utilisateurs d'utiliser leurs applications et charges de travail existantes d√©pendant de Microsoft AD sur Google Cloud.

## Protection des Donn√©es

* **Protection des Donn√©es Sensibles**: Outils et pratiques visant √† prot√©ger les donn√©es sensibles, telles que les informations personnelles ou la propri√©t√© intellectuelle, contre tout acc√®s ou exposition non autoris√©.
* **Pr√©vention de la Perte de Donn√©es (DLP)**: Un ensemble d'outils et de processus utilis√©s pour identifier, surveiller et prot√©ger les donn√©es en cours d'utilisation, en mouvement et au repos gr√¢ce √† une inspection approfondie du contenu et √† l'application d'un ensemble complet de r√®gles de protection des donn√©es.
* **Service d'Autorit√© de Certification**: Un service √©volutif et s√©curis√© qui simplifie et automatise la gestion, le d√©ploiement et le renouvellement des certificats SSL/TLS pour les services internes et externes.
* **Gestion des Cl√©s**: Un service bas√© sur le cloud qui vous permet de g√©rer les cl√©s cryptographiques de vos applications, y compris la cr√©ation, l'importation, la rotation, l'utilisation et la destruction des cl√©s de chiffrement. Plus d'informations dans:

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Gestionnaire de Certificats**: Un service qui g√®re et d√©ploie des certificats SSL/TLS, garantissant des connexions s√©curis√©es et chiffr√©es √† vos services Web et applications.
* **Gestionnaire de Secrets**: Un syst√®me de stockage s√©curis√© et pratique pour les cl√©s API, les mots de passe, les certificats et autres donn√©es sensibles, qui permet un acc√®s et une gestion faciles et s√©curis√©s de ces secrets dans les applications. Plus d'informations dans:

{% content-ref url="../../gcp-pentesting/gcp-services/gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](../../gcp-pentesting/gcp-services/gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Z√©ro Confiance

* **BeyondCorp Enterprise**: Une plateforme de s√©curit√© de confiance z√©ro qui permet un acc√®s s√©curis√© aux applications internes sans avoir besoin d'un VPN traditionnel, en se basant sur la v√©rification de la confiance de l'utilisateur et du p√©riph√©rique avant d'accorder l'acc√®s.
* **R√©solveur de Probl√®mes de Politique**: Un outil con√ßu pour aider les administrateurs √† comprendre et r√©soudre les probl√®mes d'acc√®s dans leur organisation en identifiant pourquoi un utilisateur a acc√®s √† certaines ressources ou pourquoi l'acc√®s a √©t√© refus√©, aidant ainsi √† faire respecter les politiques de confiance z√©ro.
* **Proxy Sensible √† l'Identit√© (IAP)**: Un service qui contr√¥le l'acc√®s aux applications cloud et aux machines virtuelles s'ex√©cutant sur Google Cloud, sur site ou sur d'autres clouds, en se basant sur l'identit√© et le contexte de la demande plut√¥t que sur le r√©seau d'origine de la demande.
* **Contr√¥les de Service VPC**: P√©rim√®tres de s√©curit√© qui fournissent des couches de protection suppl√©mentaires aux ressources et services h√©berg√©s dans le Cloud priv√© virtuel (VPC) de Google Cloud, emp√™chant l'exfiltration de donn√©es et fournissant un contr√¥le d'acc√®s granulaire.
* **Gestionnaire de Contexte d'Acc√®s**: Faisant partie de BeyondCorp Enterprise de Google Cloud, cet outil aide √† d√©finir et √† appliquer des politiques de contr√¥le d'acc√®s fines bas√©es sur l'identit√© de l'utilisateur et le contexte de sa demande, tel que le statut de s√©curit√© du p√©riph√©rique, l'adresse IP, et plus encore.
