# GCP - Volharding

## Inleiding

In dit gedeelte zullen we ons richten op het verkrijgen van volharding in Google Cloud Platform (GCP)-omgevingen. Volharding verwijst naar het vermogen om toegang te behouden tot een systeem, zelfs nadat de initiÃ«le toegang is verkregen. Dit is een belangrijk aspect van het behouden van toegang tot een doelsysteem en kan worden gebruikt voor verschillende doeleinden, zoals het verzamelen van informatie, het uitvoeren van aanvallen of het handhaven van een aanwezigheid in het systeem.

## 1. Service Accounts

Serviceaccounts zijn een belangrijk onderdeel van GCP en worden gebruikt om resources te beheren en toegang te verlenen tot verschillende services. Ze kunnen worden gebruikt om volharding te bereiken door de juiste machtigingen aan een serviceaccount toe te kennen en vervolgens toegang te behouden tot de resources die aan dat account zijn gekoppeld.

### 1.1. Sleutelbestanden

Sleutelbestanden worden gebruikt om toegang te krijgen tot serviceaccounts. Als een aanvaller toegang heeft tot een sleutelbestand, kan hij/zij zich authenticeren als het serviceaccount en toegang krijgen tot de bijbehorende resources. Het is belangrijk om de toegang tot sleutelbestanden strikt te beperken en ervoor te zorgen dat ze veilig worden opgeslagen.

### 1.2. Machtigingen

Door de juiste machtigingen aan een serviceaccount toe te kennen, kan een aanvaller volharding bereiken. Dit kan bijvoorbeeld worden gedaan door het serviceaccount de rol van 'Projecteigenaar' toe te kennen, waardoor het account toegang heeft tot alle resources binnen het project. Het is belangrijk om de machtigingen van serviceaccounts regelmatig te controleren en onnodige machtigingen te verwijderen.

## 2. Cloud Functions

Cloud Functions is een serverloze compute-service die code uitvoert in reactie op gebeurtenissen. Het kan worden gebruikt om volharding te bereiken door een kwaadaardige functie te implementeren die periodiek wordt uitgevoerd en toegang behoudt tot de GCP-resources.

### 2.1. Triggers

Triggers kunnen worden gebruikt om Cloud Functions te activeren. Een aanvaller kan bijvoorbeeld een trigger instellen op basis van een tijdsinterval, zodat de kwaadaardige functie periodiek wordt uitgevoerd. Dit stelt de aanvaller in staat om toegang te behouden tot de resources en eventuele wijzigingen in het systeem te monitoren.

### 2.2. Toegangscontrole

Het is belangrijk om de toegangscontrole voor Cloud Functions strikt te beheren. Door de juiste machtigingen toe te kennen aan de functie, kan een aanvaller volharding bereiken. Het is belangrijk om de machtigingen regelmatig te controleren en onnodige machtigingen te verwijderen.

## 3. Cloud Scheduler

Cloud Scheduler is een geautomatiseerde cronjob-service die taken op een gepland tijdstip uitvoert. Het kan worden gebruikt om volharding te bereiken door een taak in te stellen die periodiek wordt uitgevoerd en toegang behoudt tot de GCP-resources.

### 3.1. Taakplanning

Door een taak in te stellen met behulp van Cloud Scheduler, kan een aanvaller periodiek toegang behouden tot de resources. Dit kan bijvoorbeeld worden gedaan door een HTTP-aanvraag te configureren naar een kwaadaardige server die de aanvaller controleert. Op deze manier kan de aanvaller toegang behouden tot de resources en eventuele wijzigingen in het systeem monitoren.

### 3.2. Toegangscontrole

Het is belangrijk om de toegangscontrole voor Cloud Scheduler strikt te beheren. Door de juiste machtigingen toe te kennen aan de taak, kan een aanvaller volharding bereiken. Het is belangrijk om de machtigingen regelmatig te controleren en onnodige machtigingen te verwijderen.

## 4. Cloud Pub/Sub

Cloud Pub/Sub is een berichtenservice die wordt gebruikt voor het verzenden en ontvangen van berichten tussen onafhankelijke applicaties. Het kan worden gebruikt om volharding te bereiken door een abonnement op te zetten dat periodiek berichten ontvangt en toegang behoudt tot de GCP-resources.

### 4.1. Abonnementen

Door een abonnement op te zetten met behulp van Cloud Pub/Sub, kan een aanvaller periodiek toegang behouden tot de resources. Dit kan bijvoorbeeld worden gedaan door een kwaadaardige applicatie te implementeren die berichten ontvangt en verwerkt. Op deze manier kan de aanvaller toegang behouden tot de resources en eventuele wijzigingen in het systeem monitoren.

### 4.2. Toegangscontrole

Het is belangrijk om de toegangscontrole voor Cloud Pub/Sub strikt te beheren. Door de juiste machtigingen toe te kennen aan het abonnement, kan een aanvaller volharding bereiken. Het is belangrijk om de machtigingen regelmatig te controleren en onnodige machtigingen te verwijderen.

## 5. Cloud Storage

Cloud Storage is een objectopslagservice die wordt gebruikt voor het opslaan en ophalen van gegevens. Het kan worden gebruikt om volharding te bereiken door kwaadaardige bestanden op te slaan en toegang te behouden tot de GCP-resources.

### 5.1. Bestanden opslaan

Door kwaadaardige bestanden op te slaan in Cloud Storage, kan een aanvaller toegang behouden tot de resources. Dit kan bijvoorbeeld worden gedaan door een kwaadaardig script op te slaan dat periodiek wordt uitgevoerd en toegang behoudt tot de resources.

### 5.2. Toegangscontrole

Het is belangrijk om de toegangscontrole voor Cloud Storage strikt te beheren. Door de juiste machtigingen toe te kennen aan de opgeslagen bestanden, kan een aanvaller volharding bereiken. Het is belangrijk om de machtigingen regelmatig te controleren en onnodige machtigingen te verwijderen.

## Conclusie

Volharding is een belangrijk aspect van het behouden van toegang tot een GCP-omgeving. Door gebruik te maken van verschillende technieken, zoals serviceaccounts, Cloud Functions, Cloud Scheduler, Cloud Pub/Sub en Cloud Storage, kan een aanvaller toegang behouden tot de resources en eventuele wijzigingen in het systeem monitoren. Het is belangrijk om de toegangscontrole strikt te beheren en regelmatig de machtigingen te controleren om ongeautoriseerde volharding te voorkomen.
