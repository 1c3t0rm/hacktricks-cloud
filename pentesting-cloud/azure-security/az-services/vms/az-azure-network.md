# Az - Azure Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

AzureëŠ” ì‚¬ìš©ìê°€ Azure í´ë¼ìš°ë“œ ë‚´ì—ì„œ **ê²©ë¦¬ëœ** **ë„¤íŠ¸ì›Œí¬**ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” **ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet)**ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ VNet ë‚´ì—ì„œ ê°€ìƒ ë¨¸ì‹ , ì• í”Œë¦¬ì¼€ì´ì…˜, ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì•ˆì „í•˜ê²Œ í˜¸ìŠ¤íŒ…í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Azureì˜ ë„¤íŠ¸ì›Œí‚¹ì€ í´ë¼ìš°ë“œ ë‚´ì˜ í†µì‹ (Azure ì„œë¹„ìŠ¤ ê°„)ê³¼ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ ë° ì¸í„°ë„·ê³¼ì˜ ì—°ê²°ì„ ì§€ì›í•©ë‹ˆë‹¤.\
ë˜í•œ, VNetì„ ë‹¤ë¥¸ VNet ë° ì˜¨í”„ë ˆë¯¸ìŠ¤ ë„¤íŠ¸ì›Œí¬ì™€ **ì—°ê²°**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Virtual Network (VNET) & Subnets

Azure ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet)ëŠ” í´ë¼ìš°ë“œì—ì„œ ìì‹ ì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ ë‚˜íƒ€ë‚´ë©°, êµ¬ë…ì— ì „ë…í•˜ëŠ” Azure í™˜ê²½ ë‚´ì—ì„œ **ë…¼ë¦¬ì  ê²©ë¦¬**ë¥¼ ì œê³µí•©ë‹ˆë‹¤. VNetì€ Azureì—ì„œ ê°€ìƒ ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬(VPN)ë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ë©°, ê°€ìƒ ë¨¸ì‹ (VM), ë°ì´í„°ë² ì´ìŠ¤ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ í˜¸ìŠ¤íŒ…í•©ë‹ˆë‹¤. ì´ë“¤ì€ IP ì£¼ì†Œ ë²”ìœ„, ì„œë¸Œë„· ìƒì„±, ë¼ìš°íŠ¸ í…Œì´ë¸” ë° ë„¤íŠ¸ì›Œí¬ ê²Œì´íŠ¸ì›¨ì´ë¥¼ í¬í•¨í•œ **ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì— ëŒ€í•œ ì™„ì „í•œ ì œì–´**ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**ì„œë¸Œë„·**ì€ íŠ¹ì • **IP ì£¼ì†Œ ë²”ìœ„**ë¡œ ì •ì˜ëœ VNet ë‚´ì˜ ì„¸ë¶„í™”ì…ë‹ˆë‹¤. VNetì„ ì—¬ëŸ¬ ì„œë¸Œë„·ìœ¼ë¡œ ë¶„í• í•¨ìœ¼ë¡œì¨ ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜ì— ë”°ë¼ ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°ì§í•˜ê³  ë³´í˜¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ê¸°ë³¸ì ìœ¼ë¡œ ë™ì¼í•œ Azure ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet) ë‚´ì˜ ëª¨ë“  ì„œë¸Œë„·ì€ **ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

**ì˜ˆì‹œ:**

* `MyVNet`ì˜ IP ì£¼ì†Œ ë²”ìœ„ëŠ” 10.0.0.0/16ì…ë‹ˆë‹¤.
* **ì„œë¸Œë„·-1:** ì›¹ ì„œë²„ìš© 10.0.0.0/24.
* **ì„œë¸Œë„·-2:** ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ìš© 10.0.1.0/24.

### Enumeration

Azure ê³„ì •ì˜ ëª¨ë“  VNet ë° ì„œë¸Œë„·ì„ ë‚˜ì—´í•˜ë ¤ë©´ Azure Command-Line Interface (CLI)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}"

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List VNets
Get-AzVirtualNetwork | Select-Object Name, Location, @{Name="AddressSpace"; Expression={$_.AddressSpace.AddressPrefixes}}

# List subnets of a VNet
Get-AzVirtualNetwork -ResourceGroupName <ResourceGroupName> -Name <VNetName> |
Select-Object -ExpandProperty Subnets |
Select-Object Name, AddressPrefix
```
{% endcode %}
{% endtab %}
{% endtabs %}

## ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ê·¸ë£¹ (NSG)

**ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ê·¸ë£¹ (NSG)**ëŠ” Azure ê°€ìƒ ë„¤íŠ¸ì›Œí¬ (VNet) ë‚´ì˜ Azure ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ í•„í„°ë§í•©ë‹ˆë‹¤. ì´ëŠ” **ì¸ë°”ìš´ë“œ ë° ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ìœ„í•´ ì—´ì–´ì•¼ í•  í¬íŠ¸ë¥¼** ì†ŒìŠ¤ í¬íŠ¸, ì†ŒìŠ¤ IP, í¬íŠ¸ ëª©ì ì§€ì— ë”°ë¼ ì§€ì •í•  ìˆ˜ ìˆëŠ” **ë³´ì•ˆ ê·œì¹™** ì„¸íŠ¸ë¥¼ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, ìš°ì„  ìˆœìœ„ë¥¼ í• ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ìš°ì„  ìˆœìœ„ ë²ˆí˜¸ê°€ ë‚®ì„ìˆ˜ë¡ ìš°ì„  ìˆœìœ„ê°€ ë†’ìŠµë‹ˆë‹¤).

NSGëŠ” **ì„œë¸Œë„· ë° NICì— ì—°ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

**ê·œì¹™ ì˜ˆì‹œ:**

* ëª¨ë“  ì†ŒìŠ¤ì—ì„œ ì›¹ ì„œë²„ë¡œì˜ HTTP íŠ¸ë˜í”½ (í¬íŠ¸ 80)ì„ í—ˆìš©í•˜ëŠ” ì¸ë°”ìš´ë“œ ê·œì¹™.
* íŠ¹ì • ëª©ì ì§€ IP ì£¼ì†Œ ë²”ìœ„ë¡œì˜ SQL íŠ¸ë˜í”½ (í¬íŠ¸ 1433)ë§Œ í—ˆìš©í•˜ëŠ” ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™.

### ì—´ê±°

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table
az network nsg show --name <nsg-name>

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table

# Get NICs and subnets using this NSG
az network nsg show --name MyLowCostVM-nsg --resource-group Resource_Group_1 --query "{subnets: subnets, networkInterfaces: networkInterfaces}"
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List NSGs
Get-AzNetworkSecurityGroup | Select-Object Name, Location
Get-AzNetworkSecurityGroup -Name <NSGName> -ResourceGroupName <ResourceGroupName>

# Get NSG rules
(Get-AzNetworkSecurityGroup -ResourceGroupName <NSGName> -Name <ResourceGroupName>).SecurityRules

# Get NICs and subnets using this NSG
(Get-AzNetworkSecurityGroup -Name <NSGName> -ResourceGroupName <ResourceGroupName>).Subnets
```
{% endcode %}
{% endtab %}
{% endtabs %}
## Azure Firewall

Azure FirewallëŠ” í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ íŠ¸ë˜í”½ì„ ê²€ì‚¬í•˜ê³  ì œì–´í•˜ëŠ” **ê´€ë¦¬í˜• ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì´ëŠ” **ìƒíƒœ ì €ì¥ ë°©í™”ë²½**ìœ¼ë¡œ, 3ê³„ì¸µì—ì„œ 7ê³„ì¸µê¹Œì§€ì˜ ê·œì¹™ì— ë”°ë¼ íŠ¸ë˜í”½ì„ í•„í„°ë§í•˜ë©°, **Azure ë‚´**(ë™ì„œ íŠ¸ë˜í”½) ë° **ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì™€ì˜ í†µì‹ **(ë‚¨ë¶ íŠ¸ë˜í”½)ì„ ì§€ì›í•©ë‹ˆë‹¤. **ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet) ìˆ˜ì¤€**ì— ë°°í¬ë˜ì–´ VNetì˜ ëª¨ë“  ì„œë¸Œë„·ì— ëŒ€í•œ ì¤‘ì•™ ì§‘ì¤‘ì‹ ë³´í˜¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. Azure Firewallì€ íŠ¸ë˜í”½ ìˆ˜ìš”ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ìë™ìœ¼ë¡œ í™•ì¥ë˜ë©°, ìˆ˜ë™ ì„¤ì • ì—†ì´ ë†’ì€ ê°€ìš©ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

ì„¸ ê°€ì§€ SKUâ€”**ê¸°ë³¸**, **í‘œì¤€**, **í”„ë¦¬ë¯¸ì—„**â€”ë¡œ ì œê³µë˜ë©°, ê°ê° íŠ¹ì • ê³ ê° ìš”êµ¬ì— ë§ì¶°ì ¸ ìˆìŠµë‹ˆë‹¤:

| **ì¶”ì²œ ì‚¬ìš© ì‚¬ë¡€**          | ì œí•œëœ ìš”êµ¬ê°€ ìˆëŠ” ì¤‘ì†Œê¸°ì—…(SMB)               | ì¼ë°˜ ê¸°ì—… ì‚¬ìš©, 3â€“7ê³„ì¸µ í•„í„°ë§           | ë§¤ìš° ë¯¼ê°í•œ í™˜ê²½(ì˜ˆ: ê²°ì œ ì²˜ë¦¬)                     |
| ---------------------------- | ---------------------------------------------- | ----------------------------------------- | --------------------------------------------------- |
| **ì„±ëŠ¥**                     | ìµœëŒ€ 250 Mbps ì²˜ë¦¬ëŸ‰                          | ìµœëŒ€ 30 Gbps ì²˜ë¦¬ëŸ‰                      | ìµœëŒ€ 100 Gbps ì²˜ë¦¬ëŸ‰                                |
| **ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤**         | ê²½ê³ ë§Œ ì œê³µ                                   | ê²½ê³  ë° ì°¨ë‹¨(ì•…ì„± IP/ë„ë©”ì¸)            | ê²½ê³  ë° ì°¨ë‹¨(ê³ ê¸‰ ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤)                  |
| **L3â€“L7 í•„í„°ë§**            | ê¸°ë³¸ í•„í„°ë§                                   | í”„ë¡œí† ì½œ ì „ë°˜ì— ê±¸ì¹œ ìƒíƒœ ì €ì¥ í•„í„°ë§   | ê³ ê¸‰ ê²€ì‚¬ë¥¼ í†µí•œ ìƒíƒœ ì €ì¥ í•„í„°ë§                   |
| **ê³ ê¸‰ ìœ„í˜‘ ë³´í˜¸**          | ì‚¬ìš© ë¶ˆê°€                                     | ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ í•„í„°ë§   | ì¹¨ì… íƒì§€ ë° ë°©ì§€ ì‹œìŠ¤í…œ(IDPS) í¬í•¨                 |
| **TLS ê²€ì‚¬**                | ì‚¬ìš© ë¶ˆê°€                                     | ì‚¬ìš© ë¶ˆê°€                                 | ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ TLS ì¢…ë£Œ ì§€ì›                   |
| **ê°€ìš©ì„±**                  | ê³ ì • ë°±ì—”ë“œ(2 VM)                             | ìë™ í™•ì¥                                 | ìë™ í™•ì¥                                           |
| **ê´€ë¦¬ ìš©ì´ì„±**              | ê¸°ë³¸ ì œì–´                                     | ë°©í™”ë²½ ê´€ë¦¬ìë¥¼ í†µí•´ ê´€ë¦¬                | ë°©í™”ë²½ ê´€ë¦¬ìë¥¼ í†µí•´ ê´€ë¦¬                           |

### Enumeration

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List Azure Firewalls
Get-AzFirewall

# Get network rules of a firewall
(Get-AzFirewall -Name <FirewallName> -ResourceGroupName <ResourceGroupName>).NetworkRuleCollections

# Get application rules of a firewall
(Get-AzFirewall -Name <FirewallName> -ResourceGroupName <ResourceGroupName>).ApplicationRuleCollections

# Get nat rules of a firewall
(Get-AzFirewall -Name <FirewallName> -ResourceGroupName <ResourceGroupName>).NatRuleCollections
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Azure Route Tables

Azure **Route Tables**ëŠ” ì„œë¸Œë„· ë‚´ì—ì„œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì˜ ë¼ìš°íŒ…ì„ ì œì–´í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ë“¤ì€ íŒ¨í‚·ì´ Azure ë¦¬ì†ŒìŠ¤, ì¸í„°ë„· ë˜ëŠ” Virtual Applianceë‚˜ Azure Firewallê³¼ ê°™ì€ íŠ¹ì • ë‹¤ìŒ í™‰ìœ¼ë¡œ ì–´ë–»ê²Œ ì „ë‹¬ë˜ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì§€ì •í•˜ëŠ” ê·œì¹™ì„ ì •ì˜í•©ë‹ˆë‹¤. ë¼ìš°íŠ¸ í…Œì´ë¸”ì„ **ì„œë¸Œë„·**ê³¼ ì—°ê²°í•  ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ ì„œë¸Œë„· ë‚´ì˜ ëª¨ë“  ë¦¬ì†ŒìŠ¤ëŠ” í…Œì´ë¸”ì˜ ê²½ë¡œë¥¼ ë”°ë¦…ë‹ˆë‹¤.

**ì˜ˆ:** ì„œë¸Œë„·ì´ ê²€ì‚¬ë¥¼ ìœ„í•´ Network Virtual Appliance (NVA)ë¥¼ í†µí•´ ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ë¼ìš°íŒ…í•´ì•¼ í•˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ í˜¸ìŠ¤íŒ…í•˜ëŠ” ê²½ìš°, ë¼ìš°íŠ¸ í…Œì´ë¸”ì— **ë¼ìš°íŠ¸**ë¥¼ ìƒì„±í•˜ì—¬ ëª¨ë“  íŠ¸ë˜í”½(ì˜ˆ: `0.0.0.0/0`)ì„ NVAì˜ ê°œì¸ IP ì£¼ì†Œë¡œ ë‹¤ìŒ í™‰ìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **Enumeration**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List routes for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List Route Tables
Get-AzRouteTable

# List routes for a table
(Get-AzRouteTable -Name <RouteTableName> -ResourceGroupName <ResourceGroupName>).Routes
```
{% endcode %}
{% endtab %}
{% endtabs %}
## Azure Private Link

Azure Private LinkëŠ” **Azure ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê°œì¸ ì•¡ì„¸ìŠ¤ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” Azureì˜ ì„œë¹„ìŠ¤**ë¡œ, **Azure ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet)ì™€ ì„œë¹„ìŠ¤ ê°„ì˜ íŠ¸ë˜í”½ì´ Microsoftì˜ Azure ë°±ë³¸ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ ì™„ì „íˆ ì´ë™í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤**. ì´ ì„¤ì •ì€ ì„œë¹„ìŠ¤ë¥¼ VNetìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ë°ì´í„°ê°€ ê³µìš© ì¸í„°ë„·ì— ë…¸ì¶œë˜ì§€ ì•Šì•„ ë³´ì•ˆì´ ê°•í™”ë©ë‹ˆë‹¤.

Private LinkëŠ” Azure Storage, Azure SQL Database ë° Private Linkë¥¼ í†µí•´ ê³µìœ ë˜ëŠ” ì‚¬ìš©ì ì§€ì • ì„œë¹„ìŠ¤ì™€ ê°™ì€ ë‹¤ì–‘í•œ Azure ì„œë¹„ìŠ¤ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ìì‹ ì˜ VNet ë‚´ì—ì„œ ë˜ëŠ” ë‹¤ë¥¸ Azure êµ¬ë…ì—ì„œ ì„œë¹„ìŠ¤ë¥¼ ì•ˆì „í•˜ê²Œ ì†Œë¹„í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.

{% hint style="danger" %}
NSGëŠ” ê°œì¸ ì—”ë“œí¬ì¸íŠ¸ì— ì ìš©ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ, Private Linkë¥¼ í¬í•¨í•˜ëŠ” ì„œë¸Œë„·ì— NSGë¥¼ ì—°ê²°í•˜ëŠ” ê²ƒì€ íš¨ê³¼ê°€ ì—†ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
{% endhint %}

**ì˜ˆì‹œ:**

**VNetì—ì„œ ì•ˆì „í•˜ê²Œ ì•¡ì„¸ìŠ¤í•˜ê³ ì í•˜ëŠ” Azure SQL Databaseê°€ ìˆëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ë ¤í•´ ë³´ì‹­ì‹œì˜¤**. ì¼ë°˜ì ìœ¼ë¡œ ì´ëŠ” ê³µìš© ì¸í„°ë„·ì„ í†µí•´ ì´ë™í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Private Linkë¥¼ ì‚¬ìš©í•˜ë©´ **VNet ë‚´ì— Azure SQL Database ì„œë¹„ìŠ¤ì— ì§ì ‘ ì—°ê²°ë˜ëŠ” ê°œì¸ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” ë°ì´í„°ë² ì´ìŠ¤ê°€ ìì‹ ì˜ VNetì˜ ì¼ë¶€ì¸ ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•˜ë©°, ê°œì¸ IP ì£¼ì†Œë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ì•ˆì „í•˜ê³  ê°œì¸ì ì¸ ì•¡ì„¸ìŠ¤ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

### **Enumeration**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List Private Link Services
az network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List Private Link Services
Get-AzPrivateLinkService | Select-Object Name, Location, ResourceGroupName

# List Private Endpoints
Get-AzPrivateEndpoint | Select-Object Name, Location, ResourceGroupName, PrivateEndpointConnections
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Azure ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸

Azure ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ëŠ” ê°€ìƒ ë„¤íŠ¸ì›Œí¬ì˜ ê°œì¸ ì£¼ì†Œ ê³µê°„ê³¼ VNetì˜ IDë¥¼ Azure ì„œë¹„ìŠ¤ì— ì§ì ‘ ì—°ê²°í•˜ì—¬ í™•ì¥í•©ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í™œì„±í™”í•˜ë©´, **VNetì˜ ë¦¬ì†ŒìŠ¤ê°€ Azureì˜ ë°±ë³¸ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ Azure ì„œë¹„ìŠ¤**ì— ì•ˆì „í•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” **VNetì—ì„œ Azure ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì´ Azure ë„¤íŠ¸ì›Œí¬ ë‚´ì— ìœ ì§€ë˜ë„ë¡ í•˜ì—¬**, ë³´ë‹¤ ì•ˆì „í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**

ì˜ˆë¥¼ ë“¤ì–´, **Azure Storage** ê³„ì •ì€ ê¸°ë³¸ì ìœ¼ë¡œ ê³µìš© ì¸í„°ë„·ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **VNet ë‚´ì—ì„œ Azure Storageì— ëŒ€í•œ ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í™œì„±í™”í•˜ë©´**, VNetì˜ íŠ¸ë˜í”½ë§Œì´ ìŠ¤í† ë¦¬ì§€ ê³„ì •ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ìŠ¤í† ë¦¬ì§€ ê³„ì • ë°©í™”ë²½ì„ êµ¬ì„±í•˜ì—¬ VNetì—ì„œë§Œ íŠ¸ë˜í”½ì„ ìˆ˜ë½í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **ì—´ê±°**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List Virtual Networks with Service Endpoints
Get-AzVirtualNetwork

# List Subnets with Service Endpoints
(Get-AzVirtualNetwork -ResourceGroupName <ResourceGroupName> -Name <VNetName>).Subnets
```
{% endcode %}
{% endtab %}
{% endtabs %}

### ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ì™€ í”„ë¼ì´ë¹— ë§í¬ì˜ ì°¨ì´

MicrosoftëŠ” [**ë¬¸ì„œ**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints)ì—ì„œ í”„ë¼ì´ë¹— ë§í¬ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤:

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸:**

* VNetì—ì„œ Azure ì„œë¹„ìŠ¤ë¡œì˜ íŠ¸ë˜í”½ì€ Microsoft Azure ë°±ë³¸ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì´ë™í•˜ë©°, ê³µìš© ì¸í„°ë„·ì„ ìš°íšŒí•©ë‹ˆë‹¤.
* ì—”ë“œí¬ì¸íŠ¸ëŠ” Azure ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì§ì ‘ ì—°ê²°ì´ë©°, VNet ë‚´ì—ì„œ ì„œë¹„ìŠ¤ì— ëŒ€í•œ í”„ë¼ì´ë¹— IPë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* ì„œë¹„ìŠ¤ ìì²´ëŠ” VNet ì™¸ë¶€ì—ì„œ ê³µìš© ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì—¬ì „íˆ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì„œë¹„ìŠ¤ ë°©í™”ë²½ì„ êµ¬ì„±í•˜ì—¬ ì´ëŸ¬í•œ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ì§€ ì•ŠëŠ” í•œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
* ì„œë¸Œë„·ê³¼ Azure ì„œë¹„ìŠ¤ ê°„ì˜ ì¼ëŒ€ì¼ ê´€ê³„ì…ë‹ˆë‹¤.
* í”„ë¼ì´ë¹— ë§í¬ë³´ë‹¤ ë¹„ìš©ì´ ì €ë ´í•©ë‹ˆë‹¤.

**í”„ë¼ì´ë¹— ë§í¬:**

* í”„ë¼ì´ë¹— ë§í¬ëŠ” Azure ì„œë¹„ìŠ¤ë¥¼ VNet ë‚´ì˜ í”„ë¼ì´ë¹— ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ë§¤í•‘í•˜ë©°, ì´ëŠ” VNet ë‚´ì˜ í”„ë¼ì´ë¹— IP ì£¼ì†Œë¥¼ ê°€ì§„ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.
* Azure ì„œë¹„ìŠ¤ëŠ” ì´ í”„ë¼ì´ë¹— IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼ë˜ë©°, ë§ˆì¹˜ ë„¤íŠ¸ì›Œí¬ì˜ ì¼ë¶€ì¸ ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.
* í”„ë¼ì´ë¹— ë§í¬ë¥¼ í†µí•´ ì—°ê²°ëœ ì„œë¹„ìŠ¤ëŠ” VNet ë˜ëŠ” ì—°ê²°ëœ ë„¤íŠ¸ì›Œí¬ì—ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê³µìš© ì¸í„°ë„· ì ‘ê·¼ì€ ì—†ìŠµë‹ˆë‹¤.
* Azure ì„œë¹„ìŠ¤ ë˜ëŠ” Azureì— í˜¸ìŠ¤íŒ…ëœ ìì²´ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì•ˆì „í•œ ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ê³µìœ í•˜ëŠ” ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì—°ê²°ë„ ì œê³µí•©ë‹ˆë‹¤.
* ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ì™€ ë‹¬ë¦¬ VNet ë‚´ì˜ í”„ë¼ì´ë¹— ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ë” ì„¸ë¶„í™”ëœ ì ‘ê·¼ ì œì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ìš”ì•½í•˜ìë©´, ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ì™€ í”„ë¼ì´ë¹— ë§í¬ ëª¨ë‘ Azure ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì•ˆì „í•œ ì—°ê²°ì„ ì œê³µí•˜ì§€ë§Œ, **í”„ë¼ì´ë¹— ë§í¬ëŠ” ì„œë¹„ìŠ¤ë¥¼ ê³µìš© ì¸í„°ë„·ì— ë…¸ì¶œí•˜ì§€ ì•Šê³  í”„ë¼ì´ë¹—í•˜ê²Œ ì ‘ê·¼í•˜ë„ë¡ ë³´ì¥í•¨ìœ¼ë¡œì¨ ë” ë†’ì€ ìˆ˜ì¤€ì˜ ê²©ë¦¬ì™€ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤**. ë°˜ë©´ ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ëŠ” VNet ë‚´ì—ì„œ í”„ë¼ì´ë¹— IPê°€ í•„ìš” ì—†ëŠ” ì¼ë°˜ì ì¸ ê²½ìš°ì— Azure ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê°„ë‹¨í•˜ê³  ì•ˆì „í•œ ì ‘ê·¼ì„ ì„¤ì •í•˜ê¸°ê°€ ë” ì‰½ìŠµë‹ˆë‹¤.

## Azure Front Door (AFD) ë° AFD WAF

**Azure Front Door**ëŠ” **ê¸€ë¡œë²Œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¹ ë¥¸ ë°°í¬**ë¥¼ ìœ„í•œ í™•ì¥ ê°€ëŠ¥í•˜ê³  ì•ˆì „í•œ ì§„ì…ì ì…ë‹ˆë‹¤. ì´ëŠ” **ê¸€ë¡œë²Œ ë¡œë“œ ë°¸ëŸ°ì‹±, ì‚¬ì´íŠ¸ ê°€ì†í™”, SSL ì˜¤í”„ë¡œë“œ ë° ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©í™”ë²½(WAF)** ê¸°ëŠ¥ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ì„œë¹„ìŠ¤ë¡œ **ê²°í•©**í•©ë‹ˆë‹¤. Azure Front DoorëŠ” **ì‚¬ìš©ìì—ê²Œ ê°€ì¥ ê°€ê¹Œìš´ ì—£ì§€ ìœ„ì¹˜**ì— ê¸°ë°˜í•œ ì§€ëŠ¥í˜• ë¼ìš°íŒ…ì„ ì œê³µí•˜ì—¬ ìµœì ì˜ ì„±ëŠ¥ê³¼ ì‹ ë¢°ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤. ë˜í•œ URL ê¸°ë°˜ ë¼ìš°íŒ…, ë‹¤ì¤‘ ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ…, ì„¸ì…˜ ì¹œí™”ì„± ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤.

**Azure Front Door WAF**ëŠ” **ì›¹ ê¸°ë°˜ ê³µê²©ìœ¼ë¡œë¶€í„° ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³´í˜¸**í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, ë°±ì—”ë“œ ì½”ë“œë¥¼ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. SQL ì¸ì ì…˜, í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ë° ê¸°íƒ€ ì¼ë°˜ì ì¸ ê³µê²©ê³¼ ê°™ì€ ìœ„í˜‘ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©ì ì •ì˜ ê·œì¹™ ë° ê´€ë¦¬ ê·œì¹™ ì„¸íŠ¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**

ì „ ì„¸ê³„ì— ì‚¬ìš©ìë“¤ì´ ìˆëŠ” ê¸€ë¡œë²Œ ë¶„ì‚° ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ì‹­ì‹œì˜¤. Azure Front Doorë¥¼ ì‚¬ìš©í•˜ì—¬ **ì‚¬ìš©ì ìš”ì²­ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í˜¸ìŠ¤íŒ…í•˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì§€ì—­ ë°ì´í„° ì„¼í„°ë¡œ ë¼ìš°íŒ…**í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ì§€ì—° ì‹œê°„ì„ ì¤„ì´ê³  ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ë©° **WAF ê¸°ëŠ¥ìœ¼ë¡œ ì›¹ ê³µê²©ìœ¼ë¡œë¶€í„° ë°©ì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. íŠ¹ì • ì§€ì—­ì—ì„œ ë‹¤ìš´íƒ€ì„ì´ ë°œìƒí•˜ë©´ Azure Front DoorëŠ” ìë™ìœ¼ë¡œ íŠ¸ë˜í”½ì„ ë‹¤ìŒ ìµœì ì˜ ìœ„ì¹˜ë¡œ ì¬ë¼ìš°íŒ…í•˜ì—¬ ë†’ì€ ê°€ìš©ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

### ì—´ê±°

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List Azure Front Door Instances
Get-AzFrontDoor

# List Front Door WAF Policies
Get-AzFrontDoorWafPolicy -Name <policyName> -ResourceGroupName <resourceGroupName>
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Azure Application Gateway ë° Azure Application Gateway WAF

Azure Application GatewayëŠ” **ì›¹ íŠ¸ë˜í”½ ë¡œë“œ ë°¸ëŸ°ì„œ**ë¡œ, **ì›¹** ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ íŠ¸ë˜í”½ì„ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ì´ëŠ” **ë ˆì´ì–´ 7 ë¡œë“œ ë°¸ëŸ°ì‹±, SSL ì¢…ë£Œ ë° ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©í™”ë²½(WAF) ê¸°ëŠ¥**ì„ ì„œë¹„ìŠ¤ë¡œ ì œê³µí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°ë‹¬ ì»¨íŠ¸ë¡¤ëŸ¬(ADC)ì…ë‹ˆë‹¤. ì£¼ìš” ê¸°ëŠ¥ìœ¼ë¡œëŠ” URL ê¸°ë°˜ ë¼ìš°íŒ…, ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ì¹œí™”ì„± ë° ë³´ì•ˆ ì†Œì¼“ ê³„ì¸µ(SSL) ì˜¤í”„ë¡œë“œê°€ ìˆìœ¼ë©°, ì´ëŠ” ê¸€ë¡œë²Œ ë¼ìš°íŒ… ë° ê²½ë¡œ ê¸°ë°˜ ë¼ìš°íŒ…ê³¼ ê°™ì€ ë³µì¡í•œ ë¡œë“œ ë°¸ëŸ°ì‹± ê¸°ëŠ¥ì´ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¤‘ìš”í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**

ì‚¬ìš©ì ê³„ì • ë° ê²°ì œ ì²˜ë¦¬ì™€ ê°™ì€ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ìœ„í•œ ì—¬ëŸ¬ í•˜ìœ„ ë„ë©”ì¸ì„ í¬í•¨í•˜ëŠ” ì „ì ìƒê±°ë˜ ì›¹ì‚¬ì´íŠ¸ê°€ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ì‹­ì‹œì˜¤. Azure Application GatewayëŠ” **URL ê²½ë¡œì— ë”°ë¼ ì ì ˆí•œ ì›¹ ì„œë²„ë¡œ íŠ¸ë˜í”½ì„ ë¼ìš°íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì˜ˆë¥¼ ë“¤ì–´, `example.com/accounts`ë¡œì˜ íŠ¸ë˜í”½ì€ ì‚¬ìš©ì ê³„ì • ì„œë¹„ìŠ¤ë¡œ, `example.com/pay`ë¡œì˜ íŠ¸ë˜í”½ì€ ê²°ì œ ì²˜ë¦¬ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ…ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ê·¸ë¦¬ê³  **WAF ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì›¹ì‚¬ì´íŠ¸ë¥¼ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•©ë‹ˆë‹¤.**

### **ì—´ê±°**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List the Web Application Firewall configurations for your Application Gateways
(Get-AzApplicationGateway -Name <AppGatewayName> -ResourceGroupName <ResourceGroupName>).WebApplicationFirewallConfiguration
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Azure í—ˆë¸Œ, ìŠ¤í¬í¬ ë° VNet í”¼ì–´ë§

**VNet í”¼ì–´ë§**ì€ Azureì˜ ë„¤íŠ¸ì›Œí‚¹ ê¸°ëŠ¥ìœ¼ë¡œ **ì„œë¡œ ë‹¤ë¥¸ ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet)ë¥¼ ì§ì ‘ì ì´ê³  ì›í™œí•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤**. VNet í”¼ì–´ë§ì„ í†µí•´ í•œ VNetì˜ ë¦¬ì†ŒìŠ¤ëŠ” **ë§ˆì¹˜ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê²ƒì²˜ëŸ¼** ë‹¤ë¥¸ VNetì˜ ë¦¬ì†ŒìŠ¤ì™€ ê°œì¸ IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ í†µì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**VNet í”¼ì–´ë§ì€ ì˜¨í”„ë ˆë¯¸ìŠ¤ ë„¤íŠ¸ì›Œí¬ì™€ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì‚¬ì´íŠ¸ ê°„ VPN ë˜ëŠ” Azure ExpressRouteë¥¼ ì„¤ì •í•˜ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.

**Azure í—ˆë¸Œì™€ ìŠ¤í¬í¬**ëŠ” Azureì—ì„œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ ê´€ë¦¬í•˜ê³  ì¡°ì§í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ì…ë‹ˆë‹¤. **"í—ˆë¸Œ"ëŠ” ì„œë¡œ ë‹¤ë¥¸ "ìŠ¤í¬í¬" ê°„ì˜ íŠ¸ë˜í”½ì„ ì œì–´í•˜ê³  ë¼ìš°íŒ…í•˜ëŠ” ì¤‘ì•™ ì§€ì ì…ë‹ˆë‹¤**. í—ˆë¸ŒëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ê°€ìƒ ì¥ì¹˜(NVA), Azure VPN ê²Œì´íŠ¸ì›¨ì´, Azure ë°©í™”ë²½ ë˜ëŠ” Azure Bastionê³¼ ê°™ì€ ê³µìœ  ì„œë¹„ìŠ¤ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. **"ìŠ¤í¬í¬"ëŠ” ì›Œí¬ë¡œë“œë¥¼ í˜¸ìŠ¤íŒ…í•˜ê³  VNet í”¼ì–´ë§ì„ ì‚¬ìš©í•˜ì—¬ í—ˆë¸Œì— ì—°ê²°ë˜ëŠ” VNetì…ë‹ˆë‹¤**, ì´ë¥¼ í†µí•´ í—ˆë¸Œ ë‚´ì˜ ê³µìœ  ì„œë¹„ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª¨ë¸ì€ ì—¬ëŸ¬ VNetì— ê±¸ì³ ìˆëŠ” ì—¬ëŸ¬ ì›Œí¬ë¡œë“œê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê³µí†µ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ì—¬ ë³µì¡ì„±ì„ ì¤„ì´ê³  ê¹”ë”í•œ ë„¤íŠ¸ì›Œí¬ ë ˆì´ì•„ì›ƒì„ ì´‰ì§„í•©ë‹ˆë‹¤.

{% hint style="danger" %}
**Azureì—ì„œ VNET í”¼ì–´ë§ì€ ë¹„ì „ì´ì „ì ì…ë‹ˆë‹¤**, ì¦‰ ìŠ¤í¬í¬ 1ì´ ìŠ¤í¬í¬ 2ì— ì—°ê²°ë˜ê³  ìŠ¤í¬í¬ 2ê°€ ìŠ¤í¬í¬ 3ì— ì—°ê²°ë˜ì–´ë„ ìŠ¤í¬í¬ 1ì€ ìŠ¤í¬í¬ 3ê³¼ ì§ì ‘ í†µì‹ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
{% endhint %}

**ì˜ˆì‹œ:**

íŒë§¤, ì¸ì‚¬ ë° ê°œë°œê³¼ ê°™ì€ ë³„ë„ì˜ ë¶€ì„œë¥¼ ê°€ì§„ íšŒì‚¬ë¥¼ ìƒìƒí•´ ë³´ì‹­ì‹œì˜¤. **ê° ë¶€ì„œëŠ” ìì²´ VNet(ìŠ¤í¬í¬)ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤**. ì´ëŸ¬í•œ VNetì€ **ì¤‘ì•™ ë°ì´í„°ë² ì´ìŠ¤, ë°©í™”ë²½ ë° ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ì™€ ê°™ì€ ê³µìœ  ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤**, ì´ ëª¨ë“  ê²ƒì€ **ë‹¤ë¥¸ VNet(í—ˆë¸Œ)ì— ìœ„ì¹˜í•´ ìˆìŠµë‹ˆë‹¤**. í—ˆë¸Œì™€ ìŠ¤í¬í¬ ëª¨ë¸ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ê° ë¶€ì„œëŠ” **ê³µìœ  ë¦¬ì†ŒìŠ¤ë¥¼ í—ˆë¸Œ VNetì„ í†µí•´ ì•ˆì „í•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŸ¬í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìš© ì¸í„°ë„·ì— ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê±°ë‚˜ ìˆ˜ë§ì€ ì—°ê²°ë¡œ ë³µì¡í•œ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°ë¥¼ ë§Œë“¤ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤**.

### ì—´ê±°

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List all VNets in your subscription
Get-AzVirtualNetwork

# List VNet peering connections for a given VNet
(Get-AzVirtualNetwork -ResourceGroupName <ResourceGroupName> -Name <VNetName>).VirtualNetworkPeerings

# List Shared Resources (e.g., Azure Firewall) in the Hub
Get-AzFirewall
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Site-to-Site VPN

Azureì˜ Site-to-Site VPNì€ **ì˜¨í”„ë ˆë¯¸ìŠ¤ ë„¤íŠ¸ì›Œí¬ë¥¼ Azure ê°€ìƒ ë„¤íŠ¸ì›Œí¬(VNet)ì— ì—°ê²°**í•  ìˆ˜ ìˆê²Œ í•´ì£¼ë©°, Azure ë‚´ì˜ VMê³¼ ê°™ì€ ë¦¬ì†ŒìŠ¤ê°€ ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•©ë‹ˆë‹¤. ì´ ì—°ê²°ì€ **ë‘ ë„¤íŠ¸ì›Œí¬ ê°„ì˜ íŠ¸ë˜í”½ì„ ì•”í˜¸í™”í•˜ëŠ” VPN ê²Œì´íŠ¸ì›¨ì´ë¥¼ í†µí•´ ì„¤ì •ë©ë‹ˆë‹¤.**

**ì˜ˆì‹œ:**

ë‰´ìš•ì— ë³¸ì‚¬ê°€ ìˆëŠ” í•œ ê¸°ì—…ì€ Azureì—ì„œ ê°€ìƒí™”ëœ ì›Œí¬ë¡œë“œë¥¼ í˜¸ìŠ¤íŒ…í•˜ëŠ” VNetì— ì•ˆì „í•˜ê²Œ ì—°ê²°í•´ì•¼ í•˜ëŠ” ì˜¨í”„ë ˆë¯¸ìŠ¤ ë°ì´í„° ì„¼í„°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. **Site-to-Site VPNì„ ì„¤ì •í•¨ìœ¼ë¡œì¨, íšŒì‚¬ëŠ” ì˜¨í”„ë ˆë¯¸ìŠ¤ ì„œë²„ì™€ Azure VM ê°„ì˜ ì•”í˜¸í™”ëœ ì—°ê²°ì„ ë³´ì¥í•  ìˆ˜ ìˆìœ¼ë©°**, ë‘ í™˜ê²½ ëª¨ë‘ì—ì„œ ë¦¬ì†ŒìŠ¤ì— ì•ˆì „í•˜ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ë§ˆì¹˜ ë™ì¼í•œ ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ ë§Œë“­ë‹ˆë‹¤.

### **Enumeration**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List VPN Gateways
Get-AzVirtualNetworkGateway -ResourceGroupName <ResourceGroupName>

# List VPN Connections
Get-AzVirtualNetworkGatewayConnection -ResourceGroupName <ResourceGroupName>
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Azure ExpressRoute

Azure ExpressRouteëŠ” **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì¸í”„ë¼ì™€ Azure ë°ì´í„° ì„¼í„° ê°„ì˜ ê°œì¸ì ì´ê³  ì „ìš©ì˜ ê³ ì† ì—°ê²°ì„ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì´ ì—°ê²°ì€ ì—°ê²° ì œê³µìë¥¼ í†µí•´ ì´ë£¨ì–´ì§€ë©°, ê³µìš© ì¸í„°ë„·ì„ ìš°íšŒí•˜ì—¬ ì¼ë°˜ ì¸í„°ë„· ì—°ê²°ë³´ë‹¤ ë” ë†’ì€ ì‹ ë¢°ì„±, ë” ë¹ ë¥¸ ì†ë„, ë” ë‚®ì€ ëŒ€ê¸° ì‹œê°„ ë° ë” ë†’ì€ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**

ë‹¤êµ­ì  ê¸°ì—…ì€ **ë°ì´í„°ì˜ ë†’ì€ ì–‘ê³¼ ë†’ì€ ì²˜ë¦¬ëŸ‰ì˜ í•„ìš”ì„±ìœ¼ë¡œ ì¸í•´ Azure ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì¼ê´€ë˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì—°ê²°**ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ íšŒì‚¬ëŠ” Azure ExpressRouteë¥¼ ì„ íƒí•˜ì—¬ ì˜¨í”„ë ˆë¯¸ìŠ¤ ë°ì´í„° ì„¼í„°ë¥¼ Azureì— ì§ì ‘ ì—°ê²°í•˜ì—¬, ì¼ì¼ ë°±ì—… ë° ì‹¤ì‹œê°„ ë°ì´í„° ë¶„ì„ê³¼ ê°™ì€ ëŒ€ê·œëª¨ ë°ì´í„° ì „ì†¡ì„ í–¥ìƒëœ ê°œì¸ ì •ë³´ ë³´í˜¸ ë° ì†ë„ë¡œ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.

### **Enumeration**

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}
{% endtab %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List ExpressRoute Circuits
Get-AzExpressRouteCircuit
```
{% endcode %}
{% endtab %}
{% endtabs %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
