# Az - Unauthenticated Enum & Initial Entry

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Azure Tenant

### Tenant Enumeration

There are some **public Azure APIs** that just knowing the **domain of the tenant** an attacker could query to gather more info about it.\
You can query directly the API or use the PowerShell library [**AADInternals**](https://github.com/Gerenios/AADInternals)**:**

| API                                                                  | Information                                                                                                                                                                                                                                           | AADInternals function                             |
| -------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| login.microsoftonline.com/\<domain>/.well-known/openid-configuration | **Login information**, including tenant ID                                                                                                                                                                                                            | `Get-AADIntTenantID -Domain <domain>`             |
| autodiscover-s.outlook.com/autodiscover/autodiscover.svc             | **All domains** of the tenant                                                                                                                                                                                                                         | `Get-AADIntTenantDomains -Domain <domain>`        |
| login.microsoftonline.com/GetUserRealm.srf?login=\<UserName>         | <p><strong>Login information</strong> of the tenant, including tenant Name and domain <strong>authentication type.</strong><br>If <code>NameSpaceType</code> is <strong><code>Managed</code></strong>, it means <strong>AzureAD</strong> is used.</p> | `Get-AADIntLoginInformation -UserName <UserName>` |
| login.microsoftonline.com/common/GetCredentialType                   | Login information, including **Desktop SSO information**                                                                                                                                                                                              | `Get-AADIntLoginInformation -UserName <UserName>` |

You can query all the information of an Azure tenant with **just one command of the** [**AADInternals**](https://github.com/Gerenios/AADInternals) **library**:
```powershell
Invoke-AADIntReconAsOutsider -DomainName corp.onmicrosoft.com | Format-Table
```
**Azure Tenant Info**

The following information can be obtained from an Azure tenant:

- **Tenant ID**: The unique identifier for the Azure tenant.
- **Tenant Name**: The name of the Azure tenant.
- **Tenant Domain**: The domain associated with the Azure tenant.
- **Tenant Location**: The geographic location of the Azure tenant.
- **Tenant Subscription**: The subscription details of the Azure tenant.

To retrieve this information, you can use the following methods:

1. **Azure Portal**: Log in to the Azure Portal and navigate to the Azure Active Directory section. The tenant information can be found under the Properties tab.

2. **Azure CLI**: Use the `az account show` command to display the tenant information.

3. **Azure PowerShell**: Use the `Get-AzTenant` cmdlet to retrieve the tenant information.

4. **Azure REST API**: Make a GET request to the `/tenants` endpoint to obtain the tenant information.

It is important to gather this information during the reconnaissance phase of a penetration test, as it can provide valuable insights into the target Azure environment.
```
Tenant brand:       Company Ltd
Tenant name:        company
Tenant id:          1937e3ab-38de-a735-a830-3075ea7e5b39
DesktopSSO enabled: True

Name                           DNS   MX    SPF  Type      STS
----                           ---   --    ---  ----      ---
company.com                   True  True  True  Federated sts.company.com
company.mail.onmicrosoft.com  True  True  True  Managed
company.onmicrosoft.com       True  True  True  Managed
int.company.com              False False False  Managed
```
**Qapla'!** 
**Qa'vIn** je **tenant** nev, ID je, je 'oH **"brand"** nev. **Seamless SSO** (https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso) **Desktop Single Sign-On (SSO)**, **status** jatlh. **enabled** DaH **feature** 'e' vItlhutlh **user** **enumeration** **target organization** vItlhutlh.

**Output** vItlhutlh **verified domains** neH **target tenant** 'ej **identity types**. **Federated domains** vItlhutlh, **Fully Qualified Domain Name (FQDN)** **identity provider** vItlhutlh, **typically ADFS server**. **MX** **column** **emails** **Exchange Online** **routed**, **SPF** **column** **Exchange Online** **email sender** **listing**. **Important** **note** **reconnaissance function** **parse** **"include" statements** **SPF records**, **false negatives** **result**.

### **User Enumeration**

**username** **exists** **check** **possible** **tenant** **inside**. **guest users** **include** **username** **format**:
```
<email>#EXT#@<tenant name>.onmicrosoft.com
```
**email** jupwI' 'e' chel 'e' vItlhutlh 'e' 'e' vItlhutlh " \_ ".

[**AADInternals**](https://github.com/Gerenios/AADInternals) jatlhpu'vam, user vItlhutlh vaj vItlhutlh 'e' vItlhutlh:
```powershell
# Check does the user exist
Invoke-AADIntUserEnumerationAsOutsider -UserName "user@company.com"
```
# az-unauthenticated-enum-and-initial-entry

## Description

This section covers techniques for enumerating and gaining initial access to an Azure cloud environment without authentication.

## Table of Contents

- [Introduction](#introduction)
- [Enumeration Techniques](#enumeration-techniques)
  - [Azure Resource Manager (ARM) API](#azure-resource-manager-arm-api)
  - [Azure Active Directory (AAD) Graph API](#azure-active-directory-aad-graph-api)
  - [Azure Storage Account](#azure-storage-account)
  - [Azure Key Vault](#azure-key-vault)
  - [Azure Container Registry](#azure-container-registry)
  - [Azure Logic Apps](#azure-logic-apps)
  - [Azure Functions](#azure-functions)
  - [Azure App Service](#azure-app-service)
  - [Azure Virtual Machines](#azure-virtual-machines)
  - [Azure SQL Database](#azure-sql-database)
  - [Azure Cosmos DB](#azure-cosmos-db)
  - [Azure Cognitive Services](#azure-cognitive-services)
  - [Azure Service Bus](#azure-service-bus)
  - [Azure Event Grid](#azure-event-grid)
  - [Azure Event Hubs](#azure-event-hubs)
  - [Azure Event Grid Domains](#azure-event-grid-domains)
  - [Azure Event Grid Subscriptions](#azure-event-grid-subscriptions)
  - [Azure Event Grid Topics](#azure-event-grid-topics)
  - [Azure Event Grid Event Subscriptions](#azure-event-grid-event-subscriptions)
  - [Azure Event Grid System Topics](#azure-event-grid-system-topics)
  - [Azure Event Grid Partner Topics](#azure-event-grid-partner-topics)
  - [Azure Event Grid Partner Namespaces](#azure-event-grid-partner-namespaces)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid Partner Registrations](#azure-event-grid-partner-registrations)
  - [Azure Event Grid
```
UserName         Exists
--------         ------
user@company.com True
```
**ghItlhvam**:
vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email patlh vItlhutlh. vaj email pat
```
user@company.com
user2@company.com
admin@company.com
admin2@company.com
external.user_gmail.com#EXT#@company.onmicrosoft.com
external.user_outlook.com#EXT#@company.onmicrosoft.com
```

```powershell
# Invoke user enumeration
Get-Content .\users.txt | Invoke-AADIntUserEnumerationAsOutsider -Method Normal
```
There are **three different enumeration methods** to choose from:

| Method    | Description                                                                                                                                                                                             |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Normal    | This refers to the GetCredentialType API mentioned above. The default method.                                                                                                                           |
| Login     | <p>This method tries to log in as the user.<br><strong>Note:</strong> queries will be logged to sign-ins log.</p>                                                                                       |
| Autologon | <p>This method tries to log in as the user via autologon endpoint.<br><strong>Queries are not logged</strong> to sign-ins log! As such, works well also for password spray and brute-force attacks.</p> |

After discovering the valid usernames you can get **info about a user** with:
```powershell
Get-AADIntLoginInformation -UserName root@corp.onmicrosoft.com
```
The script [**o365creeper**](https://github.com/LMGsec/o365creeper) also allows you to discover **if an email is valid**.

**tlh**
[**o365creeper**](https://github.com/LMGsec/o365creeper) script vItlhutlh **email valid** Qap.
```powershell
# Put in emails.txt emails such as:
# - root@corp.onmicrosoft.com
python.exe .\o365creeper\o365creeper.py -f .\emails.txt -o validemails.txt
```
## Azure Services

**Qa'vIn Azure tenant** **domains** **jatlh** **jatlh** **Azure services exposed** **qar'a'**.

[**MicroBurst**](https://github.com/NetSPI/MicroBurst) **ghItlh** **method** **vaj** **ghItlh**. **vaj** **function** **base domain name** **(permutations** **few)** **azure service domains** **search** **'e'**.
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1 -Verbose
Invoke-EnumerateAzureSubDomains -Base corp -Verbose
```
## Qap Storage

Qap storage vItlhutlh [**InvokeEnumerateAzureBlobs.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Invoke-EnumerateAzureBlobs.ps1) tool vItlhutlh **`Microburst/Misc/permitations.txt`** file vItlhutlh **qap storage accounts** vItlhutlh **ghItlh storage accounts** vItlhutlh.
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1
Invoke-EnumerateAzureBlobs -Base corp
[...]
https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
[...]

# Access https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
# Check: <Name>ssh_info.json</Name>
# Access then https://corpcommon.blob.core.windows.net/secrets/ssh_info.json
```
### SAS URLs

**_Shared access signature_** (SAS) URL jImej **ghItlh** 'ej **qaybtaHvIS** (Storage account) (container, file...) **ghap** (read, write...) **ghap**. vaj le' 'e' vItlhutlh (container 'e' vItlhutlh vaj 'e' vItlhutlh URL path) 'e' vItlhutlh:

`https://<storage_account_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`

[**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/) vIleghlaHbe' 'ej vItlhutlh

## Compromise Credentials

### Phishing

* [**Common Phishing**](https://book.hacktricks.xyz/generic-methodologies-and-resources/phishing-methodology) (credentials or OAuth App -[Illicit Consent Grant Attack](az-illicit-consent-grant.md)-)
* [**Device Code Authentication** Phishing](az-device-code-authentication-phishing.md)

### Password Spraying / Brute-Force

{% content-ref url="az-password-spraying.md" %}
[az-password-spraying.md](az-password-spraying.md)
{% endcontent-ref %}

## References

* [https://aadinternals.com/post/just-looking/](https://aadinternals.com/post/just-looking/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
