# Serverless.com рд╕реБрд░рдХреНрд╖рд╛

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

## рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА

### рд╕рдВрдЧрдарди

рдПрдХ **рд╕рдВрдЧрдарди** Serverless Framework рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдХреЗ рднреАрддрд░ рдЙрдЪреНрдЪрддрдо рд╕реНрддрд░ рдХреА рдЗрдХрд╛рдИ рд╣реИред рдпрд╣ рдПрдХ **рд╕рд╛рдореВрд╣рд┐рдХ рд╕рдореВрд╣** рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдХрдВрдкрдиреА, рд╡рд┐рднрд╛рдЧ, рдпрд╛ рдХреЛрдИ рднреА рдмрдбрд╝рд╛ рд╕рдВрдЧрдарди, рдЬреЛ рдХрдИ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ, рдЯреАрдореЛрдВ рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред

### рдЯреАрдо

**рдЯреАрдо** рд╡реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИрдВ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рдкрд╣реБрдВрдЪ рд╣реИред рдЯреАрдореЗрдВ рд╕рджрд╕реНрдпреЛрдВ рдХреЛ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИрдВред **`рд╕рд╣рдпреЛрдЧреА`** рдореМрдЬреВрджрд╛ рдРрдкреНрд╕ рдХреЛ рджреЗрдЦ рдФрд░ рддреИрдирд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ **`рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ`** рдирдП рдРрдкреНрд╕ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рдВрдЧрдарди рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдЕрдиреБрдкреНрд░рдпреЛрдЧ

рдПрдХ **рдРрдк** рдПрдХ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рддрд╛рд░реНрдХрд┐рдХ рд╕рдореВрд╣ рд╣реИред рдпрд╣ рдХрдИ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рд╕реЗрд╡рд╛рдУрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рдПрдХ рдкреВрд░реНрдг рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдПрдХ рд╕рдордЧреНрд░ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

### **рд╕реЗрд╡рд╛рдПрдБ**

рдПрдХ **рд╕реЗрд╡рд╛** рдПрдХ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрд╛ рдореБрдЦреНрдп рдШрдЯрдХ рд╣реИред рдпрд╣ рдЖрдкрдХреЗ рдкреВрд░реЗ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рдХрд╛рд░реНрдп, рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд╕рдВрд╕рд╛рдзрди рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдПрдХ `serverless.yml` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдПрдХ рд╕реЗрд╡рд╛ рдореЗрдВ рд╕реЗрд╡рд╛ рдХрд╛ рдирд╛рдо, рдкреНрд░рджрд╛рддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди, рдХрд╛рд░реНрдп, рдШрдЯрдирд╛рдПрдБ, рд╕рдВрд╕рд╛рдзрди, рдкреНрд▓рдЧрдЗрдиреНрд╕, рдФрд░ рдХрд╕реНрдЯрдо рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдЬреИрд╕реА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред
```yaml
service: my-service
provider:
name: aws
runtime: nodejs14.x
functions:
hello:
handler: handler.hello
```
<details>

<summary>Function</summary>

рдПрдХ **Function** рдПрдХрд▓ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ AWS Lambda рдлрд╝рдВрдХреНрд╢рдиред рдЗрд╕рдореЗрдВ рд╡рд╣ рдХреЛрдб рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдпрд╣ `serverless.yml` рдореЗрдВ `functions` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣реИрдВрдбрд▓рд░, рд░рдирдЯрд╛рдЗрдо, рдШрдЯрдирд╛рдПрдБ, рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░, рдФрд░ рдЕрдиреНрдп рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ рд╣реИрдВред
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
```
</details>

<details>

<summary>рдЗрд╡реЗрдВрдЯ</summary>

**рдЗрд╡реЗрдВрдЯреНрд╕** рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░рд▓реЗрд╕ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЯреНрд░рд┐рдЧрд░реНрд╕ рд╣реИрдВред рд╡реЗ рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХрдм рдФрд░ рдХреИрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рд╕рд╛рдорд╛рдиреНрдп рдЗрд╡реЗрдВрдЯ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ HTTP рдЕрдиреБрд░реЛрдз, рдЕрдиреБрд╕реВрдЪрд┐рдд рдЗрд╡реЗрдВрдЯ (рдХреНрд░реЙрди рдЬреЙрдм), рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрд╡реЗрдВрдЯ, рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдФрд░ рдЕрдзрд┐рдХ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
- schedule:
rate: rate(10 minutes)
```
</details>

<details>

<summary>рд╕рдВрд╕рд╛рдзрди</summary>

**рд╕рдВрд╕рд╛рдзрди** рдЖрдкрдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдХреНрд▓рд╛рдЙрдб рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬрд┐рди рдкрд░ рдЖрдкрдХреА рд╕реЗрд╡рд╛ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рдЬреИрд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕, рд╕реНрдЯреЛрд░реЗрдЬ рдмрдХреЗрдЯ, рдпрд╛ IAM рднреВрдорд┐рдХрд╛рдПрдБред

рдЗрдиреНрд╣реЗрдВ `resources` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрдХреНрд╕рд░ AWS рдХреЗ рд▓рд┐рдП CloudFormation рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред
```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
TableName: my-table
AttributeDefinitions:
- AttributeName: id
AttributeType: S
KeySchema:
- AttributeName: id
KeyType: HASH
ProvisionedThroughput:
ReadCapacityUnits: 1
WriteCapacityUnits: 1
```
</details>

<details>

<summary>рдкреНрд░рджрд╛рддрд╛</summary>

The **Provider** object specifies the cloud service provider (e.g., AWS, Azure, Google Cloud) and contains configuration settings relevant to that provider.

рдпрд╣ рд░рдирдЯрд╛рдЗрдо, рдХреНрд╖реЗрддреНрд░, рдЪрд░рдг рдФрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред
```yaml
yamlCopy codeprovider:
name: aws
runtime: nodejs14.x
region: us-east-1
stage: dev
```
</details>

<details>

<summary>рд╕реНрдЯреЗрдЬ рдФрд░ рдХреНрд╖реЗрддреНрд░</summary>

рд╕реНрдЯреЗрдЬ рд╡рд┐рднрд┐рдиреНрди рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕реЗ, рд╡рд┐рдХрд╛рд╕, рд╕реНрдЯреЗрдЬрд┐рдВрдЧ, рдЙрддреНрдкрд╛рджрди) рдЬрд╣рд╛рдБ рдЖрдкрдХреА рд╕реЗрд╡рд╛ рдХреЛ рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд╛рддрд╛рд╡рд░рдг-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рддреИрдирд╛рддреА рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
```yaml
provider:
stage: dev
```
рдХреНрд╖реЗрддреНрд░ рдЙрд╕ рднреМрдЧреЛрд▓рд┐рдХ рдХреНрд╖реЗрддреНрд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдЖрдкрдХреЗ рд╕рдВрд╕рд╛рдзрди рддреИрдирд╛рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдпрд╣ рд╡рд┐рд▓рдВрдмрддрд╛, рдЕрдиреБрдкрд╛рд▓рди рдФрд░ рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
```yaml
provider:
region: us-west-2
```
</details>

<details>

<summary>Plugins</summary>

**Plugins** Serverless Framework рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдирдП рдлреАрдЪрд░реНрд╕ рдЬреЛрдбрд╝рдХрд░ рдпрд╛ рдЕрдиреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рдХрд░рдХреЗ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ `plugins` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ npm рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
plugins:
- serverless-offline
- serverless-webpack
```
</details>

<details>

<summary>рдкрд░рддреЗрдВ</summary>

**рдкрд░рддреЗрдВ** рдЖрдкрдХреЛ рд╕рд╛рдЭрд╛ рдХреЛрдб рдпрд╛ рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреЛ рдЖрдкрдХреЗ рдХрд╛рд░реНрдпреЛрдВ рд╕реЗ рдЕрд▓рдЧ рдкреИрдХреЗрдЬ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред рдпрд╣ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрддреА рд╣реИ рдФрд░ рддреИрдирд╛рддреА рдкреИрдХреЗрдЬ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рдХрд░рддреА рд╣реИред рдЗрдиреНрд╣реЗрдВ `layers` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
layers:
commonLibs:
path: layer-common
functions:
hello:
handler: handler.hello
layers:
- { Ref: CommonLibsLambdaLayer }
```
</details>

<details>

<summary>Variables рдФрд░ Custom Variables</summary>

**Variables** рдЧрддрд┐рд╢реАрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рддреИрдирд╛рддреА рдХреЗ рд╕рдордп рд╣рд▓ рд╣реЛрддреЗ рд╣реИрдВред

*   **Syntax:** `${variable}` рд╕рд┐рдВрдЯреИрдХреНрд╕ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░, рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА, рдпрд╛ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

```yaml
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```

-   **Custom Variables:** `custom` рдЕрдиреБрднрд╛рдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪрд░ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ `serverless.yml` рдореЗрдВ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

```yaml
custom:
tableName: my-dynamodb-table
stage: ${opt:stage, 'dev'}
```

</details>

<details>

<summary>Outputs</summary>

**Outputs** рдЙрди рдорд╛рдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рд╕реЗрд╡рд╛ рдХреЗ рддреИрдирд╛рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рд▓реМрдЯрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рд╕рдВрд╕рд╛рдзрди ARNs, рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕, рдпрд╛ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реАред рдЗрдиреНрд╣реЗрдВ `outputs` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдХреНрд╕рд░ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдпрд╛ рддреИрдирд╛рддреА рдХреЗ рдмрд╛рдж рдЖрд╕рд╛рди рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
┬бoutputs:
ApiEndpoint:
Description: "API Gateway endpoint URL"
Value:
Fn::Join:
- ""
- - "https://"
- Ref: ApiGatewayRestApi
- ".execute-api."
- Ref: AWS::Region
- ".amazonaws.com/"
- Ref: AWS::Stage
```
</details>

<details>

<summary>IAM рднреВрдорд┐рдХрд╛рдПрдБ рдФрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ</summary>

**IAM рднреВрдорд┐рдХрд╛рдПрдБ рдФрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдЖрдкрдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдФрд░ рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдФрд░ рдкрд╣реБрдБрдЪ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `provider` рдпрд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХрд╛рд░реНрдп рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
</details>

<details>

<summary>рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░</summary>

**рдЪрд░** рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рд╣рд╛рд░реНрдбрдХреЛрдб рдХрд┐рдП рдмрд┐рдирд╛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдкреНрд░рджрд╛рддрд╛ рдпрд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП `environment` рдЕрдиреБрднрд╛рдЧ рдХреЗ рддрд╣рдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
provider:
environment:
STAGE: ${self:provider.stage}
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```
</details>

<details>

<summary>Dependencies</summary>

**Dependencies** рдЖрдкрдХреЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдмрд╛рд╣рд░реА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдФрд░ рдореЙрдбреНрдпреВрд▓реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдЖрдорддреМрд░ рдкрд░ npm рдпрд╛ pip рдЬреИрд╕реЗ рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ `serverless-webpack` рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдпрд╛ рдкреНрд▓рдЧрдЗрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдХреЗ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рдмрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```yaml
plugins:
- serverless-webpack
```
</details>

<details>

<summary>Hooks</summary>

**Hooks** рдЖрдкрдХреЛ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдЬреАрд╡рдирдЪрдХреНрд░ рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдХрд╕реНрдЯрдо рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╛ `serverless.yml` рдХреЗ рднреАрддрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдмрд╛рдж рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХреЗрдВред
```yaml
custom:
hooks:
before:deploy:deploy: echo "Starting deployment..."
```
</details>

### Tutorial

рдпрд╣ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рд╣реИ [**from the docs**](https://www.serverless.com/framework/docs/tutorial):

1. рдПрдХ AWS рдЦрд╛рддрд╛ рдмрдирд╛рдПрдВ (Serverless.com AWS рдЕрд╡рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ)
2. serverless.com рдореЗрдВ рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдПрдВ
3. рдПрдХ рдРрдк рдмрдирд╛рдПрдВ:
```bash
# Create temp folder for the tutorial
mkdir /tmp/serverless-tutorial
cd /tmp/serverless-tutorial

# Install Serverless cli
npm install -g serverless

# Generate template
serverless #Choose first one (AWS / Node.js / HTTP API)
## Indicate a name like "Tutorial"
## Login/Register
## Create A New App
## Indicate a name like "tutorialapp)
```
рдпрд╣ рдПрдХ **app** рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдерд╛ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `tutorialapp` рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк [serverless.com](serverless.com-security.md) рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдерд╛ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `Tutorial` рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдлрд╝рд╛рдЗрд▓ **`handler.js`** рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ JS рдХреЛрдб рд╣реИ рдЬрд┐рд╕рдореЗрдВ `helloworld` рдХреЛрдб рд╣реИ рдФрд░ рдлрд╝рд╛рдЗрд▓ **`serverless.yml`** рд╣реИ рдЬреЛ рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддреА рд╣реИ:

{% tabs %}
{% tab title="handler.js" %}
```javascript
exports.hello = async (event) => {
return {
statusCode: 200,
body: JSON.stringify({
message: "Go Serverless v4! Your function executed successfully!",
}),
};
};
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
```
{% endtab %}
{% endtabs %}

4. рдПрдХ AWS рдкреНрд░рджрд╛рддрд╛ рдмрдирд╛рдПрдВ, **рдбреИрд╢рдмреЛрд░реНрдб** рдореЗрдВ рдЬрд╛рдХрд░ `https://app.serverless.com/<org name>/settings/providers?providerId=new&provider=aws`ред
1. `serverless.com` рдХреЛ AWS рддрдХ рдкрд╣реБрдВрдЪ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдПрдХ рдХреНрд▓рд╛рдЙрдбрдлреЙрд░реНрдореЗрд╢рди рд╕реНрдЯреИрдХ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдЧрд╛, рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП (рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд╕рдордп): [https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml](https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml)
2. рдпрд╣ рдЯреЗрдореНрдкрд▓реЗрдЯ **`SFRole-<ID>`** рдирд╛рдордХ рдПрдХ рднреВрдорд┐рдХрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **`arn:aws:iam::aws:policy/AdministratorAccess`** рдЙрд╕ рдЦрд╛рддреЗ рдкрд░ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЯреНрд░рд╕реНрдЯ рдЖрдЗрдбреЗрдВрдЯрд┐рдЯреА рд╣реИ рдЬреЛ `Serverless.com` AWS рдЦрд╛рддреЗ рдХреЛ рднреВрдорд┐рдХрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред

<details>

<summary>Yaml roleTemplate</summary>
```yaml
Description: This stack creates an IAM role that can be used by Serverless Framework for use in deployments.
Resources:
SFRole:
Type: AWS::IAM::Role
Properties:
AssumeRolePolicyDocument:
Version: '2012-10-17'
Statement:
- Effect: Allow
Principal:
AWS: arn:aws:iam::486128539022:root
Action:
- sts:AssumeRole
Condition:
StringEquals:
sts:ExternalId: !Sub 'ServerlessFramework-${OrgUid}'
Path: /
RoleName: !Ref RoleName
ManagedPolicyArns:
- arn:aws:iam::aws:policy/AdministratorAccess
ReporterFunction:
Type: Custom::ServerlessFrameworkReporter
Properties:
ServiceToken: 'arn:aws:lambda:us-east-1:486128539022:function:sp-providers-stack-reporter-custom-resource-prod-tmen2ec'
OrgUid: !Ref OrgUid
RoleArn: !GetAtt SFRole.Arn
Alias: !Ref Alias
Outputs:
SFRoleArn:
Description: 'ARN for the IAM Role used by Serverless Framework'
Value: !GetAtt SFRole.Arn
Parameters:
OrgUid:
Description: Serverless Framework Org Uid
Type: String
Alias:
Description: Serverless Framework Provider Alias
Type: String
RoleName:
Description: Serverless Framework Role Name
Type: String
```
</details>

<details>

<summary>рд╡рд┐рд╢реНрд╡рд╛рд╕ рд╕рдВрдмрдВрдз</summary>
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": "arn:aws:iam::486128539022:root"
},
"Action": "sts:AssumeRole",
"Condition": {
"StringEquals": {
"sts:ExternalId": "ServerlessFramework-7bf7ddef-e1bf-43eb-a111-4d43e0894ccb"
}
}
}
]
}
```
</details>

5. рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ `createCustomer.js` рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ, рдЬреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХ рдирдпрд╛ API рдПрдВрдбрдкреЙрдЗрдВрдЯ рдмрдирд╛рдПрдЧрд╛ рдЬрд┐рд╕реЗ рдирдП JS рдлрд╝рд╛рдЗрд▓ рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ `serverless.yml` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдПрдХ **рдирдпрд╛ DynamoDB рддрд╛рд▓рд┐рдХрд╛** рдЙрддреНрдкрдиреНрди рдХрд░реЗ, рдПрдХ **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗ, рдЙрд╕ рднреВрдорд┐рдХрд╛ рдХреЛ рдЬреЛ рдЙрддреНрдкрдиреНрди рд▓реИрдВрдмреНрдбрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧреАред

{% tabs %}
{% tab title="createCustomer.js" %}
```javascript
'use strict'
const AWS = require('aws-sdk')
module.exports.createCustomer = async (event) => {
const body = JSON.parse(Buffer.from(event.body, 'base64').toString())
const dynamoDb = new AWS.DynamoDB.DocumentClient()
const putParams = {
TableName: process.env.DYNAMODB_CUSTOMER_TABLE,
Item: {
primary_key: body.name,
email: body.email,
},
}
await dynamoDb.put(putParams).promise()
return {
statusCode: 201,
}
}
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x
environment:
DYNAMODB_CUSTOMER_TABLE: ${self:service}-customerTable-${sls:stage}
iam:
role:
statements:
- Effect: 'Allow'
Action:
- 'dynamodb:PutItem'
- 'dynamodb:Get*'
- 'dynamodb:Scan*'
- 'dynamodb:UpdateItem'
- 'dynamodb:DeleteItem'
Resource: arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${self:service}-customerTable-${sls:stage}

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
createCustomer:
handler: createCustomer.createCustomer
events:
- httpApi:
path: /
method: post

resources:
Resources:
CustomerTable:
Type: AWS::DynamoDB::Table
Properties:
AttributeDefinitions:
- AttributeName: primary_key
AttributeType: S
BillingMode: PAY_PER_REQUEST
KeySchema:
- AttributeName: primary_key
KeyType: HASH
TableName: ${self:service}-customerTable-${sls:stage}
```
{% endtab %}
{% endtabs %}

6. рдЗрд╕реЗ рдЪрд▓рд╛рддреЗ рд╣реБрдП рдбрд┐рдкреНрд▓реЙрдп рдХрд░реЗрдВ **`serverless deploy`**
1. рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдПрдХ CloudFormation Stack рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛
2. рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **lambdas API рдЧреЗрдЯрд╡реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд┐рдП рдЧрдП рд╣реИрдВ** рдФрд░ рд╕реАрдзреЗ URLs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд╣реАрдВ
7. **рдЗрд╕реЗ рдЯреЗрд╕реНрдЯ рдХрд░реЗрдВ**
1. рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рдореЗрдВ **URLs** рдкреНрд░рд┐рдВрдЯ рдХреА рдЬрд╛рдПрдВрдЧреА рдЬрд╣рд╛рдБ рдЖрдкрдХреЗ API рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ lambda рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

## Serverless.com рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореАрдХреНрд╖рд╛

### **рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП IAM рд░реЛрд▓ рдФрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ**

рдЕрддреНрдпрдзрд┐рдХ рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реЗ IAM рд░реЛрд▓ рдХреНрд▓рд╛рдЙрдб рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдбреЗрдЯрд╛ рд▓реАрдХ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╣реЗрд░рдлреЗрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

#### **рдирд┐рд╡рд╛рд░рдг рд░рдгрдиреАрддрд┐рдпрд╛рдБ**

*   **рдХрдо рд╕реЗ рдХрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд:** рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВред

```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
* **рдЕрд▓рдЧ-рдЕрд▓рдЧ рд░реЛрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:** рдлрд╝рдВрдХреНрд╢рди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд░реЛрд▓ рдХреЛ рдЕрд▓рдЧ рдХрд░реЗрдВред

***

### **рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд░рд╣рд╕реНрдп рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреНрд░рдмрдВрдзрди**

рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА (рдЬреИрд╕реЗ, API рдХреБрдВрдЬреА, рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓) рдХреЛ рд╕реАрдзреЗ **`serverless.yml`** рдпрд╛ рдХреЛрдб рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рдирд╛ рдЬреЛрдЦрд┐рдо рднрд░рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред

**рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЧрдИ** рд╡рд┐рдзрд┐ **`serverless.yml`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП serverless.com рд╕реЗ (рдЗрд╕ рд▓реЗрдЦрди рдХреЗ рд╕рдордп) `ssm` рдпрд╛ `s3` рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рдЬреЛ **рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЗ рд╕рдордп рдЗрди рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдкрд░реНрдпрд╛рд╡рд░рдг рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдФрд░ **lambdas** рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЛ **рдорд╛рдиреЛрдВ рдХреЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ!

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, AWS рдХреЗ рдЕрдВрджрд░ lambdas рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд░рдЦрдиреЗ рд╡рд╛рд▓рд╛ рдХреЛрдИ рднреА рд╡реНрдпрдХреНрддрд┐ **рдЗрди рд╕рднреА рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЛ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХреЗрдЧрд╛!**
{% endhint %}

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг SSM рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛:
```yaml
provider:
environment:
DB_PASSWORD: ${ssm:/aws/reference/secretsmanager/my-db-password~true}
```
And even if this prevents hardcoding the environment variable value in the **`serverless.yml`** file, the value will be obtained at deployment time and will be **lambda environment variable рдХреЗ рдЕрдВрджрд░ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛**.

{% hint style="success" %}
The recommended way to store environment variables using serveless.com would be to **AWS secret рдореЗрдВ рдЗрд╕реЗ рд╕реНрдЯреЛрд░ рдХрд░реЗрдВ** and just store the secret name in the environment variable and the **lambda code should gather it**.
{% endhint %}

#### **Mitigation Strategies**

* **Secrets Manager Integration:** Use services like **AWS Secrets Manager.**
* **Encrypted Variables:** Leverage Serverless FrameworkтАЩs encryption features for sensitive data.
* **Access Controls:** Restrict access to secrets based on roles.

***

### **Vulnerable Code and Dependencies**

Outdated or insecure dependencies can introduce vulnerabilities, while improper input handling may lead to code injection attacks.

#### **Mitigation Strategies**

*   **Dependency Management:** Regularly update dependencies and scan for vulnerabilities.

```yaml
plugins:
- serverless-webpack
- serverless-plugin-snyk
```
* **Input Validation:** Implement strict validation and sanitization of all inputs.
* **Code Reviews:** Conduct thorough reviews to identify security flaws.
* **Static Analysis:** Use tools to detect vulnerabilities in the codebase.

***

### **Inadequate Logging and Monitoring**

Without proper logging and monitoring, malicious activities may go undetected, delaying incident response.

#### **Mitigation Strategies**

*   **Centralized Logging:** Aggregate logs using services like **AWS CloudWatch** or **Datadog**.

```yaml
plugins:
- serverless-plugin-datadog
```
* **Enable Detailed Logging:** Capture essential information without exposing sensitive data.
* **Set Up Alerts:** Configure alerts for suspicious activities or anomalies.
* **Regular Monitoring:** Continuously monitor logs and metrics for potential security incidents.

***

### **Insecure API Gateway Configurations**

Open or improperly secured APIs can be exploited for unauthorized access, Denial of Service (DoS) attacks, or cross-site attacks.

#### **Mitigation Strategies**

*   **Authentication and Authorization:** Implement robust mechanisms like OAuth, API keys, or JWT.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
authorizer: aws_iam
```
*   **Rate Limiting and Throttling:** Prevent abuse by limiting request rates.

```yaml
provider:
apiGateway:
throttle:
burstLimit: 200
rateLimit: 100
```
*   **Secure CORS Configuration:** Restrict allowed origins, methods, and headers.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
cors:
origin: https://yourdomain.com
headers:
- Content-Type
```
* **Use Web Application Firewalls (WAF):** Filter and monitor HTTP requests for malicious patterns.

***

### **Insufficient Function Isolation**

Shared resources and inadequate isolation can lead to privilege escalations or unintended interactions between functions.

#### **Mitigation Strategies**

* **Isolate Functions:** Assign distinct resources and IAM roles to ensure independent operation.
* **Resource Partitioning:** Use separate databases or storage buckets for different functions.
*   **Use VPCs:** Deploy functions within Virtual Private Clouds for enhanced network isolation.

```yaml
provider:
vpc:
securityGroupIds:
- sg-xxxxxxxx
subnetIds:
- subnet-xxxxxx
```
* **Limit Function Permissions:** Ensure functions cannot access or interfere with each otherтАЩs resources unless explicitly required.

***

### **Inadequate Data Protection**

Unencrypted data at rest or in transit can be exposed, leading to data breaches or tampering.

#### **Mitigation Strategies**

*   **Encrypt Data at Rest:** Utilize cloud service encryption features.

```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
SSESpecification:
SSEEnabled: true
```
* **Encrypt Data in Transit:** Use HTTPS/TLS for all data transmissions.
* **Secure API Communication:** Enforce encryption protocols and validate certificates.
* **Manage Encryption Keys Securely:** Use managed key services and rotate keys regularly.

***

### **Lack of Proper Error Handling**

Detailed error messages can leak sensitive information about the infrastructure or codebase, while unhandled exceptions may lead to application crashes.

#### **Mitigation Strategies**

*   **Generic Error Messages:** Avoid exposing internal details in error responses.

```javascript
javascriptCopy code// Example in Node.js
exports.hello = async (event) => {
try {
// Function logic
} catch (error) {
console.error(error);
return {
statusCode: 500,
body: JSON.stringify({ message: 'Internal Server Error' }),
};
}
};
```
* **Centralized Error Handling:** Manage and sanitize errors consistently across all functions.
* **Monitor and Log Errors:** Track and analyze errors internally without exposing details to end-users.

***

### **Insecure Deployment Practices**

Exposed deployment configurations or unauthorized access to CI/CD pipelines can lead to malicious code deployments or misconfigurations.

#### **Mitigation Strategies**

* **Secure CI/CD Pipelines:** Implement strict access controls, multi-factor authentication (MFA), and regular audits.
* **Store Configuration Securely:** Keep deployment files free from hardcoded secrets and sensitive data.
* **Use Infrastructure as Code (IaC) Security Tools:** Employ tools like **Checkov** or **Terraform Sentinel** to enforce security policies.
* **Immutable Deployments:** Prevent unauthorized changes post-deployment by adopting immutable infrastructure practices.

***

### **Vulnerabilities in Plugins and Extensions**

Using unvetted or malicious third-party plugins can introduce vulnerabilities into your serverless applications.

#### **Mitigation Strategies**

* **Vet Plugins Thoroughly:** Assess the security of plugins before integration, favoring those from reputable sources.
* **Limit Plugin Usage:** Use only necessary plugins to minimize the attack surface.
* **Monitor Plugin Updates:** Keep plugins updated to benefit from security patches.
* **Isolate Plugin Environments:** Run plugins in isolated environments to contain potential compromises.

***

### **Exposure of Sensitive Endpoints**

Publicly accessible functions or unrestricted APIs can be exploited for unauthorized operations.

#### **Mitigation Strategies**

* **Restrict Function Access:** Use VPCs, security groups, and firewall rules to limit access to trusted sources.
* **Implement Robust Authentication:** Ensure all exposed endpoints require proper authentication and authorization.
* **Use API Gateways Securely:** Configure API Gateways to enforce security policies, including input validation and rate limiting.
* **Disable Unused Endpoints:** Regularly review and disable any endpoints that are no longer in use.

***

### **Excessive Permissions for Team Members and External Collaborators**

Granting excessive permissions to team members and external collaborators can lead to unauthorized access, data breaches, and misuse of resources. This risk is heightened in environments where multiple individuals have varying levels of access, increasing the attack surface and potential for insider threats.

#### **Mitigation Strategies**

* **Principle of Least Privilege:** Ensure that team members and collaborators have only the permissions necessary to perform their tasks.

***

### **Access Keys and License Keys Security**

**Access Keys** and **License Keys** are critical credentials used to authenticate and authorize interactions with the Serverless Framework CLI.

* **License Keys:** рд╡реЗ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реИрдВ рдЬреЛ Serverless Framework Version 4 рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВ рдЬреЛ CLI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **Access Keys:** рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬреЛ Serverless Framework CLI рдХреЛ Serverless Framework Dashboard рдХреЗ рд╕рд╛рде рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рдЬрдм `serverless` cli рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдПрдХ access key **рдЬрдирд░реЗрдЯ рдФрд░ рд▓реИрдкрдЯреЙрдк рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЖрдк рдЗрд╕реЗ `SERVERLESS_ACCESS_KEY` рдирд╛рдордХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### **Security Risks**

1. **Exposure Through Code Repositories:**
* Hardcoding or accidentally committing Access Keys and License Keys to version control systems can lead to unauthorized access.
2. **Insecure Storage:**
* Storing keys in plaintext within environment variables or configuration files without proper encryption increases the likelihood of leakage.
3. **Improper Distribution:**
* Sharing keys through unsecured channels (e.g., email, chat) can result in interception by malicious actors.
4. **Lack of Rotation:**
* Not regularly rotating keys extends the exposure period if keys are compromised.
5. **Excessive Permissions:**
* Keys with broad permissions can be exploited to perform unauthorized actions across multiple resources.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
