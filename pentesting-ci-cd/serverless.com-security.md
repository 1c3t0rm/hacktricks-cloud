# Serverless.com S√©curit√©

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Formation AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Formation GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Informations de base

### Organisation

Une **Organisation** est l'entit√© de plus haut niveau au sein de l'√©cosyst√®me Serverless Framework. Elle repr√©sente un **groupe collectif**, tel qu'une entreprise, un d√©partement ou toute grande entit√©, qui englobe plusieurs projets, √©quipes et applications.

### √âquipe

L'**√âquipe** est constitu√©e des utilisateurs ayant acc√®s √† l'int√©rieur de l'organisation. Les √©quipes aident √† organiser les membres en fonction des r√¥les. Les **`Collaborateurs`** peuvent voir et d√©ployer des applications existantes, tandis que les **`Admins`** peuvent cr√©er de nouvelles applications et g√©rer les param√®tres de l'organisation.

### Application

Une **App** est un regroupement logique de services li√©s au sein d'une Organisation. Elle repr√©sente une application compl√®te compos√©e de plusieurs services serverless qui travaillent ensemble pour fournir une fonctionnalit√© coh√©rente.

### **Services**

Un **Service** est le composant central d'une application Serverless. Il repr√©sente l'ensemble de votre projet serverless, englobant toutes les fonctions, configurations et ressources n√©cessaires. Il est g√©n√©ralement d√©fini dans un fichier `serverless.yml`, un service inclut des m√©tadonn√©es comme le nom du service, les configurations du fournisseur, les fonctions, les √©v√©nements, les ressources, les plugins et les variables personnalis√©es.
```yaml
service: my-service
provider:
name: aws
runtime: nodejs14.x
functions:
hello:
handler: handler.hello
```
<details>

<summary>Fonction</summary>

Une **Fonction** repr√©sente une seule fonction sans serveur, comme une fonction AWS Lambda. Elle contient le code qui s'ex√©cute en r√©ponse √† des √©v√©nements.

Elle est d√©finie dans la section `functions` de `serverless.yml`, sp√©cifiant le gestionnaire, l'environnement d'ex√©cution, les √©v√©nements, les variables d'environnement et d'autres param√®tres.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
```
</details>

<details>

<summary>√âv√©nement</summary>

**√âv√©nements** sont des d√©clencheurs qui invoquent vos fonctions serverless. Ils d√©finissent comment et quand une fonction doit √™tre ex√©cut√©e.

Les types d'√©v√©nements courants incluent les requ√™tes HTTP, les √©v√©nements planifi√©s (t√¢ches cron), les √©v√©nements de base de donn√©es, les t√©l√©chargements de fichiers, et plus encore.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
- schedule:
rate: rate(10 minutes)
```
</details>

<details>

<summary>Ressource</summary>

**Ressources** vous permettent de d√©finir des ressources cloud suppl√©mentaires dont votre service d√©pend, telles que des bases de donn√©es, des buckets de stockage ou des r√¥les IAM.

Elles sont sp√©cifi√©es sous la section `resources`, souvent en utilisant la syntaxe CloudFormation pour AWS.
```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
TableName: my-table
AttributeDefinitions:
- AttributeName: id
AttributeType: S
KeySchema:
- AttributeName: id
KeyType: HASH
ProvisionedThroughput:
ReadCapacityUnits: 1
WriteCapacityUnits: 1
```
</details>

<details>

<summary>Fournisseur</summary>

L'objet **Fournisseur** sp√©cifie le fournisseur de services cloud (par exemple, AWS, Azure, Google Cloud) et contient des param√®tres de configuration pertinents pour ce fournisseur.

Il inclut des d√©tails comme l'environnement d'ex√©cution, la r√©gion, l'√©tape et les identifiants.
```yaml
yamlCopy codeprovider:
name: aws
runtime: nodejs14.x
region: us-east-1
stage: dev
```
</details>

<details>

<summary>√âtape et R√©gion</summary>

L'√©tape repr√©sente diff√©rents environnements (par exemple, d√©veloppement, pr√©production, production) o√π votre service peut √™tre d√©ploy√©. Elle permet des configurations et des d√©ploiements sp√©cifiques √† l'environnement.
```yaml
provider:
stage: dev
```
La r√©gion sp√©cifie la r√©gion g√©ographique o√π vos ressources seront d√©ploy√©es. C'est important pour les consid√©rations de latence, de conformit√© et de disponibilit√©.
```yaml
provider:
region: us-west-2
```
</details>

<details>

<summary>Plugins</summary>

**Plugins** √©tendent la fonctionnalit√© du Serverless Framework en ajoutant de nouvelles fonctionnalit√©s ou en s'int√©grant √† d'autres outils et services. Ils sont d√©finis dans la section `plugins` et install√©s via npm.
```yaml
plugins:
- serverless-offline
- serverless-webpack
```
</details>

<details>

<summary>Couches</summary>

**Couches** vous permettent de regrouper et de g√©rer le code partag√© ou les d√©pendances s√©par√©ment de vos fonctions. Cela favorise la r√©utilisabilit√© et r√©duit la taille des paquets de d√©ploiement. Elles sont d√©finies sous la section `layers` et r√©f√©renc√©es par les fonctions.
```yaml
layers:
commonLibs:
path: layer-common
functions:
hello:
handler: handler.hello
layers:
- { Ref: CommonLibsLambdaLayer }
```
</details>

<details>

<summary>Variables et Variables Personnalis√©es</summary>

**Variables** permettent une configuration dynamique en permettant l'utilisation de placeholders qui sont r√©solus au moment du d√©ploiement.

*   **Syntaxe :** La syntaxe `${variable}` peut r√©f√©rencer des variables d'environnement, le contenu de fichiers ou d'autres param√®tres de configuration.

```yaml
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```

-   **Variables Personnalis√©es :** La section `custom` est utilis√©e pour d√©finir des variables et des configurations sp√©cifiques √† l'utilisateur qui peuvent √™tre r√©utilis√©es dans tout le `serverless.yml`.

```yaml
custom:
tableName: my-dynamodb-table
stage: ${opt:stage, 'dev'}
```

</details>

<details>

<summary>Sorties</summary>

**Sorties** d√©finissent les valeurs qui sont retourn√©es apr√®s qu'un service a √©t√© d√©ploy√©, telles que les ARNs de ressources, les points de terminaison ou d'autres informations utiles. Elles sont sp√©cifi√©es sous la section `outputs` et sont souvent utilis√©es pour exposer des informations √† d'autres services ou pour un acc√®s facile apr√®s le d√©ploiement.
```yaml
¬°outputs:
ApiEndpoint:
Description: "API Gateway endpoint URL"
Value:
Fn::Join:
- ""
- - "https://"
- Ref: ApiGatewayRestApi
- ".execute-api."
- Ref: AWS::Region
- ".amazonaws.com/"
- Ref: AWS::Stage
```
</details>

<details>

<summary>R√¥les et autorisations IAM</summary>

**R√¥les et autorisations IAM** d√©finissent les informations d'identification de s√©curit√© et les droits d'acc√®s pour vos fonctions et autres ressources. Ils sont g√©r√©s sous les param√®tres `provider` ou de fonction individuelle pour sp√©cifier les autorisations n√©cessaires.
```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
</details>

<details>

<summary>Variables d'environnement</summary>

**Les variables** vous permettent de transmettre des param√®tres de configuration et des secrets √† vos fonctions sans les coder en dur. Elles sont d√©finies sous la section `environment` pour le fournisseur ou pour des fonctions individuelles.
```yaml
provider:
environment:
STAGE: ${self:provider.stage}
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```
</details>

<details>

<summary>D√©pendances</summary>

**D√©pendances** g√®rent les biblioth√®ques et modules externes dont vos fonctions ont besoin. Elles sont g√©n√©ralement g√©r√©es via des gestionnaires de paquets comme npm ou pip, et regroup√©es avec votre package de d√©ploiement √† l'aide d'outils ou de plugins comme `serverless-webpack`.
```yaml
plugins:
- serverless-webpack
```
</details>

<details>

<summary>Hooks</summary>

**Hooks** vous permettent d'ex√©cuter des scripts ou des commandes personnalis√©s √† des moments sp√©cifiques du cycle de vie de d√©ploiement. Ils sont d√©finis √† l'aide de plugins ou dans le `serverless.yml` pour effectuer des actions avant ou apr√®s les d√©ploiements.
```yaml
custom:
hooks:
before:deploy:deploy: echo "Starting deployment..."
```
</details>

### Tutoriel

Ceci est un r√©sum√© du tutoriel officiel [**des docs**](https://www.serverless.com/framework/docs/tutorial) :

1. Cr√©ez un compte AWS (Serverless.com commence dans l'infrastructure AWS)
2. Cr√©ez un compte sur serverless.com
3. Cr√©ez une application :
```bash
# Create temp folder for the tutorial
mkdir /tmp/serverless-tutorial
cd /tmp/serverless-tutorial

# Install Serverless cli
npm install -g serverless

# Generate template
serverless #Choose first one (AWS / Node.js / HTTP API)
## Indicate a name like "Tutorial"
## Login/Register
## Create A New App
## Indicate a name like "tutorialapp)
```
Cela aurait d√ª cr√©er une **app** appel√©e `tutorialapp` que vous pouvez v√©rifier sur [serverless.com](serverless.com-security.md) et un dossier appel√© `Tutorial` avec le fichier **`handler.js`** contenant du code JS avec un code `helloworld` et le fichier **`serverless.yml`** d√©clarant cette fonction :

{% tabs %}
{% tab title="handler.js" %}
```javascript
exports.hello = async (event) => {
return {
statusCode: 200,
body: JSON.stringify({
message: "Go Serverless v4! Your function executed successfully!",
}),
};
};
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
```
{% endtab %}
{% endtabs %}

4. Cr√©ez un fournisseur AWS en allant dans le **tableau de bord** √† `https://app.serverless.com/<nom de l'organisation>/settings/providers?providerId=new&provider=aws`.
1. Pour donner acc√®s √† `serverless.com` √† AWS, il demandera d'ex√©cuter une pile cloudformation en utilisant ce fichier de configuration (au moment de la r√©daction) : [https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml](https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml)
2. Ce mod√®le g√©n√®re un r√¥le appel√© **`SFRole-<ID>`** avec **`arn:aws:iam::aws:policy/AdministratorAccess`** sur le compte avec une identit√© de confiance qui permet au compte AWS de `Serverless.com` d'acc√©der au r√¥le.

<details>

<summary>Yaml roleTemplate</summary>
```yaml
Description: This stack creates an IAM role that can be used by Serverless Framework for use in deployments.
Resources:
SFRole:
Type: AWS::IAM::Role
Properties:
AssumeRolePolicyDocument:
Version: '2012-10-17'
Statement:
- Effect: Allow
Principal:
AWS: arn:aws:iam::486128539022:root
Action:
- sts:AssumeRole
Condition:
StringEquals:
sts:ExternalId: !Sub 'ServerlessFramework-${OrgUid}'
Path: /
RoleName: !Ref RoleName
ManagedPolicyArns:
- arn:aws:iam::aws:policy/AdministratorAccess
ReporterFunction:
Type: Custom::ServerlessFrameworkReporter
Properties:
ServiceToken: 'arn:aws:lambda:us-east-1:486128539022:function:sp-providers-stack-reporter-custom-resource-prod-tmen2ec'
OrgUid: !Ref OrgUid
RoleArn: !GetAtt SFRole.Arn
Alias: !Ref Alias
Outputs:
SFRoleArn:
Description: 'ARN for the IAM Role used by Serverless Framework'
Value: !GetAtt SFRole.Arn
Parameters:
OrgUid:
Description: Serverless Framework Org Uid
Type: String
Alias:
Description: Serverless Framework Provider Alias
Type: String
RoleName:
Description: Serverless Framework Role Name
Type: String
```
</details>

<details>

<summary>Relation de confiance</summary>
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": "arn:aws:iam::486128539022:root"
},
"Action": "sts:AssumeRole",
"Condition": {
"StringEquals": {
"sts:ExternalId": "ServerlessFramework-7bf7ddef-e1bf-43eb-a111-4d43e0894ccb"
}
}
}
]
}
```
</details>

5. Le tutoriel demande de cr√©er le fichier `createCustomer.js` qui va essentiellement cr√©er un nouveau point de terminaison API g√©r√© par le nouveau fichier JS et demande de modifier le fichier `serverless.yml` pour qu'il g√©n√®re une **nouvelle table DynamoDB**, d√©finisse une **variable d'environnement**, le r√¥le qui utilisera les lambdas g√©n√©r√©es.

{% tabs %}
{% tab title="createCustomer.js" %}
```javascript
'use strict'
const AWS = require('aws-sdk')
module.exports.createCustomer = async (event) => {
const body = JSON.parse(Buffer.from(event.body, 'base64').toString())
const dynamoDb = new AWS.DynamoDB.DocumentClient()
const putParams = {
TableName: process.env.DYNAMODB_CUSTOMER_TABLE,
Item: {
primary_key: body.name,
email: body.email,
},
}
await dynamoDb.put(putParams).promise()
return {
statusCode: 201,
}
}
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x
environment:
DYNAMODB_CUSTOMER_TABLE: ${self:service}-customerTable-${sls:stage}
iam:
role:
statements:
- Effect: 'Allow'
Action:
- 'dynamodb:PutItem'
- 'dynamodb:Get*'
- 'dynamodb:Scan*'
- 'dynamodb:UpdateItem'
- 'dynamodb:DeleteItem'
Resource: arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${self:service}-customerTable-${sls:stage}

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
createCustomer:
handler: createCustomer.createCustomer
events:
- httpApi:
path: /
method: post

resources:
Resources:
CustomerTable:
Type: AWS::DynamoDB::Table
Properties:
AttributeDefinitions:
- AttributeName: primary_key
AttributeType: S
BillingMode: PAY_PER_REQUEST
KeySchema:
- AttributeName: primary_key
KeyType: HASH
TableName: ${self:service}-customerTable-${sls:stage}
```
{% endtab %}
{% endtabs %}

6. D√©ployez-le en ex√©cutant **`serverless deploy`**
1. Le d√©ploiement sera effectu√© via une pile CloudFormation
2. Notez que les **lambdas sont expos√©es via API gateway** et non via des URL directes
7. **Testez-le**
1. L'√©tape pr√©c√©dente affichera les **URLs** o√π vos fonctions lambda des points de terminaison API ont √©t√© d√©ploy√©es

## Revue de S√©curit√© de Serverless.com

### **R√¥les et Permissions IAM mal configur√©s**

Des r√¥les IAM trop permissifs peuvent accorder un acc√®s non autoris√© aux ressources cloud, entra√Ænant des violations de donn√©es ou une manipulation des ressources.

#### **Strat√©gies d'att√©nuation**

*   **Principe du Moindre Privil√®ge :** Attribuez uniquement les permissions n√©cessaires √† chaque fonction.

```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
* **Utilisez des R√¥les S√©par√©s :** Diff√©renciez les r√¥les en fonction des exigences de la fonction.

***

### **Secrets et Gestion de Configuration Insecure**

Stocker des informations sensibles (par exemple, cl√©s API, identifiants de base de donn√©es) directement dans `serverless.yml` ou le code peut entra√Æner une exposition si les d√©p√¥ts sont compromis ou si l'acc√®s √† AWS est compromis, car ils seront lisibles √† partir des configurations des lambdas.

#### **Strat√©gies d'att√©nuation**

*   **Variables d'Environnement :** Injectez des secrets √† l'ex√©cution sans les coder en dur.

```yaml
provider:
environment:
DB_PASSWORD: ${ssm:/aws/reference/secretsmanager/my-db-password~true}
```
* **Int√©gration du Gestionnaire de Secrets :** Utilisez des services comme **AWS Secrets Manager**, **Azure Key Vault**, ou **HashiCorp Vault**.
* **Variables Chiffr√©es :** Profitez des fonctionnalit√©s de chiffrement du Framework Serverless pour les donn√©es sensibles.
* **Contr√¥les d'Acc√®s :** Restreignez l'acc√®s aux secrets en fonction des r√¥les.
* **√âvitez de Journaliser les Secrets :** Assurez-vous que les secrets ne sont pas expos√©s dans les journaux ou les messages d'erreur.

***

### **Code et D√©pendances Vuln√©rables**

Des d√©pendances obsol√®tes ou non s√©curis√©es peuvent introduire des vuln√©rabilit√©s, tandis qu'un traitement incorrect des entr√©es peut entra√Æner des attaques par injection de code.

#### **Strat√©gies d'att√©nuation**

*   **Gestion des D√©pendances :** Mettez r√©guli√®rement √† jour les d√©pendances et scannez les vuln√©rabilit√©s.

```yaml
plugins:
- serverless-webpack
- serverless-plugin-snyk
```
* **Validation des Entr√©es :** Impl√©mentez une validation stricte et une d√©sinfection de toutes les entr√©es.
* **Revue de Code :** Effectuez des revues approfondies pour identifier les failles de s√©curit√©.
* **Analyse Statique :** Utilisez des outils pour d√©tecter les vuln√©rabilit√©s dans le code.

***

### **Journalisation et Surveillance Inad√©quates**

Sans une journalisation et une surveillance appropri√©es, les activit√©s malveillantes peuvent passer inaper√ßues, retardant la r√©ponse aux incidents.

#### **Strat√©gies d'att√©nuation**

*   **Journalisation Centralis√©e :** Agr√©gez les journaux en utilisant des services comme **AWS CloudWatch** ou **Datadog**.

```yaml
plugins:
- serverless-plugin-datadog
```
* **Activez la Journalisation D√©tail√©e :** Capturez des informations essentielles sans exposer de donn√©es sensibles.
* **Configurez des Alertes :** Configurez des alertes pour des activit√©s ou des anomalies suspectes.
* **Surveillance R√©guli√®re :** Surveillez en continu les journaux et les m√©triques pour des incidents de s√©curit√© potentiels.

***

### **Configurations de l'API Gateway Insecure**

Des API ouvertes ou mal s√©curis√©es peuvent √™tre exploit√©es pour un acc√®s non autoris√©, des attaques par d√©ni de service (DoS) ou des attaques intersites.

#### **Strat√©gies d'att√©nuation**

*   **Authentification et Autorisation :** Impl√©mentez des m√©canismes robustes comme OAuth, cl√©s API, ou JWT.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
authorizer: aws_iam
```
*   **Limitation de Taux et Throttling :** Pr√©venez les abus en limitant les taux de requ√™tes.

```yaml
provider:
apiGateway:
throttle:
burstLimit: 200
rateLimit: 100
```
*   **Configuration CORS S√©curis√©e :** Restreignez les origines, m√©thodes et en-t√™tes autoris√©s.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
cors:
origin: https://yourdomain.com
headers:
- Content-Type
```
* **Utilisez des Pare-feux d'Applications Web (WAF) :** Filtrez et surveillez les requ√™tes HTTP pour des motifs malveillants.

***

### **Isolation de Fonction Insuffisante**

Des ressources partag√©es et une isolation inad√©quate peuvent entra√Æner des √©l√©vations de privil√®ges ou des interactions non intentionnelles entre les fonctions.

#### **Strat√©gies d'att√©nuation**

* **Isoler les Fonctions :** Attribuez des ressources distinctes et des r√¥les IAM pour garantir un fonctionnement ind√©pendant.
* **Partitionnement des Ressources :** Utilisez des bases de donn√©es ou des seaux de stockage s√©par√©s pour diff√©rentes fonctions.
*   **Utilisez des VPC :** D√©ployez des fonctions au sein de Clouds Priv√©s Virtuels pour une isolation r√©seau am√©lior√©e.

```yaml
provider:
vpc:
securityGroupIds:
- sg-xxxxxxxx
subnetIds:
- subnet-xxxxxx
```
* **Limitez les Permissions des Fonctions :** Assurez-vous que les fonctions ne peuvent pas acc√©der ou interf√©rer avec les ressources des autres, sauf si cela est explicitement requis.

***

### **Protection des Donn√©es Inad√©quate**

Des donn√©es non chiffr√©es au repos ou en transit peuvent √™tre expos√©es, entra√Ænant des violations de donn√©es ou des falsifications.

#### **Strat√©gies d'att√©nuation**

*   **Chiffrez les Donn√©es au Repos :** Utilisez les fonctionnalit√©s de chiffrement des services cloud.

```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
SSESpecification:
SSEEnabled: true
```
* **Chiffrez les Donn√©es en Transit :** Utilisez HTTPS/TLS pour toutes les transmissions de donn√©es.
* **S√©curisez la Communication API :** Appliquez des protocoles de chiffrement et validez les certificats.
* **G√©rez les Cl√©s de Chiffrement de Mani√®re S√©curis√©e :** Utilisez des services de cl√©s g√©r√©s et faites tourner les cl√©s r√©guli√®rement.

***

### **Manque de Gestion d'Erreur Appropri√©e**

Des messages d'erreur d√©taill√©s peuvent exposer des informations sensibles sur l'infrastructure ou le code, tandis que des exceptions non g√©r√©es peuvent entra√Æner des plantages d'application.

#### **Strat√©gies d'att√©nuation**

*   **Messages d'Erreur G√©n√©raux :** √âvitez d'exposer des d√©tails internes dans les r√©ponses d'erreur.

```javascript
javascriptCopy code// Exemple en Node.js
exports.hello = async (event) => {
try {
// Logique de la fonction
} catch (error) {
console.error(error);
return {
statusCode: 500,
body: JSON.stringify({ message: 'Erreur Interne du Serveur' }),
};
}
};
```
* **Gestion Centralis√©e des Erreurs :** G√©rez et d√©sinfectez les erreurs de mani√®re coh√©rente √† travers toutes les fonctions.
* **Surveillez et Journalisez les Erreurs :** Suivez et analysez les erreurs en interne sans exposer les d√©tails aux utilisateurs finaux.

***

### **Pratiques de D√©ploiement Insecure**

Des configurations de d√©ploiement expos√©es ou un acc√®s non autoris√© aux pipelines CI/CD peuvent entra√Æner des d√©ploiements de code malveillant ou des erreurs de configuration.

#### **Strat√©gies d'att√©nuation**

* **S√©curisez les Pipelines CI/CD :** Mettez en ≈ìuvre des contr√¥les d'acc√®s stricts, une authentification multi-facteurs (MFA) et des audits r√©guliers.
* **Stockez la Configuration de Mani√®re S√©curis√©e :** Gardez les fichiers de d√©ploiement exempts de secrets cod√©s en dur et de donn√©es sensibles.
* **Utilisez des Outils de S√©curit√© pour l'Infrastructure en tant que Code (IaC) :** Employez des outils comme **Checkov** ou **Terraform Sentinel** pour appliquer des politiques de s√©curit√©.
* **D√©ploiements Immutables :** Emp√™chez les modifications non autoris√©es apr√®s le d√©ploiement en adoptant des pratiques d'infrastructure immuable.

***

### **Vuln√©rabilit√©s dans les Plugins et Extensions**

L'utilisation de plugins tiers non v√©rifi√©s ou malveillants peut introduire des vuln√©rabilit√©s dans vos applications serverless.

#### **Strat√©gies d'att√©nuation**

* **V√©rifiez les Plugins en Profondeur :** √âvaluez la s√©curit√© des plugins avant l'int√©gration, en privil√©giant ceux provenant de sources r√©put√©es.
* **Limitez l'Utilisation des Plugins :** Utilisez uniquement les plugins n√©cessaires pour minimiser la surface d'attaque.
* **Surveillez les Mises √† Jour des Plugins :** Gardez les plugins √† jour pour b√©n√©ficier des correctifs de s√©curit√©.
* **Isolez les Environnements de Plugins :** Ex√©cutez les plugins dans des environnements isol√©s pour contenir d'√©ventuels compromis.

***

### **Exposition de Points de Terminaison Sensibles**

Des fonctions accessibles publiquement ou des API non restreintes peuvent √™tre exploit√©es pour des op√©rations non autoris√©es.

#### **Strat√©gies d'att√©nuation**

* **Restreignez l'Acc√®s aux Fonctions :** Utilisez des VPC, des groupes de s√©curit√© et des r√®gles de pare-feu pour limiter l'acc√®s aux sources de confiance.
* **Impl√©mentez une Authentification Robuste :** Assurez-vous que tous les points de terminaison expos√©s n√©cessitent une authentification et une autorisation appropri√©es.
* **Utilisez les API Gateways de Mani√®re S√©curis√©e :** Configurez les API Gateways pour appliquer des politiques de s√©curit√©, y compris la validation des entr√©es et la limitation de taux.
* **D√©sactivez les Points de Terminaison Inutilis√©s :** Passez r√©guli√®rement en revue et d√©sactivez tout point de terminaison qui n'est plus utilis√©.

***

### **Permissions Excessives pour les Membres de l'√âquipe et les Collaborateurs Externes**

Accorder des permissions excessives aux membres de l'√©quipe et aux collaborateurs externes peut entra√Æner un acc√®s non autoris√©, des violations de donn√©es et un usage abusif des ressources. Ce risque est accru dans les environnements o√π plusieurs individus ont des niveaux d'acc√®s vari√©s, augmentant la surface d'attaque et le potentiel de menaces internes.

#### **Strat√©gies d'att√©nuation**

* **Principe du Moindre Privil√®ge :** Assurez-vous que les membres de l'√©quipe et les collaborateurs n'ont que les permissions n√©cessaires pour effectuer leurs t√¢ches.

***

### **S√©curit√© des Cl√©s d'Acc√®s et des Cl√©s de Licence**

**Cl√©s d'Acc√®s** et **Cl√©s de Licence** sont des identifiants critiques utilis√©s pour authentifier et autoriser les interactions avec le CLI de Serverless Framework.

* **Cl√©s de Licence :** Ce sont des identifiants uniques requis pour authentifier l'acc√®s √† Serverless Framework Version 4 qui permet de se connecter via CLI.
* **Cl√©s d'Acc√®s :** Identifiants qui permettent au CLI de Serverless Framework de s'authentifier avec le Dashboard de Serverless Framework. Lors de la connexion avec le CLI `serverless`, une cl√© d'acc√®s sera **g√©n√©r√©e et stock√©e sur l'ordinateur portable**. Vous pouvez √©galement la d√©finir comme une variable d'environnement nomm√©e `SERVERLESS_ACCESS_KEY`.

#### **Risques de S√©curit√©**

1. **Exposition par le biais de D√©p√¥ts de Code :**
* Coder en dur ou commettre accidentellement des Cl√©s d'Acc√®s et des Cl√©s de Licence dans des syst√®mes de contr√¥le de version peut entra√Æner un acc√®s non autoris√©.
2. **Stockage Insecure :**
* Stocker des cl√©s en texte clair dans des variables d'environnement ou des fichiers de configuration sans chiffrement appropri√© augmente la probabilit√© de fuite.
3. **Distribution Inappropri√©e :**
* Partager des cl√©s par des canaux non s√©curis√©s (par exemple, email, chat) peut entra√Æner une interception par des acteurs malveillants.
4. **Manque de Rotation :**
* Ne pas faire tourner r√©guli√®rement les cl√©s prolonge la p√©riode d'exposition si les cl√©s sont compromises.
5. **Permissions Excessives :**
* Des cl√©s avec des permissions larges peuvent √™tre exploit√©es pour effectuer des actions non autoris√©es sur plusieurs ressources.

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Formation AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Formation GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
