# Serverless.com Sicherheit

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## Grundinformationen

### Organisation

Eine **Organisation** ist die h√∂chste Ebene innerhalb des Serverless Framework-√ñkosystems. Sie repr√§sentiert eine **kollektive Gruppe**, wie ein Unternehmen, eine Abteilung oder eine gro√üe Einheit, die mehrere Projekte, Teams und Anwendungen umfasst.

### Team

Das **Team** sind die Benutzer mit Zugang innerhalb der Organisation. Teams helfen dabei, Mitglieder basierend auf Rollen zu organisieren. **`Mitarbeiter`** k√∂nnen bestehende Apps anzeigen und bereitstellen, w√§hrend **`Administratoren`** neue Apps erstellen und die Einstellungen der Organisation verwalten k√∂nnen.

### Anwendung

Eine **App** ist eine logische Gruppierung verwandter Dienste innerhalb einer Organisation. Sie repr√§sentiert eine vollst√§ndige Anwendung, die aus mehreren serverlosen Diensten besteht, die zusammenarbeiten, um eine koh√§rente Funktionalit√§t bereitzustellen.

### **Dienste**

Ein **Dienst** ist die zentrale Komponente einer serverlosen Anwendung. Er repr√§sentiert dein gesamtes serverloses Projekt und kapselt alle Funktionen, Konfigurationen und Ressourcen, die ben√∂tigt werden. Er wird typischerweise in einer `serverless.yml`-Datei definiert, ein Dienst umfasst Metadaten wie den Dienstnamen, Anbieter-Konfigurationen, Funktionen, Ereignisse, Ressourcen, Plugins und benutzerdefinierte Variablen.
```yaml
service: my-service
provider:
name: aws
runtime: nodejs14.x
functions:
hello:
handler: handler.hello
```
<details>

<summary>Funktion</summary>

Eine **Funktion** stellt eine einzelne serverlose Funktion dar, wie z.B. eine AWS Lambda-Funktion. Sie enth√§lt den Code, der als Reaktion auf Ereignisse ausgef√ºhrt wird.

Sie ist im Abschnitt `functions` in `serverless.yml` definiert und gibt den Handler, die Laufzeit, Ereignisse, Umgebungsvariablen und andere Einstellungen an.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
```
</details>

<details>

<summary>Event</summary>

**Ereignisse** sind Ausl√∂ser, die Ihre serverlosen Funktionen aufrufen. Sie definieren, wie und wann eine Funktion ausgef√ºhrt werden soll.

Zu den h√§ufigsten Ereignistypen geh√∂ren HTTP-Anfragen, geplante Ereignisse (Cron-Jobs), Datenbankereignisse, Datei-Uploads und mehr.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
- schedule:
rate: rate(10 minutes)
```
</details>

<details>

<summary>Ressource</summary>

**Ressourcen** erm√∂glichen es Ihnen, zus√§tzliche Cloud-Ressourcen zu definieren, von denen Ihr Dienst abh√§ngt, wie Datenbanken, Speicher-Buckets oder IAM-Rollen.

Sie werden im Abschnitt `resources` angegeben, oft unter Verwendung der CloudFormation-Syntax f√ºr AWS.
```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
TableName: my-table
AttributeDefinitions:
- AttributeName: id
AttributeType: S
KeySchema:
- AttributeName: id
KeyType: HASH
ProvisionedThroughput:
ReadCapacityUnits: 1
WriteCapacityUnits: 1
```
</details>

<details>

<summary>Provider</summary>

Das **Provider**-Objekt gibt den Cloud-Dienstanbieter (z. B. AWS, Azure, Google Cloud) an und enth√§lt Konfigurationseinstellungen, die f√ºr diesen Anbieter relevant sind.

Es enth√§lt Details wie die Laufzeit, Region, Stage und Anmeldeinformationen.
```yaml
yamlCopy codeprovider:
name: aws
runtime: nodejs14.x
region: us-east-1
stage: dev
```
</details>

<details>

<summary>B√ºhne und Region</summary>

Die B√ºhne repr√§sentiert verschiedene Umgebungen (z. B. Entwicklung, Staging, Produktion), in denen Ihr Dienst bereitgestellt werden kann. Sie erm√∂glicht umgebungsspezifische Konfigurationen und Bereitstellungen.
```yaml
provider:
stage: dev
```
Die Region gibt die geografische Region an, in der Ihre Ressourcen bereitgestellt werden. Sie ist wichtig f√ºr Latenz, Compliance und Verf√ºgbarkeits√ºberlegungen.
```yaml
provider:
region: us-west-2
```
</details>

<details>

<summary>Plugins</summary>

**Plugins** erweitern die Funktionalit√§t des Serverless Framework, indem sie neue Funktionen hinzuf√ºgen oder mit anderen Tools und Diensten integriert werden. Sie sind im Abschnitt `plugins` definiert und werden √ºber npm installiert.
```yaml
plugins:
- serverless-offline
- serverless-webpack
```
</details>

<details>

<summary>Schichten</summary>

**Schichten** erm√∂glichen es Ihnen, gemeinsam genutzten Code oder Abh√§ngigkeiten separat von Ihren Funktionen zu verpacken und zu verwalten. Dies f√∂rdert die Wiederverwendbarkeit und reduziert die Gr√∂√üen der Bereitstellungspakete. Sie werden im Abschnitt `layers` definiert und von Funktionen referenziert.
```yaml
layers:
commonLibs:
path: layer-common
functions:
hello:
handler: handler.hello
layers:
- { Ref: CommonLibsLambdaLayer }
```
</details>

<details>

<summary>Variablen und benutzerdefinierte Variablen</summary>

**Variablen** erm√∂glichen eine dynamische Konfiguration, indem sie die Verwendung von Platzhaltern erlauben, die zur Deploy-Zeit aufgel√∂st werden.

*   **Syntax:** `${variable}`-Syntax kann auf Umgebungsvariablen, Dateiinhalte oder andere Konfigurationsparameter verweisen.

```yaml
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```

-   **Benutzerdefinierte Variablen:** Der `custom`-Abschnitt wird verwendet, um benutzerspezifische Variablen und Konfigurationen zu definieren, die im gesamten `serverless.yml` wiederverwendet werden k√∂nnen.

```yaml
custom:
tableName: my-dynamodb-table
stage: ${opt:stage, 'dev'}
```

</details>

<details>

<summary>Ausgaben</summary>

**Ausgaben** definieren die Werte, die nach der Bereitstellung eines Dienstes zur√ºckgegeben werden, wie z.B. Ressourcen-ARNs, Endpunkte oder andere n√ºtzliche Informationen. Sie werden im Abschnitt `outputs` angegeben und h√§ufig verwendet, um Informationen an andere Dienste weiterzugeben oder den einfachen Zugriff nach der Bereitstellung zu erm√∂glichen.
```yaml
¬°outputs:
ApiEndpoint:
Description: "API Gateway endpoint URL"
Value:
Fn::Join:
- ""
- - "https://"
- Ref: ApiGatewayRestApi
- ".execute-api."
- Ref: AWS::Region
- ".amazonaws.com/"
- Ref: AWS::Stage
```
</details>

<details>

<summary>IAM-Rollen und Berechtigungen</summary>

**IAM-Rollen und Berechtigungen** definieren die Sicherheitsanmeldeinformationen und Zugriffsrechte f√ºr Ihre Funktionen und andere Ressourcen. Sie werden unter den `provider`- oder den Einstellungen der einzelnen Funktionen verwaltet, um die erforderlichen Berechtigungen festzulegen.
```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
</details>

<details>

<summary>Umgebungsvariablen</summary>

**Variablen** erm√∂glichen es Ihnen, Konfigurationseinstellungen und Geheimnisse an Ihre Funktionen zu √ºbergeben, ohne sie hart zu codieren. Sie werden im Abschnitt `environment` f√ºr entweder den Anbieter oder einzelne Funktionen definiert.
```yaml
provider:
environment:
STAGE: ${self:provider.stage}
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```
</details>

<details>

<summary>Abh√§ngigkeiten</summary>

**Abh√§ngigkeiten** verwalten die externen Bibliotheken und Module, die Ihre Funktionen ben√∂tigen. Sie werden typischerweise √ºber Paketmanager wie npm oder pip verwaltet und mit Ihrem Bereitstellungspaket unter Verwendung von Tools oder Plugins wie `serverless-webpack` geb√ºndelt.
```yaml
plugins:
- serverless-webpack
```
</details>

<details>

<summary>Hooks</summary>

**Hooks** erm√∂glichen es Ihnen, benutzerdefinierte Skripte oder Befehle zu bestimmten Zeitpunkten im Bereitstellungslebenszyklus auszuf√ºhren. Sie werden mithilfe von Plugins oder innerhalb der `serverless.yml` definiert, um Aktionen vor oder nach Bereitstellungen auszuf√ºhren.
```yaml
custom:
hooks:
before:deploy:deploy: echo "Starting deployment..."
```
</details>

### Tutorial

Dies ist eine Zusammenfassung des offiziellen Tutorials [**aus den Dokumenten**](https://www.serverless.com/framework/docs/tutorial):

1. Erstellen Sie ein AWS-Konto (Serverless.com startet in der AWS-Infrastruktur)
2. Erstellen Sie ein Konto bei serverless.com
3. Erstellen Sie eine App:
```bash
# Create temp folder for the tutorial
mkdir /tmp/serverless-tutorial
cd /tmp/serverless-tutorial

# Install Serverless cli
npm install -g serverless

# Generate template
serverless #Choose first one (AWS / Node.js / HTTP API)
## Indicate a name like "Tutorial"
## Login/Register
## Create A New App
## Indicate a name like "tutorialapp)
```
Dies sollte eine **App** namens `tutorialapp` erstellt haben, die Sie in [serverless.com](serverless.com-security.md) √ºberpr√ºfen k√∂nnen, sowie einen Ordner namens `Tutorial` mit der Datei **`handler.js`**, die einige JS-Code mit einem `helloworld`-Code enth√§lt, und die Datei **`serverless.yml`**, die diese Funktion deklariert:

{% tabs %}
{% tab title="handler.js" %}
```javascript
exports.hello = async (event) => {
return {
statusCode: 200,
body: JSON.stringify({
message: "Go Serverless v4! Your function executed successfully!",
}),
};
};
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
```
{% endtab %}
{% endtabs %}

4. Erstellen Sie einen AWS-Anbieter, indem Sie im **Dashboard** zu `https://app.serverless.com/<org name>/settings/providers?providerId=new&provider=aws` gehen.
1. Um `serverless.com` Zugriff auf AWS zu gew√§hren, wird es aufgefordert, einen CloudFormation-Stack mit dieser Konfigurationsdatei auszuf√ºhren (zum Zeitpunkt dieses Schreibens): [https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml](https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml)
2. Diese Vorlage generiert eine Rolle mit dem Namen **`SFRole-<ID>`** mit **`arn:aws:iam::aws:policy/AdministratorAccess`** √ºber das Konto mit einer Vertrauensidentit√§t, die dem `Serverless.com` AWS-Konto den Zugriff auf die Rolle erm√∂glicht.

<details>

<summary>Yaml roleTemplate</summary>
```yaml
Description: This stack creates an IAM role that can be used by Serverless Framework for use in deployments.
Resources:
SFRole:
Type: AWS::IAM::Role
Properties:
AssumeRolePolicyDocument:
Version: '2012-10-17'
Statement:
- Effect: Allow
Principal:
AWS: arn:aws:iam::486128539022:root
Action:
- sts:AssumeRole
Condition:
StringEquals:
sts:ExternalId: !Sub 'ServerlessFramework-${OrgUid}'
Path: /
RoleName: !Ref RoleName
ManagedPolicyArns:
- arn:aws:iam::aws:policy/AdministratorAccess
ReporterFunction:
Type: Custom::ServerlessFrameworkReporter
Properties:
ServiceToken: 'arn:aws:lambda:us-east-1:486128539022:function:sp-providers-stack-reporter-custom-resource-prod-tmen2ec'
OrgUid: !Ref OrgUid
RoleArn: !GetAtt SFRole.Arn
Alias: !Ref Alias
Outputs:
SFRoleArn:
Description: 'ARN for the IAM Role used by Serverless Framework'
Value: !GetAtt SFRole.Arn
Parameters:
OrgUid:
Description: Serverless Framework Org Uid
Type: String
Alias:
Description: Serverless Framework Provider Alias
Type: String
RoleName:
Description: Serverless Framework Role Name
Type: String
```
</details>

<details>

<summary>Vertrauensbeziehung</summary>
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": "arn:aws:iam::486128539022:root"
},
"Action": "sts:AssumeRole",
"Condition": {
"StringEquals": {
"sts:ExternalId": "ServerlessFramework-7bf7ddef-e1bf-43eb-a111-4d43e0894ccb"
}
}
}
]
}
```
</details>

5. Das Tutorial fordert dazu auf, die Datei `createCustomer.js` zu erstellen, die im Grunde einen neuen API-Endpunkt erstellt, der von der neuen JS-Datei verarbeitet wird, und fordert dazu auf, die Datei `serverless.yml` zu √§ndern, um eine **neue DynamoDB-Tabelle** zu generieren, eine **Umgebungsvariable** zu definieren und die Rolle, die die generierten Lambdas verwenden wird.

{% tabs %}
{% tab title="createCustomer.js" %}
```javascript
'use strict'
const AWS = require('aws-sdk')
module.exports.createCustomer = async (event) => {
const body = JSON.parse(Buffer.from(event.body, 'base64').toString())
const dynamoDb = new AWS.DynamoDB.DocumentClient()
const putParams = {
TableName: process.env.DYNAMODB_CUSTOMER_TABLE,
Item: {
primary_key: body.name,
email: body.email,
},
}
await dynamoDb.put(putParams).promise()
return {
statusCode: 201,
}
}
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x
environment:
DYNAMODB_CUSTOMER_TABLE: ${self:service}-customerTable-${sls:stage}
iam:
role:
statements:
- Effect: 'Allow'
Action:
- 'dynamodb:PutItem'
- 'dynamodb:Get*'
- 'dynamodb:Scan*'
- 'dynamodb:UpdateItem'
- 'dynamodb:DeleteItem'
Resource: arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${self:service}-customerTable-${sls:stage}

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
createCustomer:
handler: createCustomer.createCustomer
events:
- httpApi:
path: /
method: post

resources:
Resources:
CustomerTable:
Type: AWS::DynamoDB::Table
Properties:
AttributeDefinitions:
- AttributeName: primary_key
AttributeType: S
BillingMode: PAY_PER_REQUEST
KeySchema:
- AttributeName: primary_key
KeyType: HASH
TableName: ${self:service}-customerTable-${sls:stage}
```
{% endtab %}
{% endtabs %}

6. Bereitstellen mit **`serverless deploy`**
1. Die Bereitstellung erfolgt √ºber einen CloudFormation-Stack
2. Beachten Sie, dass die **Lambdas √ºber das API-Gateway exponiert sind** und nicht √ºber direkte URLs
7. **Testen**
1. Der vorherige Schritt gibt die **URLs** aus, unter denen Ihre API-Endpunkt-Lambda-Funktionen bereitgestellt wurden

## Sicherheits√ºberpr√ºfung von Serverless.com

### **Fehlkonfigurierte IAM-Rollen und Berechtigungen**

√úberm√§√üig permissive IAM-Rollen k√∂nnen unbefugten Zugriff auf Cloud-Ressourcen gew√§hren, was zu Datenverletzungen oder Ressourcenmanipulation f√ºhren kann.

#### **Minderungsstrategien**

*   **Prinzip der geringsten Privilegien:** Weisen Sie jeder Funktion nur die notwendigen Berechtigungen zu.

```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
* **Verwenden Sie separate Rollen:** Unterscheiden Sie Rollen basierend auf den Anforderungen der Funktion.

***

### **Unsichere Geheimnisse und Konfigurationsmanagement**

Das Speichern sensibler Informationen (z. B. API-Schl√ºssel, Datenbankanmeldeinformationen) direkt in `serverless.yml` oder Code kann zu einer Offenlegung f√ºhren, wenn Repositories kompromittiert werden oder der Zugriff auf AWS gef√§hrdet ist, da sie aus den Lambda-Konfigurationen lesbar sind.

#### **Minderungsstrategien**

*   **Umgebungsvariablen:** Injizieren Sie Geheimnisse zur Laufzeit, ohne sie hart zu codieren.

```yaml
provider:
environment:
DB_PASSWORD: ${ssm:/aws/reference/secretsmanager/my-db-password~true}
```
* **Integration des Secrets Managers:** Verwenden Sie Dienste wie **AWS Secrets Manager**, **Azure Key Vault** oder **HashiCorp Vault**.
* **Verschl√ºsselte Variablen:** Nutzen Sie die Verschl√ºsselungsfunktionen des Serverless Frameworks f√ºr sensible Daten.
* **Zugriffskontrollen:** Beschr√§nken Sie den Zugriff auf Geheimnisse basierend auf Rollen.
* **Vermeiden Sie das Protokollieren von Geheimnissen:** Stellen Sie sicher, dass Geheimnisse nicht in Protokollen oder Fehlermeldungen exponiert werden.

***

### **Verwundbarer Code und Abh√§ngigkeiten**

Veraltete oder unsichere Abh√§ngigkeiten k√∂nnen Schwachstellen einf√ºhren, w√§hrend unsachgem√§√üe Eingabeverarbeitung zu Code-Injection-Angriffen f√ºhren kann.

#### **Minderungsstrategien**

*   **Abh√§ngigkeitsmanagement:** Aktualisieren Sie regelm√§√üig Abh√§ngigkeiten und scannen Sie auf Schwachstellen.

```yaml
plugins:
- serverless-webpack
- serverless-plugin-snyk
```
* **Eingangsvalidierung:** Implementieren Sie strenge Validierung und Sanit√§rung aller Eingaben.
* **Code-√úberpr√ºfungen:** F√ºhren Sie gr√ºndliche √úberpr√ºfungen durch, um Sicherheitsanf√§lligkeiten zu identifizieren.
* **Statische Analyse:** Verwenden Sie Tools, um Schwachstellen im Code zu erkennen.

***

### **Unzureichendes Protokollieren und √úberwachen**

Ohne angemessenes Protokollieren und √úberwachen k√∂nnen b√∂swillige Aktivit√§ten unentdeckt bleiben, was die Reaktion auf Vorf√§lle verz√∂gert.

#### **Minderungsstrategien**

*   **Zentralisiertes Protokollieren:** Aggregieren Sie Protokolle mit Diensten wie **AWS CloudWatch** oder **Datadog**.

```yaml
plugins:
- serverless-plugin-datadog
```
* **Aktivieren Sie detailliertes Protokollieren:** Erfassen Sie wesentliche Informationen, ohne sensible Daten offenzulegen.
* **Richten Sie Alarme ein:** Konfigurieren Sie Alarme f√ºr verd√§chtige Aktivit√§ten oder Anomalien.
* **Regelm√§√üige √úberwachung:** √úberwachen Sie kontinuierlich Protokolle und Metriken auf potenzielle Sicherheitsvorf√§lle.

***

### **Unsichere API-Gateway-Konfigurationen**

Offene oder unsachgem√§√ü gesicherte APIs k√∂nnen f√ºr unbefugten Zugriff, Denial-of-Service (DoS)-Angriffe oder Cross-Site-Angriffe ausgenutzt werden.

#### **Minderungsstrategien**

*   **Authentifizierung und Autorisierung:** Implementieren Sie robuste Mechanismen wie OAuth, API-Schl√ºssel oder JWT.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
authorizer: aws_iam
```
*   **Ratenbegrenzung und Drosselung:** Verhindern Sie Missbrauch, indem Sie die Anforderungsraten begrenzen.

```yaml
provider:
apiGateway:
throttle:
burstLimit: 200
rateLimit: 100
```
*   **Sichere CORS-Konfiguration:** Beschr√§nken Sie erlaubte Urspr√ºnge, Methoden und Header.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
cors:
origin: https://yourdomain.com
headers:
- Content-Type
```
* **Verwenden Sie Web Application Firewalls (WAF):** Filtern und √ºberwachen Sie HTTP-Anfragen auf b√∂sartige Muster.

***

### **Unzureichende Funktionsisolierung**

Geteilte Ressourcen und unzureichende Isolation k√∂nnen zu Privilegieneskalationen oder unbeabsichtigten Interaktionen zwischen Funktionen f√ºhren.

#### **Minderungsstrategien**

* **Funktionen isolieren:** Weisen Sie unterschiedliche Ressourcen und IAM-Rollen zu, um einen unabh√§ngigen Betrieb sicherzustellen.
* **Ressourcenteilung:** Verwenden Sie separate Datenbanken oder Speicherorte f√ºr verschiedene Funktionen.
*   **Verwenden Sie VPCs:** Stellen Sie Funktionen innerhalb von Virtual Private Clouds f√ºr verbesserte Netzisolierung bereit.

```yaml
provider:
vpc:
securityGroupIds:
- sg-xxxxxxxx
subnetIds:
- subnet-xxxxxx
```
* **Berechtigungen der Funktionen einschr√§nken:** Stellen Sie sicher, dass Funktionen nicht auf die Ressourcen anderer Funktionen zugreifen oder diese beeintr√§chtigen k√∂nnen, es sei denn, dies ist ausdr√ºcklich erforderlich.

***

### **Unzureichender Datenschutz**

Unverschl√ºsselte Daten im Ruhezustand oder w√§hrend der √úbertragung k√∂nnen exponiert werden, was zu Datenverletzungen oder Manipulation f√ºhren kann.

#### **Minderungsstrategien**

*   **Daten im Ruhezustand verschl√ºsseln:** Nutzen Sie die Verschl√ºsselungsfunktionen des Cloud-Dienstes.

```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
SSESpecification:
SSEEnabled: true
```
* **Daten w√§hrend der √úbertragung verschl√ºsseln:** Verwenden Sie HTTPS/TLS f√ºr alle Daten√ºbertragungen.
* **Sichere API-Kommunikation:** Erzwingen Sie Verschl√ºsselungsprotokolle und validieren Sie Zertifikate.
* **Verwalten Sie Verschl√ºsselungsschl√ºssel sicher:** Verwenden Sie verwaltete Schl√ºsseldienste und rotieren Sie Schl√ºssel regelm√§√üig.

***

### **Mangelnde ordnungsgem√§√üe Fehlerbehandlung**

Detaillierte Fehlermeldungen k√∂nnen sensible Informationen √ºber die Infrastruktur oder den Code offenlegen, w√§hrend nicht behandelte Ausnahmen zu Anwendungsabst√ºrzen f√ºhren k√∂nnen.

#### **Minderungsstrategien**

*   **Allgemeine Fehlermeldungen:** Vermeiden Sie die Offenlegung interner Details in Fehlermeldungen.

```javascript
javascriptCopy code// Beispiel in Node.js
exports.hello = async (event) => {
try {
// Funktionslogik
} catch (error) {
console.error(error);
return {
statusCode: 500,
body: JSON.stringify({ message: 'Interner Serverfehler' }),
};
}
};
```
* **Zentralisierte Fehlerbehandlung:** Verwalten und sanitieren Sie Fehler konsistent √ºber alle Funktionen hinweg.
* **√úberwachen und Protokollieren von Fehlern:** Verfolgen und analysieren Sie Fehler intern, ohne Details f√ºr Endbenutzer offenzulegen.

***

### **Unsichere Bereitstellungspraktiken**

Exponierte Bereitstellungskonfigurationen oder unbefugter Zugriff auf CI/CD-Pipelines k√∂nnen zu b√∂swilligen Codebereitstellungen oder Fehlkonfigurationen f√ºhren.

#### **Minderungsstrategien**

* **Sichere CI/CD-Pipelines:** Implementieren Sie strenge Zugriffskontrollen, Multi-Faktor-Authentifizierung (MFA) und regelm√§√üige Audits.
* **Konfiguration sicher speichern:** Halten Sie Bereitstellungsdateien frei von hartcodierten Geheimnissen und sensiblen Daten.
* **Verwenden Sie Sicherheitswerkzeuge f√ºr Infrastruktur als Code (IaC):** Setzen Sie Tools wie **Checkov** oder **Terraform Sentinel** ein, um Sicherheitsrichtlinien durchzusetzen.
* **Unver√§nderliche Bereitstellungen:** Verhindern Sie unbefugte √Ñnderungen nach der Bereitstellung, indem Sie Praktiken f√ºr unver√§nderliche Infrastruktur anwenden.

***

### **Schwachstellen in Plugins und Erweiterungen**

Die Verwendung von nicht gepr√ºften oder b√∂sartigen Drittanbieter-Plugins kann Schwachstellen in Ihren serverlosen Anwendungen einf√ºhren.

#### **Minderungsstrategien**

* **Plugins gr√ºndlich pr√ºfen:** Bewerten Sie die Sicherheit von Plugins vor der Integration und bevorzugen Sie solche aus seri√∂sen Quellen.
* **Verwendung von Plugins einschr√§nken:** Verwenden Sie nur notwendige Plugins, um die Angriffsfl√§che zu minimieren.
* **√úberwachen Sie Plugin-Updates:** Halten Sie Plugins auf dem neuesten Stand, um von Sicherheitsupdates zu profitieren.
* **Isolieren Sie Plugin-Umgebungen:** F√ºhren Sie Plugins in isolierten Umgebungen aus, um potenzielle Kompromisse einzud√§mmen.

***

### **Offenlegung sensibler Endpunkte**

√ñffentlich zug√§ngliche Funktionen oder uneingeschr√§nkte APIs k√∂nnen f√ºr unbefugte Operationen ausgenutzt werden.

#### **Minderungsstrategien**

* **Zugriff auf Funktionen einschr√§nken:** Verwenden Sie VPCs, Sicherheitsgruppen und Firewall-Regeln, um den Zugriff auf vertrauensw√ºrdige Quellen zu beschr√§nken.
* **Robuste Authentifizierung implementieren:** Stellen Sie sicher, dass alle exponierten Endpunkte eine ordnungsgem√§√üe Authentifizierung und Autorisierung erfordern.
* **API-Gateways sicher verwenden:** Konfigurieren Sie API-Gateways, um Sicherheitsrichtlinien durchzusetzen, einschlie√ülich Eingangsvalidierung und Ratenbegrenzung.
* **Deaktivieren Sie ungenutzte Endpunkte:** √úberpr√ºfen Sie regelm√§√üig und deaktivieren Sie alle Endpunkte, die nicht mehr verwendet werden.

***

### **√úberm√§√üige Berechtigungen f√ºr Teammitglieder und externe Mitarbeiter**

Das Gew√§hren √ºberm√§√üiger Berechtigungen an Teammitglieder und externe Mitarbeiter kann zu unbefugtem Zugriff, Datenverletzungen und Missbrauch von Ressourcen f√ºhren. Dieses Risiko ist in Umgebungen erh√∂ht, in denen mehrere Personen unterschiedliche Zugriffsrechte haben, was die Angriffsfl√§che und das Potenzial f√ºr Insider-Bedrohungen erh√∂ht.

#### **Minderungsstrategien**

* **Prinzip der geringsten Privilegien:** Stellen Sie sicher, dass Teammitglieder und Mitarbeiter nur die Berechtigungen haben, die erforderlich sind, um ihre Aufgaben auszuf√ºhren.

***

### **Sicherheit von Zugriffsschl√ºsseln und Lizenzschl√ºsseln**

**Zugriffsschl√ºssel** und **Lizenzschl√ºssel** sind kritische Anmeldeinformationen, die zur Authentifizierung und Autorisierung von Interaktionen mit der Serverless Framework CLI verwendet werden.

* **Lizenzschl√ºssel:** Sie sind eindeutige Identifikatoren, die f√ºr die Authentifizierung des Zugriffs auf die Serverless Framework Version 4 erforderlich sind, die eine Anmeldung √ºber die CLI erm√∂glicht.
* **Zugriffsschl√ºssel:** Anmeldeinformationen, die es der Serverless Framework CLI erm√∂glichen, sich beim Serverless Framework Dashboard zu authentifizieren. Bei der Anmeldung mit `serverless` cli wird ein Zugriffsschl√ºssel **generiert und auf dem Laptop gespeichert**. Sie k√∂nnen ihn auch als Umgebungsvariable mit dem Namen `SERVERLESS_ACCESS_KEY` festlegen.

#### **Sicherheitsrisiken**

1. **Offenlegung durch Code-Repositories:**
* Das Hartcodieren oder versehentliche Committen von Zugriffsschl√ºsseln und Lizenzschl√ºsseln in Versionskontrollsysteme kann zu unbefugtem Zugriff f√ºhren.
2. **Unsichere Speicherung:**
* Das Speichern von Schl√ºsseln im Klartext innerhalb von Umgebungsvariablen oder Konfigurationsdateien ohne angemessene Verschl√ºsselung erh√∂ht die Wahrscheinlichkeit einer Offenlegung.
3. **Unsachgem√§√üe Verteilung:**
* Das Teilen von Schl√ºsseln √ºber unsichere Kan√§le (z. B. E-Mail, Chat) kann zu einer Abfangung durch b√∂swillige Akteure f√ºhren.
4. **Mangelnde Rotation:**
* Das regelm√§√üige Rotieren von Schl√ºsseln verl√§ngert die Expositionszeit, wenn Schl√ºssel kompromittiert werden.
5. **√úberm√§√üige Berechtigungen:**
* Schl√ºssel mit breiten Berechtigungen k√∂nnen ausgenutzt werden, um unbefugte Aktionen √ºber mehrere Ressourcen hinweg durchzuf√ºhren.

{% hint style="success" %}
Lernen & √ºben Sie AWS-Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP-Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichen.

</details>
{% endhint %}
