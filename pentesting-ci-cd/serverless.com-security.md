# Serverless.com Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Osnovne informacije

### Organizacija

**Organizacija** je entitet najvi≈°eg nivoa unutar Serverless Framework ekosistema. Predstavlja **kolektivnu grupu**, kao ≈°to su kompanija, odeljenje ili bilo koji veliki entitet, koji obuhvata vi≈°e projekata, timova i aplikacija.

### Tim

**Tim** su korisnici sa pristupom unutar organizacije. Timovi poma≈æu u organizovanju ƒçlanova na osnovu uloga. **`Saradnici`** mogu da pregledaju i implementiraju postojeƒáe aplikacije, dok **`Administratori`** mogu da kreiraju nove aplikacije i upravljaju pode≈°avanjima organizacije.

### Aplikacija

**Aplikacija** je logiƒçko grupisanje povezanih usluga unutar organizacije. Predstavlja kompletnu aplikaciju sastavljenu od vi≈°e serverless usluga koje rade zajedno kako bi pru≈æile koherentnu funkcionalnost.

### **Usluge**

**Usluga** je osnovna komponenta serverless aplikacije. Predstavlja ceo va≈° serverless projekat, obuhvatajuƒái sve funkcije, konfiguracije i resurse koji su potrebni. Obiƒçno je definisana u `serverless.yml` datoteci, usluga ukljuƒçuje metapodatke kao ≈°to su naziv usluge, konfiguracije provajdera, funkcije, dogaƒëaje, resurse, dodatke i prilagoƒëene varijable.
```yaml
service: my-service
provider:
name: aws
runtime: nodejs14.x
functions:
hello:
handler: handler.hello
```
<details>

<summary>Funkcija</summary>

A **Funkcija** predstavlja jednu serverless funkciju, kao ≈°to je AWS Lambda funkcija. Sadr≈æi kod koji se izvr≈°ava kao odgovor na dogaƒëaje.

Definira se u odeljku `functions` u `serverless.yml`, specificirajuƒái handler, runtime, dogaƒëaje, promenljive okru≈æenja i druge postavke.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
```
</details>

<details>

<summary>–î–æ–≥–∞—í–∞—ò</summary>

**–î–æ–≥–∞—í–∞—ò–∏** —Å—É —Ç—Ä–∏–≥–µ—Ä–∏ –∫–æ—ò–∏ –∞–∫—Ç–∏–≤–∏—Ä–∞—ò—É –≤–∞—à–µ —Å–µ—Ä–≤–µ—Ä–ª–µ—Å—Å —Ñ—É–Ω–∫—Ü–∏—ò–µ. –û–Ω–∏ –¥–µ—Ñ–∏–Ω–∏—à—É –∫–∞–∫–æ –∏ –∫–∞–¥–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ —Ç—Ä–µ–±–∞ –¥–∞ —Å–µ –∏–∑–≤—Ä—à–∏.

–£–æ–±–∏—á–∞—ò–µ–Ω–∏ —Ç–∏–ø–æ–≤–∏ –¥–æ–≥–∞—í–∞—ò–∞ —É–∫—ô—É—á—É—ò—É HTTP –∑–∞—Ö—Ç–µ–≤–µ, –∑–∞–∫–∞–∑–∞–Ω–µ –¥–æ–≥–∞—í–∞—ò–µ (cron –ø–æ—Å–ª–æ–≤–∏), –¥–æ–≥–∞—í–∞—ò–µ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞, —É—á–∏—Ç–∞–≤–∞—ö–µ –¥–∞—Ç–æ—Ç–µ–∫–∞ –∏ —ò–æ—à –º–Ω–æ–≥–æ —Ç–æ–≥–∞.
```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
- schedule:
rate: rate(10 minutes)
```
</details>

<details>

<summary>Resursi</summary>

**Resursi** vam omoguƒáavaju da defini≈°ete dodatne cloud resurse na kojima va≈°a usluga zavisi, kao ≈°to su baze podataka, skladi≈°ni bucket-i ili IAM uloge.

Oni se defini≈°u u `resources` sekciji, ƒçesto koristeƒái CloudFormation sintaksu za AWS.
```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
TableName: my-table
AttributeDefinitions:
- AttributeName: id
AttributeType: S
KeySchema:
- AttributeName: id
KeyType: HASH
ProvisionedThroughput:
ReadCapacityUnits: 1
WriteCapacityUnits: 1
```
</details>

<details>

<summary>Provajder</summary>

Objekat **Provajder** specificira provajdera cloud usluga (npr., AWS, Azure, Google Cloud) i sadr≈æi konfiguracione postavke relevantne za tog provajdera.

Ukljuƒçuje detalje kao ≈°to su runtime, region, stage i kredencijali.
```yaml
yamlCopy codeprovider:
name: aws
runtime: nodejs14.x
region: us-east-1
stage: dev
```
</details>

<details>

<summary>Faza i Region</summary>

Faza predstavlja razliƒçite okru≈æenja (npr., razvoj, testiranje, proizvodnja) gde va≈°a usluga mo≈æe biti postavljena. Omoguƒáava konfiguracije i postavke specifiƒçne za okru≈æenje.
```yaml
provider:
stage: dev
```
Region defini≈°e geografsku oblast u kojoj ƒáe va≈°i resursi biti postavljeni. To je va≈æno za latenciju, usklaƒëenost i dostupnost.
```yaml
provider:
region: us-west-2
```
</details>

<details>

<summary>Plugins</summary>

**Plugins** pro≈°iruju funkcionalnost Serverless Framework-a dodavanjem novih funkcija ili integracijom sa drugim alatima i uslugama. Definisani su u `plugins` sekciji i instaliraju se putem npm-a.
```yaml
plugins:
- serverless-offline
- serverless-webpack
```
</details>

<details>

<summary>Layers</summary>

**Layers** omoguƒáavaju vam da pakujete i upravljate deljenim kodom ili zavisnostima odvojeno od va≈°ih funkcija. Ovo promovi≈°e ponovnu upotrebu i smanjuje veliƒçine paketa za implementaciju. Defini≈°u se u `layers` sekciji i pozivaju ih funkcije.
```yaml
layers:
commonLibs:
path: layer-common
functions:
hello:
handler: handler.hello
layers:
- { Ref: CommonLibsLambdaLayer }
```
</details>

<details>

<summary>Promenljive i Prilagoƒëene Promenljive</summary>

**Promenljive** omoguƒáavaju dinamiƒçku konfiguraciju omoguƒáavajuƒái kori≈°ƒáenje mesta za zamenu koja se re≈°avaju u vreme implementacije.

*   **Sintaksa:** `${variable}` sintaksa mo≈æe referencirati promenljive okru≈æenja, sadr≈æaj datoteka ili druge konfiguracione parametre.

```yaml
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```

-   **Prilagoƒëene Promenljive:** `custom` sekcija se koristi za definisanje korisniƒçkih promenljivih i konfiguracija koje se mogu ponovo koristiti kroz `serverless.yml`.

```yaml
custom:
tableName: my-dynamodb-table
stage: ${opt:stage, 'dev'}
```

</details>

<details>

<summary>Izlazi</summary>

**Izlazi** defini≈°u vrednosti koje se vraƒáaju nakon ≈°to je usluga implementirana, kao ≈°to su ARNs resursa, krajnje taƒçke ili druge korisne informacije. Oni se specificiraju pod `outputs` sekcijom i ƒçesto se koriste za izlaganje informacija drugim uslugama ili za lak pristup nakon implementacije.
```yaml
¬°outputs:
ApiEndpoint:
Description: "API Gateway endpoint URL"
Value:
Fn::Join:
- ""
- - "https://"
- Ref: ApiGatewayRestApi
- ".execute-api."
- Ref: AWS::Region
- ".amazonaws.com/"
- Ref: AWS::Stage
```
</details>

<details>

<summary>IAM Uloge i Dozvole</summary>

**IAM Uloge i Dozvole** defini≈°u bezbednosne akreditive i prava pristupa za va≈°e funkcije i druge resurse. Upravljaju se pod `provider` ili pode≈°avanjima pojedinaƒçnih funkcija kako bi se odredile potrebne dozvole.
```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
</details>

<details>

<summary>Promenljive okru≈æenja</summary>

**Promenljive** vam omoguƒáavaju da prosledite pode≈°avanja konfiguracije i tajne va≈°im funkcijama bez njihovog hardkodiranja. Definisane su u `environment` sekciji za provajdera ili pojedinaƒçne funkcije.
```yaml
provider:
environment:
STAGE: ${self:provider.stage}
functions:
hello:
handler: handler.hello
environment:
TABLE_NAME: ${self:custom.tableName}
```
</details>

<details>

<summary>Zavisnosti</summary>

**Zavisnosti** upravljaju spoljnim bibliotekama i modulima koje va≈°e funkcije zahtevaju. Obiƒçno se upravlja putem menad≈æera paketa kao ≈°to su npm ili pip, i paketu za implementaciju se dodaju koristeƒái alate ili dodatke kao ≈°to je `serverless-webpack`.
```yaml
plugins:
- serverless-webpack
```
</details>

<details>

<summary>Hooks</summary>

**Hooks** omoguƒáavaju da pokrenete prilagoƒëene skripte ili komande u odreƒëenim taƒçkama u ≈æivotnom ciklusu implementacije. Defini≈°u se kori≈°ƒáenjem dodataka ili unutar `serverless.yml` da bi se izvr≈°ile radnje pre ili posle implementacija.
```yaml
custom:
hooks:
before:deploy:deploy: echo "Starting deployment..."
```
</details>

### Tutorial

Ovo je sa≈æetak zvaniƒçnog tutorijala [**iz dokumentacije**](https://www.serverless.com/framework/docs/tutorial):

1. Kreirajte AWS nalog (Serverless.com poƒçinje u AWS infrastrukturi)
2. Kreirajte nalog na serverless.com
3. Kreirajte aplikaciju:
```bash
# Create temp folder for the tutorial
mkdir /tmp/serverless-tutorial
cd /tmp/serverless-tutorial

# Install Serverless cli
npm install -g serverless

# Generate template
serverless #Choose first one (AWS / Node.js / HTTP API)
## Indicate a name like "Tutorial"
## Login/Register
## Create A New App
## Indicate a name like "tutorialapp)
```
Ovo bi trebalo da je kreiralo **aplikaciju** pod nazivom `tutorialapp` koju mo≈æete proveriti na [serverless.com](serverless.com-security.md) i folder pod nazivom `Tutorial` sa datotekom **`handler.js`** koja sadr≈æi neki JS kod sa `helloworld` kodom i datotekom **`serverless.yml`** koja deklarira tu funkciju:

{% tabs %}
{% tab title="handler.js" %}
```javascript
exports.hello = async (event) => {
return {
statusCode: 200,
body: JSON.stringify({
message: "Go Serverless v4! Your function executed successfully!",
}),
};
};
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
```
{% endtab %}
{% endtabs %}

4. Kreirajte AWS provajder, odlaskom na **dashboard** na `https://app.serverless.com/<org name>/settings/providers?providerId=new&provider=aws`.
1. Da bi se `serverless.com` omoguƒáio pristup AWS-u, biƒáe zatra≈æeno da se pokrene cloudformation stack koristeƒái ovu konfiguracionu datoteku (u vreme pisanja ovog teksta): [https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml](https://serverless-framework-template.s3.amazonaws.com/roleTemplate.yml)
2. Ova ≈°ablon generi≈°e ulogu pod nazivom **`SFRole-<ID>`** sa **`arn:aws:iam::aws:policy/AdministratorAccess`** nad nalogom sa Trust Identity koja omoguƒáava `Serverless.com` AWS nalogu pristup toj ulozi.

<details>

<summary>Yaml roleTemplate</summary>
```yaml
Description: This stack creates an IAM role that can be used by Serverless Framework for use in deployments.
Resources:
SFRole:
Type: AWS::IAM::Role
Properties:
AssumeRolePolicyDocument:
Version: '2012-10-17'
Statement:
- Effect: Allow
Principal:
AWS: arn:aws:iam::486128539022:root
Action:
- sts:AssumeRole
Condition:
StringEquals:
sts:ExternalId: !Sub 'ServerlessFramework-${OrgUid}'
Path: /
RoleName: !Ref RoleName
ManagedPolicyArns:
- arn:aws:iam::aws:policy/AdministratorAccess
ReporterFunction:
Type: Custom::ServerlessFrameworkReporter
Properties:
ServiceToken: 'arn:aws:lambda:us-east-1:486128539022:function:sp-providers-stack-reporter-custom-resource-prod-tmen2ec'
OrgUid: !Ref OrgUid
RoleArn: !GetAtt SFRole.Arn
Alias: !Ref Alias
Outputs:
SFRoleArn:
Description: 'ARN for the IAM Role used by Serverless Framework'
Value: !GetAtt SFRole.Arn
Parameters:
OrgUid:
Description: Serverless Framework Org Uid
Type: String
Alias:
Description: Serverless Framework Provider Alias
Type: String
RoleName:
Description: Serverless Framework Role Name
Type: String
```
</details>

<details>

<summary>Odnos poverenja</summary>
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Principal": {
"AWS": "arn:aws:iam::486128539022:root"
},
"Action": "sts:AssumeRole",
"Condition": {
"StringEquals": {
"sts:ExternalId": "ServerlessFramework-7bf7ddef-e1bf-43eb-a111-4d43e0894ccb"
}
}
}
]
}
```
</details>

5. U tutorijalu se tra≈æi da se kreira fajl `createCustomer.js` koji ƒáe u su≈°tini kreirati novu API taƒçku koju obraƒëuje novi JS fajl i tra≈æi se da se modifikuje fajl `serverless.yml` kako bi se generisala **nova DynamoDB tabela**, definisala **promenljiva okru≈æenja**, uloga koja ƒáe koristiti generisane lambde.

{% tabs %}
{% tab title="createCustomer.js" %}
```javascript
'use strict'
const AWS = require('aws-sdk')
module.exports.createCustomer = async (event) => {
const body = JSON.parse(Buffer.from(event.body, 'base64').toString())
const dynamoDb = new AWS.DynamoDB.DocumentClient()
const putParams = {
TableName: process.env.DYNAMODB_CUSTOMER_TABLE,
Item: {
primary_key: body.name,
email: body.email,
},
}
await dynamoDb.put(putParams).promise()
return {
statusCode: 201,
}
}
```
{% endtab %}

{% tab title="serverless.yml" %}
```yaml
# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: testing12342
# "app" enables Serverless Framework Dashboard features and sharing them with other Services.
app: tutorialapp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: Tutorial

provider:
name: aws
runtime: nodejs20.x
environment:
DYNAMODB_CUSTOMER_TABLE: ${self:service}-customerTable-${sls:stage}
iam:
role:
statements:
- Effect: 'Allow'
Action:
- 'dynamodb:PutItem'
- 'dynamodb:Get*'
- 'dynamodb:Scan*'
- 'dynamodb:UpdateItem'
- 'dynamodb:DeleteItem'
Resource: arn:aws:dynamodb:${aws:region}:${aws:accountId}:table/${self:service}-customerTable-${sls:stage}

functions:
hello:
handler: handler.hello
events:
- httpApi:
path: /
method: get
createCustomer:
handler: createCustomer.createCustomer
events:
- httpApi:
path: /
method: post

resources:
Resources:
CustomerTable:
Type: AWS::DynamoDB::Table
Properties:
AttributeDefinitions:
- AttributeName: primary_key
AttributeType: S
BillingMode: PAY_PER_REQUEST
KeySchema:
- AttributeName: primary_key
KeyType: HASH
TableName: ${self:service}-customerTable-${sls:stage}
```
{% endtab %}
{% endtabs %}

6. Deploy it running **`serverless deploy`**
1. Implementacija ƒáe se izvr≈°iti putem CloudFormation Stack-a
2. Imajte na umu da su **lambde izlo≈æene putem API gateway-a** a ne putem direktnih URL-ova
7. **Testirajte to**
1. Prethodni korak ƒáe ispisati **URL-ove** gde su va≈°i API endpoint lambda funkcije implementirane

## Bezbednosna provera Serverless.com

### **Pogre≈°no konfigurisane IAM uloge i dozvole**

Previ≈°e permisivne IAM uloge mogu omoguƒáiti neovla≈°ƒáen pristup cloud resursima, ≈°to mo≈æe dovesti do curenja podataka ili manipulacije resursima.

#### **Strategije ubla≈æavanja**

*   **Princip minimalnih privilegija:** Dodelite samo neophodne dozvole svakoj funkciji.

```yaml
provider:
iamRoleStatements:
- Effect: Allow
Action:
- dynamodb:Query
- dynamodb:Scan
Resource: arn:aws:dynamodb:${self:provider.region}:*:table/my-table
```
* **Koristite odvojene uloge:** Diferencirajte uloge na osnovu zahteva funkcije.

***

### **Neosigurani tajni podaci i upravljanje konfiguracijom**

Skladi≈°tenje osetljivih informacija (npr. API kljuƒçeva, kredencijala za bazu podataka) direktno u `serverless.yml` ili kodu mo≈æe dovesti do izlaganja ako su repozitorijumi kompromitovani ili ako je pristup AWS-u ugro≈æen, jer ƒáe biti ƒçitljivi iz konfiguracija lambdi.

#### **Strategije ubla≈æavanja**

*   **Promenljive okru≈æenja:** Umetnite tajne u vreme izvr≈°avanja bez hardkodiranja.

```yaml
provider:
environment:
DB_PASSWORD: ${ssm:/aws/reference/secretsmanager/my-db-password~true}
```
* **Integracija sa menad≈æerom tajni:** Koristite usluge kao ≈°to su **AWS Secrets Manager**, **Azure Key Vault** ili **HashiCorp Vault**.
* **Enkriptovane promenljive:** Iskoristite funkcije enkripcije Serverless Framework-a za osetljive podatke.
* **Kontrola pristupa:** Ograniƒçite pristup tajnama na osnovu uloga.
* **Izbegavajte logovanje tajni:** Osigurajte da tajne nisu izlo≈æene u logovima ili porukama o gre≈°kama.

***

### **Ranljiv kod i zavisnosti**

Zastarale ili nesigurne zavisnosti mogu uvesti ranjivosti, dok nepravilno rukovanje ulazima mo≈æe dovesti do napada injekcijom koda.

#### **Strategije ubla≈æavanja**

*   **Upravljanje zavisnostima:** Redovno a≈æurirajte zavisnosti i skenirajte za ranjivosti.

```yaml
plugins:
- serverless-webpack
- serverless-plugin-snyk
```
* **Validacija ulaza:** Implementirajte strogu validaciju i sanitizaciju svih ulaza.
* **Revizije koda:** Sprovodite temeljne revizije kako biste identifikovali sigurnosne propuste.
* **Statiƒçka analiza:** Koristite alate za otkrivanje ranjivosti u kodnoj bazi.

***

### **Neadekvatno logovanje i praƒáenje**

Bez pravilnog logovanja i praƒáenja, zlonamerne aktivnosti mogu ostati neprimeƒáene, ≈°to odla≈æe odgovor na incidente.

#### **Strategije ubla≈æavanja**

*   **Centralizovano logovanje:** Agregirajte logove koristeƒái usluge kao ≈°to su **AWS CloudWatch** ili **Datadog**.

```yaml
plugins:
- serverless-plugin-datadog
```
* **Omoguƒáite detaljno logovanje:** Zabele≈æite bitne informacije bez izlaganja osetljivih podataka.
* **Postavite upozorenja:** Konfiguri≈°ite upozorenja za sumnjive aktivnosti ili anomalije.
* **Redovno praƒáenje:** Kontinuirano pratite logove i metrike za potencijalne sigurnosne incidente.

***

### **Neosigurane konfiguracije API gateway-a**

Otvoreni ili nepravilno za≈°tiƒáeni API-ji mogu se iskoristiti za neovla≈°ƒáen pristup, napade uskraƒáivanja usluge (DoS) ili napade izmeƒëu sajtova.

#### **Strategije ubla≈æavanja**

*   **Autentifikacija i autorizacija:** Implementirajte robusne mehanizme kao ≈°to su OAuth, API kljuƒçevi ili JWT.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
authorizer: aws_iam
```
*   **Ograniƒçavanje brzine i usporavanje:** Spreƒçite zloupotrebu ograniƒçavanjem brzine zahteva.

```yaml
provider:
apiGateway:
throttle:
burstLimit: 200
rateLimit: 100
```
*   **Sigurna CORS konfiguracija:** Ograniƒçite dozvoljene izvore, metode i zaglavlja.

```yaml
functions:
hello:
handler: handler.hello
events:
- http:
path: hello
method: get
cors:
origin: https://yourdomain.com
headers:
- Content-Type
```
* **Koristite vatrozide za web aplikacije (WAF):** Filtrirajte i pratite HTTP zahteve za zlonamerne obrasce.

***

### **Nedovoljna izolacija funkcija**

Deljeni resursi i nedovoljna izolacija mogu dovesti do eskalacije privilegija ili nenamernih interakcija izmeƒëu funkcija.

#### **Strategije ubla≈æavanja**

* **Izolujte funkcije:** Dodelite razliƒçite resurse i IAM uloge kako biste osigurali nezavisno delovanje.
* **Partitioning resursa:** Koristite odvojene baze podataka ili skladi≈°ne kante za razliƒçite funkcije.
*   **Koristite VPC:** Implementirajte funkcije unutar Virtuelnih Privatnih Oblaka za pobolj≈°anu mre≈ænu izolaciju.

```yaml
provider:
vpc:
securityGroupIds:
- sg-xxxxxxxx
subnetIds:
- subnet-xxxxxx
```
* **Ograniƒçite dozvole funkcija:** Osigurajte da funkcije ne mogu pristupiti ili ometati resurse jedne druge osim ako to nije izriƒçito zahtevano.

***

### **Nedovoljna za≈°tita podataka**

Ne≈°ifrovani podaci u mirovanju ili u tranzitu mogu biti izlo≈æeni, ≈°to mo≈æe dovesti do curenja podataka ili manipulacije.

#### **Strategije ubla≈æavanja**

*   **≈†ifrujte podatke u mirovanju:** Iskoristite funkcije ≈°ifrovanja cloud usluga.

```yaml
resources:
Resources:
MyDynamoDBTable:
Type: AWS::DynamoDB::Table
Properties:
SSESpecification:
SSEEnabled: true
```
* **≈†ifrujte podatke u tranzitu:** Koristite HTTPS/TLS za sve prenose podataka.
* **Osigurajte API komunikaciju:** Sprovodite protokole ≈°ifrovanja i validirajte sertifikate.
* **Sigurno upravljajte ≈°ifrovanjem kljuƒçeva:** Koristite usluge upravljanja kljuƒçevima i redovno rotirajte kljuƒçeve.

***

### **Nedostatak pravilnog rukovanja gre≈°kama**

Detaljne poruke o gre≈°kama mogu otkriti osetljive informacije o infrastrukturi ili kodnoj bazi, dok neobraƒëene izuzetke mogu dovesti do ru≈°enja aplikacije.

#### **Strategije ubla≈æavanja**

*   **Generiƒçke poruke o gre≈°kama:** Izbegavajte izlaganje internih detalja u odgovorima o gre≈°kama.

```javascript
javascriptCopy code// Primer u Node.js
exports.hello = async (event) => {
try {
// Logika funkcije
} catch (error) {
console.error(error);
return {
statusCode: 500,
body: JSON.stringify({ message: 'Internal Server Error' }),
};
}
};
```
* **Centralizovano rukovanje gre≈°kama:** Upravljajte i sanitizujte gre≈°ke dosledno kroz sve funkcije.
* **Pratite i logujte gre≈°ke:** Pratite i analizirajte gre≈°ke interno bez izlaganja detalja krajnjim korisnicima.

***

### **Neosigurane prakse implementacije**

Izlo≈æene konfiguracije implementacije ili neovla≈°ƒáen pristup CI/CD pipelinima mogu dovesti do zlonamernih implementacija koda ili pogre≈°nih konfiguracija.

#### **Strategije ubla≈æavanja**

* **Osigurajte CI/CD pipelinske:** Implementirajte stroge kontrole pristupa, vi≈°efaktorsku autentifikaciju (MFA) i redovne revizije.
* **Sigurno skladi≈°tenje konfiguracije:** Dr≈æite datoteke implementacije bez hardkodiranih tajni i osetljivih podataka.
* **Koristite alate za sigurnost infrastrukture kao koda (IaC):** Koristite alate kao ≈°to su **Checkov** ili **Terraform Sentinel** za sprovoƒëenje sigurnosnih politika.
* **Nepromenljive implementacije:** Spreƒçite neovla≈°ƒáene promene nakon implementacije usvajanjem praksi nepromenljive infrastrukture.

***

### **Ranjivosti u dodacima i ekstenzijama**

Kori≈°ƒáenje neproverenih ili zlonamernih dodataka treƒáih strana mo≈æe uvesti ranjivosti u va≈°e serverless aplikacije.

#### **Strategije ubla≈æavanja**

* **Temeljno proverite dodatke:** Procijenite sigurnost dodataka pre integracije, favorizujuƒái one iz uglednih izvora.
* **Ograniƒçite kori≈°ƒáenje dodataka:** Koristite samo neophodne dodatke kako biste smanjili povr≈°inu napada.
* **Pratite a≈æuriranja dodataka:** Dr≈æite dodatke a≈æuriranim kako biste imali koristi od sigurnosnih zakrpa.
* **Izolujte okru≈æenja dodataka:** Pokreƒáite dodatke u izolovanim okru≈æenjima kako biste obuzdali potencijalne kompromitacije.

***

### **Izlo≈æenost osetljivih krajnjih taƒçaka**

Javno dostupne funkcije ili neograniƒçeni API-ji mogu se iskoristiti za neovla≈°ƒáene operacije.

#### **Strategije ubla≈æavanja**

* **Ograniƒçite pristup funkcijama:** Koristite VPC, sigurnosne grupe i pravila vatrozida kako biste ograniƒçili pristup pouzdanim izvorima.
* **Implementirajte robusnu autentifikaciju:** Osigurajte da sve izlo≈æene krajnje taƒçke zahtevaju pravilnu autentifikaciju i autorizaciju.
* **Sigurno koristite API gateway-e:** Konfiguri≈°ite API gateway-e da sprovode sigurnosne politike, ukljuƒçujuƒái validaciju ulaza i ograniƒçavanje brzine.
* **Onemoguƒáite neiskori≈°ƒáene krajnje taƒçke:** Redovno pregledajte i onemoguƒáite sve krajnje taƒçke koje vi≈°e nisu u upotrebi.

***

### **Prekomerne dozvole za ƒçlanove tima i spoljne saradnike**

Dodeljivanje prekomernih dozvola ƒçlanovima tima i spoljnim saradnicima mo≈æe dovesti do neovla≈°ƒáenog pristupa, curenja podataka i zloupotrebe resursa. Ovaj rizik je pojaƒçan u okru≈æenjima gde vi≈°e pojedinaca ima razliƒçite nivoe pristupa, poveƒáavajuƒái povr≈°inu napada i potencijal za unutra≈°nje pretnje.

#### **Strategije ubla≈æavanja**

* **Princip minimalnih privilegija:** Osigurajte da ƒçlanovi tima i saradnici imaju samo dozvole neophodne za obavljanje svojih zadataka.

***

### **Bezbednost pristupnih kljuƒçeva i kljuƒçeva licenci**

**Pristupni kljuƒçevi** i **kljuƒçevi licenci** su kritiƒçne akreditive koji se koriste za autentifikaciju i autorizaciju interakcija sa Serverless Framework CLI.

* **Kljuƒçevi licenci:** Oni su jedinstveni identifikatori potrebni za autentifikaciju pristupa Serverless Framework verziji 4 koja omoguƒáava prijavu putem CLI.
* **Pristupni kljuƒçevi:** Akreditive koje omoguƒáavaju Serverless Framework CLI da se autentifikuje sa Serverless Framework Dashboard-om. Kada se prijavite sa `serverless` cli, pristupni kljuƒç ƒáe biti **generisan i saƒçuvan na laptopu**. Takoƒëe ga mo≈æete postaviti kao promenljivu okru≈æenja pod imenom `SERVERLESS_ACCESS_KEY`.

#### **Sigurnosni rizici**

1. **Izlo≈æenost kroz kodne repozitorijume:**
* Hardkodiranje ili sluƒçajno obavezivanje pristupnih kljuƒçeva i kljuƒçeva licenci u sisteme kontrole verzija mo≈æe dovesti do neovla≈°ƒáenog pristupa.
2. **Neosigurano skladi≈°tenje:**
* Skladi≈°tenje kljuƒçeva u obiƒçnom tekstu unutar promenljivih okru≈æenja ili konfiguracionih datoteka bez odgovarajuƒáe enkripcije poveƒáava verovatnoƒáu curenja.
3. **Nepravilna distribucija:**
* Deljenje kljuƒçeva putem nesigurnih kanala (npr. e-po≈°ta, chat) mo≈æe rezultirati presretanjem od strane zlonamernih aktera.
4. **Nedostatak rotacije:**
* Nepostojanje redovne rotacije kljuƒçeva produ≈æava period izlo≈æenosti ako su kljuƒçevi kompromitovani.
5. **Prekomerne dozvole:**
* Kljuƒçevi sa ≈°irokim dozvolama mogu se iskoristiti za obavljanje neovla≈°ƒáenih radnji na vi≈°e resursa.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
