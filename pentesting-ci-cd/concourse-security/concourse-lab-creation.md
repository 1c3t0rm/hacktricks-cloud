# Concourse Lab Creation

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Testing Environment

### Running Concourse

#### With Docker-Compose

This docker-compose file simplifies the installation to do some tests with concourse:

<details>

<summary><strong>qaStaHvIS Docker-Compose</strong></summary>

```yaml
version: '3'

services:
  concourse-db:
    image: postgres:9.6
    environment:
      POSTGRES_DB: concourse
      POSTGRES_USER: concourse
      POSTGRES_PASSWORD: changeme
    volumes:
      - ./db:/var/lib/postgresql/data

  concourse-web:
    image: concourse/concourse
    depends_on:
      - concourse-db
    command: web
    ports:
      - "8080:8080"
    volumes:
      - ./keys/web:/concourse-keys
    environment:
      CONCOURSE_POSTGRES_HOST: concourse-db
      CONCOURSE_POSTGRES_USER: concourse
      CONCOURSE_POSTGRES_PASSWORD: changeme
      CONCOURSE_EXTERNAL_URL: http://localhost:8080
      CONCOURSE_ADD_LOCAL_USER: test:test
      CONCOURSE_MAIN_TEAM_LOCAL_USER: test
      CONCOURSE_MAIN_TEAM_LOCAL_PASSWORD: test
      CONCOURSE_SESSION_SIGNING_KEY: |
        -----BEGIN RSA PRIVATE KEY-----
        MIIEowIBAAKCAQEAz3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3
        z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3
        z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3
        z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3
```bash
wget https://raw.githubusercontent.com/starkandwayne/concourse-tutorial/master/docker-compose.yml
docker-compose up -d
```
**tlhIngan Hol:**

You can download the command line `fly` for your OS from the web in `127.0.0.1:8080`

#### With Kubernetes (Recommended)

You can easily deploy concourse in **Kubernetes** (in **minikube** for example) using the helm-chart: [**concourse-chart**](https://github.com/concourse/concourse-chart).
```bash
brew install helm
helm repo add concourse https://concourse-charts.storage.googleapis.com/
helm install concourse-release concourse/concourse
# concourse-release will be the prefix name for the concourse elements in k8s
# After the installation you will find the indications to connect to it in the console

# If you need to delete it
helm delete concourse-release
```
**DaH jImej concourse env, vaj vItlhutlh vItlhutlh secret 'ej vItlhutlh access SA running concourse web vItlhutlh access K8s secrets:**

```bash
$ kubectl create secret generic concourse-web-k8s-secret \
    --from-literal=concourse-web-k8s-secret-key=<your-secret-key> \
    --namespace=<your-namespace>
```

**bash**
```bash
$ kubectl create secret generic concourse-web-k8s-secret \
    --from-literal=concourse-web-k8s-secret-key=<your-secret-key> \
    --namespace=<your-namespace>
```
```yaml
echo 'apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
name: read-secrets
rules:
- apiGroups: [""]
resources: ["secrets"]
verbs: ["get"]

---

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
name: read-secrets-concourse
roleRef:
apiGroup: rbac.authorization.k8s.io
kind: ClusterRole
name: read-secrets
subjects:
- kind: ServiceAccount
name: concourse-release-web
namespace: default

---

apiVersion: v1
kind: Secret
metadata:
name: super
namespace: concourse-release-main
type: Opaque
data:
secret: MWYyZDFlMmU2N2Rm

' | kubectl apply -f -
```
### Qap

Qap vItlhutlh [Jobs](https://concourse-ci.org/jobs.html) vaj vItlhutlh [Steps](https://concourse-ci.org/steps.html).

### Steps

vaj Steps vaj beQ:

* **[**`task` step**](https://concourse-ci.org/task-step.html) **vaj** [**task**](https://concourse-ci.org/tasks.html) **vaj**
* [**`get` step**](https://concourse-ci.org/get-step.html) **vaj** [resource](https://concourse-ci.org/resources.html) **vaj**
* [**`put` step**](https://concourse-ci.org/put-step.html) **vaj** [resource](https://concourse-ci.org/resources.html) **vaj**
* [**`set_pipeline` step**](https://concourse-ci.org/set-pipeline-step.html) **vaj** [pipeline](https://concourse-ci.org/pipelines.html) **vaj**
* [**`load_var` step**](https://concourse-ci.org/load-var-step.html) **vaj** [local var](https://concourse-ci.org/vars.html#local-vars) **vaj**
* [**`in_parallel` step**](https://concourse-ci.org/in-parallel-step.html) **vaj** **steps** **vaj**
* [**`do` step**](https://concourse-ci.org/do-step.html) **vaj** **steps** **vaj**
* [**`across` step modifier**](https://concourse-ci.org/across-step.html#schema.across) **vaj** **step** **vaj**; **vaj** **variable values** **vaj**
* [**`try` step**](https://concourse-ci.org/try-step.html) **vaj** **step** **vaj** **vaj** **step** **vaj**

[step](https://concourse-ci.org/steps.html) vaj [job plan](https://concourse-ci.org/jobs.html#schema.job.plan) vaj **container** **vaj**. vaj **container** **vaj** _(i.e. run my tests, run this bash script, build this image, etc.)_.

### Simple Pipeline Example
```yaml
jobs:
- name: simple
plan:
- task: simple-task
privileged: true
config:
# Tells Concourse which type of worker this task should run on
platform: linux
image_resource:
type: registry-image
source:
repository: busybox # images are pulled from docker hub by default
run:
path: sh
args:
- -cx
- |
sleep 1000
echo "$SUPER_SECRET"
params:
SUPER_SECRET: ((super.secret))
```

```bash
fly -t tutorial set-pipeline -p pipe-name -c hello-world.yml
# pipelines are paused when first created
fly -t tutorial unpause-pipeline -p pipe-name
# trigger the job and watch it run to completion
fly -t tutorial trigger-job --job pipe-name/simple --watch
# From another console
fly -t tutorial intercept --job pipe-name/simple
```
**127.0.0.1:8080** qIDmeyvam vItlhutlh.

### Bash script vItlhutlh vIleghlaHbe'chugh

**jatlhqa' vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq chenmoHwI' vItlhutlhDaq vItlhutlhDaq ch
