# SCM IP Whitelisting Bypass

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>

рдпрд╣ рдкреГрд╖реНрда [https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/](https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/) рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

## рдкрд░рд┐рдЪрдп

рдХрдИ рд╕рдВрдЧрдарди **SaaS-based source control management (SCM) рд╕рд┐рд╕реНрдЯрдореНрд╕** (рдЬреИрд╕реЗ GitHub рдпрд╛ GitLab) рдХреЛ рдПрдХ **рдЖрдВрддрд░рд┐рдХ**, рд╕реНрд╡-рд╣реЛрд╕реНрдЯреЗрдб **CI** рд╕рдорд╛рдзрд╛рди (рдЬреИрд╕реЗ Jenkins, TeamCity) рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдпреЗ CI рд╕рд┐рд╕реНрдЯрдореНрд╕ **SaaS рд╕реНрд░реЛрдд** рд╕реЗ **webhook рдЗрд╡реЗрдВрдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, pipeline jobs рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд╕рд░рд▓ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдПред

рдЗрд╕рд▓рд┐рдП, рд╕рдВрдЧрдарди **SCM** рдХреЗ **IP** рд░реЗрдВрдЬ рдХреЛ **whitelist** рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ **webhooks** рдХреЗ рд╕рд╛рде **рдЖрдВрддрд░рд┐рдХ** CI рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХреЛрдИ рднреА** Github рдпрд╛ Gitlab рдореЗрдВ рдПрдХ **рдЦрд╛рддрд╛** рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ **webhook рдЯреНрд░рд┐рдЧрд░** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рдЙрд╕ **рдЖрдВрддрд░рд┐рдХ CI рд╕рд┐рд╕реНрдЯрдо** рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ SCM рд╡реЗрдВрдбрд░ рдХреА webhook рд╕реЗрд╡рд╛ рдХреА IP рд░реЗрдВрдЬ рдХреЛ рд╕рдВрдЧрдарди рдХреА рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдореЗрдВ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рдерд╛ рддрд╛рдХрд┐ **webhook рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ pipelines рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХреЗ** - рдЗрд╕рдХрд╛ **рдпрд╣ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИ** рдХрд┐ webhook рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрдиреНрдп CI endpoints рдХреА рдУрд░ **рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛**, рдЬреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ webhook рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рд╕реБрдирддреЗ рд╣реИрдВред рд╣рдо рдЗрди endpoints рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдореВрд▓реНрдпрд╡рд╛рди рдбреЗрдЯрд╛ рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛**, **pipelines**, **pipeline jobs рдХреЗ console output** рджреЗрдЦ рд╕рдХреЗрдВ, рдпрд╛ рдпрджрд┐ рд╣рдо рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реЛрдВ рдФрд░ рдПрдХ рдРрд╕реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рдЖ рдЬрд╛рдПрдВ рдЬреЛ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ (рд╣рд╛рдБ, рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ), рддреЛ рд╣рдо **configurations рдФрд░ credentials рд╕реЗрдХреНрд╢рдиреНрд╕** рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред

### рдкрд░рд┐рджреГрд╢реНрдп

рдХрд▓реНрдкрдирд╛ рдХреАрдЬрд┐рдП рдХрд┐ рдПрдХ **Jenkins** рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рдХреЗрд╡рд▓ **GitHub** рдФрд░ **GitLab** рдХреЗ IPs рдХреЛ **рдмрд╛рд╣рд░реА** рд░реВрдк рд╕реЗ рдЙрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА **рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ**ред

рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ GitHub рдФрд░ GitLab рдореЗрдВ рдордирдорд╛рдиреЗ webhooks рдЯреНрд░рд┐рдЧрд░ рдХрд░рдХреЗ Jenkins рдХреЗ рдЕрдВрджрд░ рд▓реЙрдЧрд┐рди рдХрд░реЗрдЧрд╛ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реЗрдЧрд╛ред

### рд╕рд╛рдорд╛рдиреНрдп Webhooks рд╕реАрдорд╛рдПрдБ

* **рдХреЗрд╡рд▓ POST рдЕрдиреБрд░реЛрдз**: Webhooks рдЖрдорддреМрд░ рдкрд░ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ POST рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ **endpoints** рдЬрд┐рдирдореЗрдВ **рд░реЛрдЪрдХ** рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ, рдЙрдиреНрд╣реЗрдВ **GET рдЕрдиреБрд░реЛрдзреЛрдВ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ Post рдХрд╛ **рдЙрддреНрддрд░ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд╕рд╛рде рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ рдпрд╣ рдЙрд╕рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* рдХреБрдЫ CIs (Jenkins) рдПрдХ **GET рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬреЛ рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдХрд╣рд╛рдБ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдирд╛ рд╣реИ**, рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕реЗ Get рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреГрд╖реНрда рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **POST рдЕрдиреБрд░реЛрдз рдХреЗ рдмреЙрдбреА рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**: рдпрджрд┐ рдЖрдк POST рдмреЙрдбреА рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЗрдЯрд╛ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред
* **CSRF рдЯреЛрдХрди**: рдпрджрд┐ рд░реЛрдЪрдХ endpoint CSRF рдЯреЛрдХрди рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдирд┐рдХрд╛рд▓ рдирд╣реАрдВ рдкрд╛рдПрдВрдЧреЗ рдФрд░ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗред

## GitHub Webhooks

### Jenkins рд▓реЙрдЧрд┐рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдПрдХ **POST рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рд▓реЙрдЧрд┐рди endpoint рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп CSRF рдЯреЛрдХрди рд░рдЦрдиреЗ рдХреА рдЪреБрдиреМрддреА рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдЕрдиреБрд░реЛрдз рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рд╣рдо рдЕрднреА рднреА рджреВрд╕рд░реА рдЪреБрдиреМрддреА рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реА рдХреНрд╖рдорддрд╛рдПрдВ **рдЕрдиреБрд░реЛрдз рдХреА рдмреЙрдбреА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдорд┐рдд рд░рд╣рддреА рд╣реИрдВ**ред

Jenkins рд▓реЙрдЧрд┐рди рдЕрдиреБрд░реЛрдз рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦрддрд╛ рд╣реИ:
```
POST /j_acegi_security_check HTTP/1.1
Host: jenkins.example-domain.com
[...]

j_username=admin&j_password=mypass123&from=%2F&Submit=Sign+in
```
рд╣рдореЗрдВ **рдЬрд┐рди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╣рдордиреЗ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдХрд┐рд╕реА рддрд░рд╣ рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛**ред\
рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, Jenkins рд▓реЙрдЧрд┐рди рдПрдВрдбрдкреЙрдЗрдВрдЯ **рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ** POST рдЕрдиреБрд░реЛрдз рдЬрд┐рд╕рдореЗрдВ **рдлреАрд▓реНрдбреНрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```
POST /j_acegi_security_check?j_username=admin&j_password=mypass123&from=%2F&Submit=Sign+in HTTP/1.1
Host: jenkins.example-domain.com
[...]

[webhook json in body of request]
```
рддреЛ рд╣рдо рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рд╡рд╛ рд╕рдХрддреЗ рд╣реИрдВ? рд╣рдо **GitHub рдореЗрдВ рдПрдХ рдирдпрд╛ webhook рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**, **Jenkins рд▓реЙрдЧрд┐рди рдЕрдиреБрд░реЛрдз URL рдХреЛ payload URL рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реБрдП**ред рдлрд┐рд░ рд╣рдо GitHub API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдСрдЯреЛрдореЗрд╢рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ brute-force рдХрд░реЗ**, рдкрд╛рд╕рд╡рд░реНрдб рдлреАрд▓реНрдб рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдХреЗ, webhook рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдХреЗ, рдФрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА webhook рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдХреЗред
```
http://jenkins.example-domain.com/j_acegi_security_check?j_username=admin&j_password=therealpassword&from=%2F&Submit=Sign+in
```
<figure><img src="../../.gitbook/assets/image (7) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

рд╣рдо webhook рдлрд╛рдпрд░ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдкрд░рд┐рдгрд╛рдо рджреЗрдЦрддреЗ рд╣реИрдВред рд╕рднреА SCM рд╡реЗрдВрдбрд░реНрд╕ рдЕрдкрдиреЗ UI рдореЗрдВ webhook рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗ рдЧрдП HTTP рдЕрдиреБрд░реЛрдз рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВред\
рдпрджрд┐ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕ рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рд▓реЙрдЧрд┐рди рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкрд░ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (6) (1) (2).png" alt=""><figcaption></figcaption></figure>

рд▓реЗрдХрд┐рди рдпрджрд┐ **рд▓реЙрдЧрд┐рди рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ**, рддреЛ рд╣рдореЗрдВ рдореБрдЦреНрдп Jenkins рдкреГрд╖реНрда рдкрд░ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдПрдХ **рд╕рддреНрд░ рдХреБрдХреА рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИ**ред

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рд▓рд┐рдП, рд╣рдо **Jenkins рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рд╕рддреНрд░ рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!**\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдереЛрдбрд╝реЗ рд╕реАрдорд┐рдд рд╣реИрдВ тАУ рд╣рдо рдХреЗрд╡рд▓ **рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдПрдХ рд╕реНрдЯреЗрдЯрд▓реЗрд╕ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ**, рдФрд░ **рдХреБрдХреА рдХреЛ рд╣рдорд╛рд░реЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рдЬреЛрдбрд╝рд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛**, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рд╣реЗрдбрд░реНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред

рдПрдХ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдк **Jenkins рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ URL рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ CSRF рдЯреЛрдХрди рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ Jenkins рдХреЛ POST рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдХрд▓реНрдк рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХрд┐рд╕реА рддрд░рд╣ SCM IP рд░реЗрдВрдЬ рд╕реЗ рдХреЗрд╡рд▓ рд╕реБрд▓рдн рдПрдХ рд╕реНрд╡-рд╣реЛрд╕реНрдЯреЗрдб CI рдХреЛ рдвреВрдВрдврдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрд╕ CI рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдиреНрдп рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рдлрд┐рд▓рд╣рд╛рд▓ тАУ рд╣рдо рдЕрдзрд┐рдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗред

## GitLab Webhooks

### Jenkins рд▓реЙрдЧрд┐рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдЪрд▓рд┐рдП рд╡рд╣реА рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕ рдмрд╛рд░ GitLab рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рд╕рдорд╛рди рд╕реАрдорд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг, рд╣рдо рдмрд┐рд▓реНрдХреБрд▓ **рд╡рд╣реА POST рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреЗ рд╣реИрдВ, рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ**ред

<figure><img src="../../.gitbook/assets/image (2) (2) (1).png" alt=""><figcaption></figcaption></figure>

рд╣рдо рдЕрдиреБрд░реЛрдз рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди GitHub рдХреЗ рд╡рд┐рдкрд░реАрдд тАУ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ 200 рд╣реИред рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХреА рддрд░рд╣, рд╣рдордиреЗ **GitLab рдХреА webhook рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдФрд░ рдПрдХ рд╕рддреНрд░ рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдХреА**, рд▓реЗрдХрд┐рди рдЗрд╕ рдмрд╛рд░ тАУ Jenkins рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА GitLab UI рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬреА рдЧрдИ, рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ **Jenkins рдореБрдЦреНрдп рдкреГрд╖реНрда рдХреА рдкреВрд░реА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рди рдХреА рдЧрдИред**\
\*\*\*\*рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **GitLab рдиреЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рдкрд╛рд▓рди рдХрд┐рдпрд╛** рдФрд░ рдЕрдиреБрд░реЛрдз рдореЗрдВ **рдХреБрдХреА** рдХреЛ рдЬреЛрдбрд╝рд╛:

<figure><img src="../../.gitbook/assets/image (4) (1) (2).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдХреЗ рдорд╛рдиреНрдп рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ,
2. рд▓реЙрдЧрд┐рди рдкреГрд╖реНрда рдкрд░ рдорд╛рдиреНрдп рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЙрдЧрд┐рди рдХрд░реЗрдВ,
3. рдЖрдВрддрд░рд┐рдХ Jenkins рдореБрдЦреНрдп рдкреГрд╖реНрда рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред

### Jenkins рдЖрдВрддрд░рд┐рдХ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

Jenkins **рд▓реЙрдЧрд┐рди рдореЗрдВ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдкреИрд░рд╛рдореАрдЯрд░ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ** тАУ тАЬ_from_тАЭ. рдореВрд▓ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЙрдирдХреЗ рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж рд╡реЗ рдЬрд┐рд╕ рдкреГрд╖реНрда рдкрд░ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рдереЗ рдЙрд╕ рдкрд░ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ тАУ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЬрд┐рд╕рдХрд╛ рд╣рдо рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдо рдЕрдкрдиреА рдкрд╕рдВрдж рдХреЗ рдЖрдВрддрд░рд┐рдХ Jenkins рдкреГрд╖реНрда рдкрд░ рдПрдХ рд╕рддреНрд░ рдХреБрдХреА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рдПрдХ GET рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХреЗрдВред рдЪрд▓рд┐рдП рджреЗрдЦрддреЗ рд╣реИрдВ рдХреИрд╕реЗ:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

1. рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд URL рдХреЗ рд╕рд╛рде рдПрдХ webhook рд╕реЗрдЯ рдХрд░реЗрдВ:
```
http://jenkins.example-domain.com/j_acegi_security_check?j_username=admin&j_password=secretpass123&from=/job/prod_pipeline/1/consoleText&Submit=Sign+in
```
POST рдЕрдиреБрд░реЛрдз Jenkins рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИред

* рд╣рдореЗрдВ 302 рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рд╣реИ, рдПрдХ рд╕рддреНрд░ рдХреБрдХреА рдХреЗ рд╕рд╛рде, рдФрд░ рдЬреЙрдм рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ рдкреЗрдЬ рдХреА рдУрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рдиред
* GitLab webhook рд╕реЗрд╡рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреА рд╣реИ рдПрдХ GET рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдЬреЛ рдЬреЙрдм рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ рдкреЗрдЬ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рддреНрд░ рдХреБрдХреА рдЬреЛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИ:
```
http://jenkins.example-domain.com/job/prod_pipeline/1/consoleText
```
* рдЬреЙрдм рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ GitLab webhook рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (1) (3).png" alt=""><figcaption></figcaption></figure>

рдпрд╣рд╛рдБ рдпрд╣ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ Jenkins рдХреЛ **рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдЖрдВрддрд░рд┐рдХ рдШрдЯрдХреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдХреЗрд╡рд▓ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЖрдВрддрд░рд┐рдХ рдШрдЯрдХреЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рд╣рдо рдкрд░ рдХреНрдпрд╛ рдкреНрд░рднрд╛рд╡ рдкрдбрд╝рддрд╛ рд╣реИ?

* рдЕрдЧрд░ **рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо GitLab webhook рд╕реЗрд╡рд╛ рдХреЛ CI рдХреЗ рдХрд┐рд╕реА рднреА рдЖрдВрддрд░рд┐рдХ рдкреЗрдЬ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ, рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдФрд░ рд╣рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред
* рдЕрдЧрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА рдЖрдВрддрд░рд┐рдХ рдкреЗрдЬ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ рдХрд┐ рдКрдкрд░ рдмреБрд▓реЗрдЯ рдореЗрдВ)ред

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
