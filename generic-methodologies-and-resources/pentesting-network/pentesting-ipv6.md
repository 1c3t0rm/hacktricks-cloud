# Pentesting IPv6

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovna teorija o IPv6

### Mreže

IPv6 adrese su strukturirane da poboljšaju organizaciju mreže i interakciju uređaja. IPv6 adresa je podeljena na:

1. **Mrežni prefiks**: Prvih 48 bita koji određuju segment mreže.
2. **ID podmreže**: Sledećih 16 bita koji se koriste za definisanje specifičnih podmreža unutar mreže.
3. **Identifikator interfejsa**: Poslednjih 64 bita koji jedinstveno identifikuju uređaj unutar podmreže.

Iako IPv6 ne koristi ARP protokol koji se nalazi u IPv4, uvodi **ICMPv6** sa dve osnovne poruke:

* **Neighbor Solicitation (NS)**: Multicast poruke za razrešavanje adresa.
* **Neighbor Advertisement (NA)**: Unicast odgovori na NS ili spontane objave.

IPv6 takođe uključuje posebne vrste adresa:

* **Loopback adresa (`::1`)**: Ekvivalent IPv4 adrese `127.0.0.1`, za internu komunikaciju unutar hosta.
* **Link-Local adrese (`FE80::/10`)**: Za lokalne mrežne aktivnosti, ne za rutiranje na internetu. Uređaji na istoj lokalnoj mreži mogu otkriti jedni druge koristeći ovaj opseg.

#### Praktična upotreba IPv6 u mrežnim komandama

Da biste komunicirali sa IPv6 mrežama, možete koristiti različite komande:

* **Ping Link-Local adrese**: Proverite prisustvo lokalnih uređaja koristeći `ping6`.
* **Neighbor Discovery**: Koristite `ip neigh` da biste videli uređaje otkrivene na sloju veze.
* **alive6**: Alternativni alat za otkrivanje uređaja na istoj mreži.

Ispod su neki primeri komandi:

```bash
ping6 –I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```

IPv6 adrese mogu se izvesti iz MAC adrese uređaja za lokalnu komunikaciju. Evo pojednostavljenog vodiča o tome kako izvesti Link-local IPv6 adresu iz poznate MAC adrese, kao i kratki pregled vrsta IPv6 adresa i metoda za otkrivanje IPv6 adresa unutar mreže.

### **Izvođenje Link-local IPv6 adrese iz MAC adrese**

Za datu MAC adresu **`12:34:56:78:9a:bc`**, možete konstruisati Link-local IPv6 adresu na sledeći način:

1. Pretvorite MAC adresu u IPv6 format: **`1234:5678:9abc`**
2. Dodajte `fe80::` i ubacite `fffe` u sredinu: **`fe80::1234:56ff:fe78:9abc`**
3. Invertujte sedmi bit s leva, menjajući `1234` u `1034`: **`fe80::1034:56ff:fe78:9abc`**

### **Vrste IPv6 adresa**

* **Unique Local Address (ULA)**: Za lokalnu komunikaciju, nije namenjena za javno rutiranje na internetu. Prefiks: **`FEC00::/7`**
* **Multicast adresa**: Za jedan-na-više komunikaciju. Isporučuje se svim interfejsima u multicast grupi. Prefiks: **`FF00::/8`**
* **Anycast adresa**: Za jedan-do-najbliže komunikacije. Šalje se najbližem interfejsu prema rutirajućem protokolu. Deo globalnog unicast opsega **`2000::/3`**.

### **Prefiksi adresa**

* **fe80::/10**: Link-Local adrese (slično kao 169.254.x.x)
* **fc00::/7**: Unique Local-Unicast (slično privatnim IPv4 opsezima kao što su 10.x.x.x, 172.16.x.x, 192.168.x.x)
* **2000::/3**: Global Unicast
* **ff02::1**: Multicast Svi čvorovi
* **ff02::2**: Multicast Rutirajući čvorovi

### **Otkrivanje IPv6 adresa unutar mreže**

#### Način 1: Korišćenje Link-local adresa

1. Dobijte MAC adresu uređaja unutar mreže.
2. Izvedite Link-local IPv6 adresu iz MAC adrese.

#### Način 2: Korišćenje Multicast-a

1. Pošaljite ping na multicast adresu `ff02::1` da biste otkrili IPv6 adrese na lokalnoj mreži.

```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```

### IPv6 Napad čovek-u-sredini (MitM)

Postoji nekoliko tehnika za izvođenje MitM napada u IPv6 mrežama, kao što su:

* Lažiranje ICMPv6 suseda ili rutera oglasa.
* Korišćenje ICMPv6 preusmeravanja ili poruka "Packet Too Big" za manipulaciju rutiranjem.
* Napad na mobilni IPv6 (obično zahteva onemogućavanje IPSec-a).
* Postavljanje lažnog DHCPv6 servera.

## Identifikacija IPv6 adresa u polju

### Istraživanje poddomena

Metod za pronalaženje poddomena koji su potencijalno povezani sa IPv6 adresama uključuje korišćenje pretraživača. Na primer, upotreba obrasca upita poput `ipv6.*` može biti efikasna. Konkretno, sledeća pretraga može se koristiti u Google-u:

```bash
site:ipv6./
```

### Korišćenje DNS upita

Da biste identifikovali IPv6 adrese, mogu se koristiti određene vrste DNS zapisa:

* **AXFR**: Zahteva kompletnu transfer zonu, što može otkriti širok spektar DNS zapisa.
* **AAAA**: Direktno traži IPv6 adrese.
* **ANY**: Opšti upit koji vraća sve dostupne DNS zapise.

### Ispitivanje sa Ping6

Nakon što se identifikuju IPv6 adrese povezane sa organizacijom, može se koristiti alatka `ping6` za ispitivanje. Ovaj alat pomaže u proceni odziva identifikovanih IPv6 adresa i može takođe pomoći u otkrivanju susednih IPv6 uređaja.

### Reference

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
