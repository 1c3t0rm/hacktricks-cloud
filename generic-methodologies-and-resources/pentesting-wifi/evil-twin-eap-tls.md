# Evil Twin EAP-TLS

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! Pridružite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas i počnite da zarađujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

U jednom trenutku sam morao da koristim predloženo rešenje iz posta ispod, ali koraci u [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) više nisu radili u modernom kali (2019v3).\
U svakom slučaju, lako je da ih proradite.\
Samo trebate preuzeti hostapd-2.6 odavde: [https://w1.fi/releases/](https://w1.fi/releases/) i pre nego što ponovo kompajlirate hostapd-wpe instalirajte: `apt-get install libssl1.0-dev`

### Analiza i iskorišćavanje EAP-TLS u bežičnim mrežama

#### Pozadina: EAP-TLS u bežičnim mrežama

EAP-TLS je sigurnosni protokol koji omogućava međusobnu autentifikaciju između klijenta i servera korišćenjem sertifikata. Veza se uspostavlja samo ako se klijent i server međusobno autentifikuju putem svojih sertifikata.

#### Naiđeni izazov

Tokom procene, naiđena je interesantna greška prilikom korišćenja alata `hostapd-wpe`. Alat je odbio konekciju klijenta zbog toga što je klijentov sertifikat potpisan od strane nepoznatog Sertifikacionog Autoriteta (CA). To ukazuje na to da klijent veruje lažnom serverovom sertifikatu, što ukazuje na slabu konfiguraciju sigurnosti na strani klijenta.

#### Cilj: Postavljanje napada čovek-u-sredini (MiTM)

Cilj je bio izmeniti alat tako da prihvati bilo koji klijentski sertifikat. To bi omogućilo uspostavljanje veze sa zlonamernom bežičnom mrežom i omogućilo napad čovek-u-sredini, potencijalno hvatanje tekstualnih lozinki ili drugih osetljivih podataka.

#### Rešenje: Izmena `hostapd-wpe`

Analiza izvornog koda `hostapd-wpe` otkrila je da se validacija klijentskog sertifikata kontroliše parametrom (`verify_peer`) u OpenSSL funkciji `SSL_set_verify`. Promenom vrednosti ovog parametra sa 1 (validacija) na 0 (ne validacija), alat je bio modifikovan da prihvati bilo koji klijentski sertifikat.

#### Izvršenje napada

1. **Provera okruženja:** Koristite `airodump-ng` da biste pratili bežične mreže i identifikovali ciljeve.
2. **Postavljanje lažne AP:** Pokrenite modifikovani `hostapd-wpe` da biste kreirali lažnu pristupnu tačku (AP) koja oponaša ciljnu mrežu.
3. **Prilagođavanje portala za zarobljavanje:** Prilagodite stranicu za prijavljivanje portala za zarobljavanje da izgleda legitimno i poznato ciljnom korisniku.
4. **De-autentifikacioni napad:** Opciono, izvedite de-autentifikacioni napad da biste prekinuli vezu klijenta sa legitimnom mrežom i povezali ga sa lažnom AP.
5. **Hvatanje lozinki:** Kada se klijent poveže sa lažnom AP i interaguje sa portalom za zarobljavanje, njegove lozinke se hvataju.

#### Opservacije iz napada

* Na Windows mašinama, sistem može automatski da se poveže sa lažnom AP, prikazujući portal za zarobljavanje prilikom pokušaja web navigacije.
* Na iPhone-u, korisnik može biti upitan da prihvati novi sertifikat, a zatim mu se prikazuje portal za zarobljavanje.

#### Zaključak

Iako se EAP-TLS smatra sigurnim, njegova efikasnost uveliko zavisi od ispravne konfiguracije i opreznog ponašanja krajnjih korisnika. Pogrešno konfigurisani uređaji ili nesumnjivi korisnici koji prihvataju lažne sertifikate mogu ugroziti sigurnost mreže zaštićene EAP-TLS protokolom.

Za dalje detalje pogledajte https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Reference

* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! Pridružite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas i počnite da zarađujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
