# Reset/Forgotten Password Bypass

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Pridružite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hakerski uvidi**\
Uključite se u sadržaj koji istražuje uzbuđenje i izazove hakovanja

**Hakerske vesti u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja putem vesti i uvida u realnom vremenu

**Najnovije najave**\
Ostanite informisani o najnovijim pokretanjima nagrada za pronalaženje bagova i važnim ažuriranjima platforme

**Pridružite nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i počnite da sarađujete sa vrhunskim hakerima danas!

## **Curenje tokena za resetovanje lozinke putem referera**

* HTTP referer zaglavlje može otkriti token za resetovanje lozinke ako je uključen u URL. Ovo se može desiti kada korisnik klikne na link sajta treće strane nakon što je zatražio resetovanje lozinke.
* **Utjecaj**: Potencijalno preuzimanje naloga putem napada Cross-Site Request Forgery (CSRF).
* **Reference**:
* [HackerOne Izveštaj 342693](https://hackerone.com/reports/342693)
* [HackerOne Izveštaj 272379](https://hackerone.com/reports/272379)
* [Članak o curenju tokena za resetovanje lozinke](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Trovanje resetovanja lozinke**

* Napadači mogu manipulisati Host zaglavljem tokom zahteva za resetovanje lozinke kako bi usmerili reset link ka zlonamernom sajtu.
* **Popravka**: Koristite `$_SERVER['SERVER_NAME']` za konstrukciju URL-ova za resetovanje lozinke umesto `$_SERVER['HTTP_HOST']`.
* **Utjecaj**: Dovodi do potencijalnog preuzimanja naloga otkrivanjem tokena za resetovanje napadačima.
* **Koraci za ublažavanje**:
* Validirajte Host zaglavlje prema beloj listi dozvoljenih domena.
* Koristite sigurne, serverske metode za generisanje apsolutnih URL-ova.

## **Resetovanje lozinke manipulacijom parametra e-pošte**

* Napadači mogu manipulisati zahtevom za resetovanje lozinke dodavanjem dodatnih parametara e-pošte kako bi preusmerili reset link.
* **Koraci za ublažavanje**:
* Ispravno parsirajte i validirajte parametre e-pošte na serverskoj strani.
* Koristite pripremljene izjave ili parametrizovane upite kako biste sprečili napade ubacivanjem.

## **Promena e-pošte i lozinke bilo kog korisnika putem API parametara**

* Napadači mogu izmeniti parametre e-pošte i lozinke u API zahtevima kako bi promenili korisničke podatke naloga.
* **Koraci za ublažavanje**:
* Osigurajte strogu validaciju parametara i provere autentičnosti.
* Implementirajte robustno beleženje i nadgledanje kako biste otkrili i odgovorili na sumnjive aktivnosti.

## **Nedostatak ograničenja brzine: Email bombardovanje**

* Nedostatak ograničenja brzine zahteva za resetovanje lozinke može dovesti do bombardovanja e-poštom, preplavljujući korisnika reset e-porukama.
* **Koraci za ublažavanje**:
* Implementirajte ograničenje brzine na osnovu IP adrese ili korisničkog naloga.
* Koristite CAPTCHA izazove kako biste sprečili automatizovano zloupotrebu.

## **Saznajte kako se generiše token za resetovanje lozinke**

* Razumevanje obrasca ili metode generisanja tokena može dovesti do predviđanja ili pokušaja prisiljavanja tokena.
* **Koraci za ublažavanje**:
* Koristite jake, kriptografske metode za generisanje tokena.
* Osigurajte dovoljno slučajnosti i dužinu kako biste sprečili predvidljivost.

## **Pogodan GUID**

* Ako su GUID-ovi (npr. verzija 1) pogodni ili predvidljivi, napadači ih mogu prisiljavati kako bi generisali validne reset tokene.
* **Koraci za ublažavanje**:
* Koristite GUID verzije 4 za slučajnost ili implementirajte dodatne sigurnosne mere za druge verzije.

## **Manipulacija odgovorom: Zamena lošeg odgovora dobrim**

* Manipulacija HTTP odgovorima kako bi se zaobišle poruke o greškama ili ograničenjima.
* **Koraci za ublažavanje**:
* Implementirajte provere na serverskoj strani kako biste osigurali integritet odgovora.
* Koristite sigurne komunikacijske kanale poput HTTPS-a kako biste sprečili napade čoveka u sredini.

## **Korišćenje isteklog tokena**

* Testiranje da li istekli tokeni i dalje mogu biti korišćeni za resetovanje lozinke.
* **Koraci za ublažavanje**:
* Implementirajte stroge politike isteka tokena i validirajte istek tokena na serverskoj strani.

## **Brute Force napad na token za resetovanje lozinke**

* Pokušaj prisiljavanja tokena za resetovanje lozinke korišćenjem alata poput Burpsuite-a i IP-Rotator

## Reference

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Pridružite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na bagove!

**Hakerski uvidi**\
Uključite se u sadržaj koji istražuje uzbuđenje i izazove hakovanja

**Hakerske vesti u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja putem vesti i uvida u realnom vremenu

**Najnovije objave**\
Budite informisani o najnovijim pokretanjima nagrada za pronalaženje bagova i važnim ažuriranjima platforme

**Pridružite nam se na** [**Discord-u**](https://discord.com/invite/N3FrSbmwdy) i počnite da sarađujete sa vrhunskim hakerima danas!

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
