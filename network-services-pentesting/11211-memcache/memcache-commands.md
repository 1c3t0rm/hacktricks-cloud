# Memcache Commands

## Memcache Komande

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

### Cheat-Sheet Komande

**Sa** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Podržane komande (zvanične i neke nezvanične) su dokumentovane u [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt) dokumentu.

Nažalost, opis sintakse nije baš jasan i jednostavna pomoćna komanda koja bi prikazala postojeće komande bila bi mnogo bolja. Evo pregleda komandi koje možete pronaći u [izvoru](https://github.com/memcached/memcached) (kao od 19.08.2016):

| Komanda               | Opis                                                 | Primer                                                                                                                                                                                                                                      |
| --------------------- | ---------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Čita vrednost                                        | `get mojkljuc`                                                                                                                                                                                                                              |
| set                   | Postavlja ključ bezuslovno                           | <p><code>set mojkljuc &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Obavezno koristite \r\n kao prelome linija prilikom korišćenja Unix CLI alata. Na primer&#x3C;/p> <code>printf "set mojkljuc 0 60 4\r\ndata\r\n"</code></p> |
| add                   | Dodaje novi ključ                                    | `add novikljuc 0 60 5`                                                                                                                                                                                                                      |
| replace               | Prepiše postojeći ključ                              | `replace kljuc 0 60 5`                                                                                                                                                                                                                      |
| append                | Dodaje podatke postojećem ključu                     | `append kljuc 0 60 15`                                                                                                                                                                                                                      |
| prepend               | Dodaje podatke na početak postojećeg ključa          | `prepend kljuc 0 60 15`                                                                                                                                                                                                                     |
| incr                  | Povećava numeričku vrednost ključa za određeni broj  | `incr mojkljuc 2`                                                                                                                                                                                                                           |
| decr                  | Smanjuje numeričku vrednost ključa za određeni broj  | `decr mojkljuc 5`                                                                                                                                                                                                                           |
| delete                | Briše postojeći ključ                                | `delete mojkljuc`                                                                                                                                                                                                                           |
| flush\_all            | Odmah poništava sve stavke                           | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Poništava sve stavke za n sekundi                    | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Prikazuje opšte statistike                           | `stats`                                                                                                                                                                                                                                     |
|                       | Prikazuje statistike memorije                        | `stats slabs`                                                                                                                                                                                                                               |
|                       | Prikazuje statistike višeg nivoa alokacije           | `stats malloc`                                                                                                                                                                                                                              |
|                       | Prikazuje informacije o stavkama                     | `stats items`                                                                                                                                                                                                                               |
|                       |                                                      | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                      | `stats sizes`                                                                                                                                                                                                                               |
|                       | Resetuje brojače statistike                          | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Dumpuje (većinu) metapodataka za (sve) stavke u kešu | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Prikazuje verziju servera                            | `version`                                                                                                                                                                                                                                   |
| verbosity             | Povećava nivo logovanja                              | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Završava sesiju                                      | `quit`                                                                                                                                                                                                                                      |

**Statistike o saobraćaju**

Možete dobiti trenutne statistike o saobraćaju korišćenjem komande

```
stats
```

Dobićete popis koji prikazuje broj veza, bajtova ulazno/izlazno i mnogo više.

Primer izlaza:

```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```

**Statistika memorije**

Možete dobiti trenutnu statistiku memorije korišćenjem komande

```
stats slabs
```

## Memcache Commands

Memcache je popularna open-source memorija u kešu koja se često koristi za ubrzavanje performansi web aplikacija. Ovde su neke od najčešće korišćenih komandi za rad sa Memcache-om.

### SET

Komanda SET se koristi za postavljanje vrednosti ključa u Memcache. Ova komanda ima sledeći format:

```
SET <ključ> <vrednost> <vreme_isteka> <veličina>
```

* `<ključ>`: Ključ pod kojim će se čuvati vrednost.
* `<vrednost>`: Vrednost koja će biti sačuvana.
* `<vreme_isteka>`: Vreme u sekundama nakon kojeg će vrednost isteći. Ako želite da vrednost bude trajna, možete postaviti ovu vrednost na 0.
* `<veličina>`: Veličina vrednosti u bajtovima.

### GET

Komanda GET se koristi za dobijanje vrednosti ključa iz Memcache-a. Ova komanda ima sledeći format:

```
GET <ključ>
```

* `<ključ>`: Ključ čija se vrednost želi dobiti.

### DELETE

Komanda DELETE se koristi za brisanje ključa iz Memcache-a. Ova komanda ima sledeći format:

```
DELETE <ključ>
```

* `<ključ>`: Ključ koji želite da obrišete.

### INCREMENT

Komanda INCREMENT se koristi za povećanje vrednosti ključa za određeni broj. Ova komanda ima sledeći format:

```
INCREMENT <ključ> <broj>
```

* `<ključ>`: Ključ čiju vrednost želite da povećate.
* `<broj>`: Broj za koji želite da povećate vrednost ključa.

### DECREMENT

Komanda DECREMENT se koristi za smanjenje vrednosti ključa za određeni broj. Ova komanda ima sledeći format:

```
DECREMENT <ključ> <broj>
```

* `<ključ>`: Ključ čiju vrednost želite da smanjite.
* `<broj>`: Broj za koji želite da smanjite vrednost ključa.

### FLUSH\_ALL

Komanda FLUSH\_ALL se koristi za brisanje svih ključeva iz Memcache-a. Ova komanda nema dodatne parametre.

### STATS

Komanda STATS se koristi za dobijanje statističkih informacija o Memcache-u. Ova komanda nema dodatne parametre.

### VERSION

Komanda VERSION se koristi za dobijanje verzije Memcache servera. Ova komanda nema dodatne parametre.

```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```

Ako niste sigurni da li imate dovoljno memorije za vašu memcached instancu, uvek obratite pažnju na brojače "evictions" koje daje komanda "stats". Ako imate dovoljno memorije za instancu, brojač "evictions" treba da bude 0 ili barem da se ne povećava.

**Koji ključevi se koriste?**

Ne postoji ugrađena funkcija koja direktno određuje trenutni skup ključeva. Međutim, možete koristiti

```
stats items
```

Komanda za određivanje koliko ključeva postoji.

```bash
stats items
```

Ova komanda će prikazati statistiku o svim trenutno dostupnim ključevima u memcache bazi podataka.

```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```

Ovo barem pomaže da se vidi da li se koriste neki ključevi. Da biste izlistali imena ključeva iz PHP skripte koja već pristupa memcache-u, možete koristiti PHP kod sa [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **oglašavanje vaše kompanije u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
