# 502 - Pentesting Modbus

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

1979. godine, **Modbus protokol** je razvijen od strane Modicon-a, služeći kao struktura za razmenu poruka. Njegova primarna upotreba uključuje olakšavanje komunikacije između inteligentnih uređaja, koji rade po modelu master-slave/klijent-server. Ovaj protokol igra ključnu ulogu u omogućavanju efikasne razmene podataka između uređaja.

**Podrazumevani port:** 502

```
PORT    STATE SERVICE
502/tcp open  modbus
```

## Enumeracija

### Modbus Scan

Modbus je protokol za komunikaciju između uređaja koji se koristi u industrijskim kontrolnim sistemima. Da biste identifikovali Modbus uređaje na mreži, možete koristiti alat `modscan` koji je deo `modpoll` paketa.

```plaintext
modscan.py -a <IP adresa> -p <port>
```

Ovaj alat će skenirati određenu IP adresu i port kako bi pronašao Modbus uređaje na mreži.

### Modbus TCP Enumeration

Modbus TCP je varijanta Modbus protokola koja koristi TCP/IP za komunikaciju. Da biste izvršili enumeraciju Modbus TCP servisa, možete koristiti alat `nmap` sa odgovarajućim skriptama.

```plaintext
nmap -p 502 --script modbus-discover <IP adresa>
```

Ova komanda će skenirati određenu IP adresu na portu 502 i izvršiti Modbus TCP enumeraciju koristeći `modbus-discover` skriptu.

### Modbus RTU Enumeration

Modbus RTU je varijanta Modbus protokola koja koristi serijsku komunikaciju. Da biste izvršili enumeraciju Modbus RTU servisa, možete koristiti alat `modscan` sa odgovarajućim podešavanjima.

```plaintext
modscan.py -m rtu -b <brzina> -p <port>
```

Ovaj alat će skenirati određeni serijski port sa zadatom brzinom kako bi pronašao Modbus RTU uređaje na mreži.

### Modbus Slave ID Enumeration

Modbus Slave ID je jedinstveni identifikator Modbus uređaja na mreži. Da biste izvršili enumeraciju Modbus Slave ID-ova, možete koristiti alat `modscan` sa odgovarajućim podešavanjima.

```plaintext
modscan.py -a <IP adresa> -p <port> -s <Slave ID>
```

Ovaj alat će skenirati određenu IP adresu i port sa zadatim Slave ID-om kako bi pronašao Modbus uređaje na mreži.

```bash
nmap --script modbus-discover -p 502 <IP>
msf> use auxiliary/scanner/scada/modbusdetect
msf> use auxiliary/scanner/scada/modbus_findunitid
```

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
