# 3299 - Pentesting SAPRouter

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

\`\`\`text PORT STATE SERVICE VERSION 3299/tcp open saprouter? \`\`\` Ovo je sažetak posta sa \[https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/]\(https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)

### Razumevanje prodiranja SAProuter-a pomoću Metasploita

SAProuter deluje kao reverzni proxy za SAP sisteme, uglavnom kako bi kontrolisao pristup između interneta i internih SAP mreža. Često je izložen internetu omogućavanjem TCP porta 3299 kroz organizacione firewall-ove. Ova konfiguracija čini SAProuter privlačnom metom za testiranje prodiranja jer može služiti kao ulaz u internu mrežu visoke vrednosti.

**Skeniranje i prikupljanje informacija**

Prvo se vrši skeniranje kako bi se utvrdilo da li se na određenoj IP adresi izvršava SAP router koristeći modul **sap\_service\_discovery**. Ovaj korak je ključan za utvrđivanje prisustva SAP routera i otvorenog porta.

```
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```

Nakon otkrića, vrši se dalja istraga konfiguracije SAP rutera pomoću modula **sap\_router\_info\_request** kako bi se potencijalno otkrili detalji interne mreže.

```
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```

**Nabrajanje internih usluga**

Sa dobijenim uvidom u internu mrežu, modul **sap\_router\_portscanner** se koristi za ispitivanje internih računara i usluga putem SAPrutera, omogućavajući dublje razumevanje internih mreža i konfiguracija usluga.

```
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```

Ova modulova fleksibilnost u ciljanju određenih SAP instanci i portova čini ga efikasnim alatom za detaljno istraživanje interne mreže.

**Napredno nabrojavanje i mapiranje ACL-a**

Dalje skeniranje može otkriti kako su konfigurisane Access Control List (ACL) na SAProuter-u, detaljno opisujući koje veze su dozvoljene ili blokirane. Ove informacije su ključne za razumevanje sigurnosnih politika i potencijalnih ranjivosti.

```
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```

**Slepo nabrojavanje unutrašnjih računara**

U scenarijima gde je direktna informacija od SAPrutera ograničena, mogu se primeniti tehnike slepog nabrojavanja. Ovaj pristup pokušava da pogodi i potvrdi postojanje unutrašnjih imena računara, otkrivajući potencijalne mete bez direktnih IP adresa.

**Iskorišćavanje informacija za testiranje prodiranja**

Nakon što je mreža mapirana i identifikovane su dostupne usluge, testeri prodiranja mogu koristiti sposobnosti proxy-ja u Metasploit-u za prelazak preko SAPrutera radi daljeg istraživanja i iskorišćavanja internih SAP usluga.

```
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```

**Zaključak**

Ovaj pristup ističe važnost sigurnih konfiguracija SAProuter-a i ističe mogućnost pristupa internim mrežama putem ciljanog testiranja prodiranja. Pravilno osiguravanje SAP router-a i razumevanje njihove uloge u arhitekturi mrežne sigurnosti ključno je za zaštitu od neovlašćenog pristupa.

Za detaljnije informacije o Metasploit modulima i njihovoj upotrebi, posetite [Rapid7 bazu podataka](http://www.rapid7.com/db).

### **Reference**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

### Shodan

* `port:3299 !HTTP Network packet too big`

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
